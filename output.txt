

=== Folder: . ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\firebase_options.dart ---
// File generated by FlutterFire CLI.
// ignore_for_file: type=lint
import 'package:firebase_core/firebase_core.dart' show FirebaseOptions;
import 'package:flutter/foundation.dart'
    show defaultTargetPlatform, kIsWeb, TargetPlatform;

/// Default [FirebaseOptions] for use with your Firebase apps.
///
/// Example:
/// ```dart
/// import 'firebase_options.dart';
/// // ...
/// await Firebase.initializeApp(
///   options: DefaultFirebaseOptions.currentPlatform,
/// );
/// ```
class DefaultFirebaseOptions {
  static FirebaseOptions get currentPlatform {
    if (kIsWeb) {
      return web;
    }
    switch (defaultTargetPlatform) {
      case TargetPlatform.android:
        return android;
      case TargetPlatform.iOS:
        return ios;
      case TargetPlatform.macOS:
        return macos;
      case TargetPlatform.windows:
        return windows;
      case TargetPlatform.linux:
        throw UnsupportedError(
          'DefaultFirebaseOptions have not been configured for linux - '
          'you can reconfigure this by running the FlutterFire CLI again.',
        );
      default:
        throw UnsupportedError(
          'DefaultFirebaseOptions are not supported for this platform.',
        );
    }
  }

  static const FirebaseOptions web = FirebaseOptions(
    apiKey: 'AIzaSyCphP5d8nMkrtR7w3wzKnrU90Ovn6i-RrU',
    appId: '1:866444566884:web:763a3afe141c4498dd5a71',
    messagingSenderId: '866444566884',
    projectId: 'pcmc-app-2024-ravirajmane',
    authDomain: 'pcmc-app-2024-ravirajmane.firebaseapp.com',
    storageBucket: 'pcmc-app-2024-ravirajmane.firebasestorage.app',
    measurementId: 'G-JNP45L8GE3',
  );

  static const FirebaseOptions android = FirebaseOptions(
    apiKey: 'AIzaSyC3a0oLxhS5hpRpmPbUTTqbGpPYGUOolqA',
    appId: '1:866444566884:android:905c838409cbe3c8dd5a71',
    messagingSenderId: '866444566884',
    projectId: 'pcmc-app-2024-ravirajmane',
    storageBucket: 'pcmc-app-2024-ravirajmane.firebasestorage.app',
  );

  static const FirebaseOptions ios = FirebaseOptions(
    apiKey: 'AIzaSyCiPV9uSpSDSndTNyMl44DdsnmCo9upY7s',
    appId: '1:866444566884:ios:6caa7e60c3eb4e53dd5a71',
    messagingSenderId: '866444566884',
    projectId: 'pcmc-app-2024-ravirajmane',
    storageBucket: 'pcmc-app-2024-ravirajmane.firebasestorage.app',
    iosBundleId: 'com.example.mainUi',
  );

  static const FirebaseOptions macos = FirebaseOptions(
    apiKey: 'AIzaSyCiPV9uSpSDSndTNyMl44DdsnmCo9upY7s',
    appId: '1:866444566884:ios:6caa7e60c3eb4e53dd5a71',
    messagingSenderId: '866444566884',
    projectId: 'pcmc-app-2024-ravirajmane',
    storageBucket: 'pcmc-app-2024-ravirajmane.firebasestorage.app',
    iosBundleId: 'com.example.mainUi',
  );

  static const FirebaseOptions windows = FirebaseOptions(
    apiKey: 'AIzaSyCphP5d8nMkrtR7w3wzKnrU90Ovn6i-RrU',
    appId: '1:866444566884:web:088a63504e25493fdd5a71',
    messagingSenderId: '866444566884',
    projectId: 'pcmc-app-2024-ravirajmane',
    authDomain: 'pcmc-app-2024-ravirajmane.firebaseapp.com',
    storageBucket: 'pcmc-app-2024-ravirajmane.firebasestorage.app',
    measurementId: 'G-1SM00DMF4Q',
  );

}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\main.dart ---
import 'package:firebase_core/firebase_core.dart';
import 'firebase_options.dart';
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:flutter_localizations/flutter_localizations.dart';
import 'l10n/app_localizations.dart';
import 'package:flutter_web_plugins/url_strategy.dart';
import 'routes.dart';
import 'utils/theme.dart';
import 'screens/auth/login_callback.dart';
import 'screens/auth/splash_screen.dart';
import 'providers/locale_provider.dart';
import 'package:main_ui/services/auth_service.dart';
import 'package:main_ui/services/api_service.dart';  
void main() async {
  WidgetsFlutterBinding.ensureInitialized();
  await Firebase.initializeApp(options: DefaultFirebaseOptions.currentPlatform);
  await AuthService.initialize();
  await ApiService.init();
  usePathUrlStrategy();
  runApp(const ProviderScope(child: MyApp()));
}

class MyApp extends ConsumerWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final locale = ref.watch(localeNotifierProvider);

    return MaterialApp(
      title: 'Grievance System',
      theme: lightTheme,
      darkTheme: darkTheme,
      themeMode: ThemeMode.system,
      locale: locale,
      localizationsDelegates: const [
        AppLocalizations.delegate,
        GlobalMaterialLocalizations.delegate,
        GlobalWidgetsLocalizations.delegate,
        GlobalCupertinoLocalizations.delegate,
      ],
      supportedLocales: const [
        Locale('en'),
        Locale('mr'),
        Locale('hi'),
      ],
      home: const SplashScreen(),
      routes: appRoutes,
      onGenerateRoute: (settings) {
        if (settings.name?.startsWith('/login/callback') ?? false) {
          return MaterialPageRoute(
            builder: (context) => LoginCallbackScreen(),
            settings: settings,
          );
        }
        return null;
      },
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\routes.dart ---
import 'package:flutter/material.dart';
import 'screens/auth/login_screen.dart';
import 'screens/auth/login_callback.dart';
import 'screens/citizen/submit_grievance.dart';
import 'screens/citizen/track_grievance.dart';
import 'screens/citizen/grievance_detail.dart';
import 'screens/member_head/view_grievances.dart';
import 'screens/field_staff/assigned_list.dart';
import 'screens/admin/dashboard.dart';
import 'screens/admin/manage_users.dart';
import 'screens/admin/manage_subjects.dart';
import 'screens/admin/audit_logs.dart';
import 'screens/admin/complaint_management.dart';
import 'screens/admin/user_history.dart';
import 'screens/common/profile_screen.dart';
import 'screens/common/settings_screen.dart';
import 'screens/admin/manage_configs.dart';
import 'screens/admin/all_users_history.dart';
import 'screens/admin/ManageAreasScreen.dart';
import 'screens/common/announcements_screen.dart';
import 'screens/admin/reports_screen.dart';
import 'screens/common/notifications_screen.dart';
import 'screens/auth/otp_verification_screen.dart';
import 'screens/common/view_privacy_policy_screen.dart';
import 'screens/common/faqs_screen.dart';
import 'screens/common/contact_support_screen.dart';
import 'screens/common/app_version_screen.dart';
import 'screens/citizen/edit_grievance.dart';



Map<String, WidgetBuilder> appRoutes = {
  '/login': (context) => const LoginScreen(),
  '/login/callback': (context) => const LoginCallbackScreen(),
  '/admin/configs': (context) => const ManageConfigs(),
  '/citizen/track': (context) => const TrackGrievance(),
  '/citizen/submit': (context) => const SubmitGrievance(),
  '/citizen/detail': (context) {
    final args = ModalRoute.of(context)!.settings.arguments as int?;
    if (args == null || args <= 0) {
      return const Scaffold(body: Center(child: Text('Invalid grievance ID')));
    }
    return GrievanceDetail(id: args ?? 0);
  },
  '/member_head/view': (context) => const ViewGrievances(),
  '/admin/dashboard': (context) => const Dashboard(),
  '/admin/users': (context) => const ManageUsers(),
  '/admin/subjects': (context) => const ManageSubjects(),
  '/admin/all_users_history': (context) => const AllUsersHistoryScreen(),
  '/admin/audit': (context) => const AuditLogs(),
  '/admin/complaints': (context) => const ComplaintManagement(),
  '/admin/user_history': (context) {
    final args = ModalRoute.of(context)!.settings.arguments as int?;
    if (args == null) {
      return const Scaffold(body: Center(child: Text('User ID required')));
    }
    return UserHistoryScreen(userId: args); 
  },
  '/profile': (context) => const ProfileScreen(),
  '/settings': (context) => const SettingsScreen(),
  '/citizen/home': (context) => const TrackGrievance(),
  '/member_head/home': (context) => const ViewGrievances(),
  '/field_staff/home': (context) => const AssignedList(), 
  '/admin/home': (context) => const Dashboard(),
  '/admin/areas': (context) => const ManageAreasScreen(),
  '/announcements': (context) => const AnnouncementsScreen(),
  '/admin/reports': (context) => const ReportsScreen(),
  '/notifications': (context) => const NotificationsScreen(),
  '/auth/otp': (context) => const OtpVerificationScreen(),
  '/privacy-policy': (context) => const PrivacyPolicyScreen(),
  '/faqs': (context) => const FaqsScreen(),
  '/contact-support': (context) => const ContactSupportScreen(),
  '/app-version': (context) => const AppVersionScreen(),
  '/citizen/edit': (context) {
  final args = ModalRoute.of(context)!.settings.arguments as int;
  return EditGrievance(id: args);
},
};

=== Folder: l10n ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\l10n\app_localizations.dart ---
import 'dart:async';

import 'package:flutter/foundation.dart';
import 'package:flutter/widgets.dart';
import 'package:flutter_localizations/flutter_localizations.dart';
import 'package:intl/intl.dart' as intl;

import 'app_localizations_en.dart';
import 'app_localizations_hi.dart';
import 'app_localizations_mr.dart';

// ignore_for_file: type=lint

/// Callers can lookup localized strings with an instance of AppLocalizations
/// returned by `AppLocalizations.of(context)`.
///
/// Applications need to include `AppLocalizations.delegate()` in their app's
/// `localizationDelegates` list, and the locales they support in the app's
/// `supportedLocales` list. For example:
///
/// ```dart
/// import 'l10n/app_localizations.dart';
///
/// return MaterialApp(
///   localizationsDelegates: AppLocalizations.localizationsDelegates,
///   supportedLocales: AppLocalizations.supportedLocales,
///   home: MyApplicationHome(),
/// );
/// ```
///
/// ## Update pubspec.yaml
///
/// Please make sure to update your pubspec.yaml to include the following
/// packages:
///
/// ```yaml
/// dependencies:
///   # Internationalization support.
///   flutter_localizations:
///     sdk: flutter
///   intl: any # Use the pinned version from flutter_localizations
///
///   # Rest of dependencies
/// ```
///
/// ## iOS Applications
///
/// iOS applications define key application metadata, including supported
/// locales, in an Info.plist file that is built into the application bundle.
/// To configure the locales supported by your app, you’ll need to edit this
/// file.
///
/// First, open your project’s ios/Runner.xcworkspace Xcode workspace file.
/// Then, in the Project Navigator, open the Info.plist file under the Runner
/// project’s Runner folder.
///
/// Next, select the Information Property List item, select Add Item from the
/// Editor menu, then select Localizations from the pop-up menu.
///
/// Select and expand the newly-created Localizations item then, for each
/// locale your application supports, add a new item and select the locale
/// you wish to add from the pop-up menu in the Value field. This list should
/// be consistent with the languages listed in the AppLocalizations.supportedLocales
/// property.
abstract class AppLocalizations {
  AppLocalizations(String locale)
    : localeName = intl.Intl.canonicalizedLocale(locale.toString());

  final String localeName;

  static AppLocalizations? of(BuildContext context) {
    return Localizations.of<AppLocalizations>(context, AppLocalizations);
  }

  static const LocalizationsDelegate<AppLocalizations> delegate =
      _AppLocalizationsDelegate();

  /// A list of this localizations delegate along with the default localizations
  /// delegates.
  ///
  /// Returns a list of localizations delegates containing this delegate along with
  /// GlobalMaterialLocalizations.delegate, GlobalCupertinoLocalizations.delegate,
  /// and GlobalWidgetsLocalizations.delegate.
  ///
  /// Additional delegates can be added by appending to this list in
  /// MaterialApp. This list does not have to be used at all if a custom list
  /// of delegates is preferred or required.
  static const List<LocalizationsDelegate<dynamic>> localizationsDelegates =
      <LocalizationsDelegate<dynamic>>[
        delegate,
        GlobalMaterialLocalizations.delegate,
        GlobalCupertinoLocalizations.delegate,
        GlobalWidgetsLocalizations.delegate,
      ];

  /// A list of this localizations delegate's supported locales.
  static const List<Locale> supportedLocales = <Locale>[
    Locale('en'),
    Locale('hi'),
    Locale('mr'),
  ];

  /// App title displayed on home screen
  ///
  /// In en, this message translates to:
  /// **'NIVARAN'**
  String get appTitle;

  /// Label for login button
  ///
  /// In en, this message translates to:
  /// **'Login'**
  String get login;

  /// Label for register button
  ///
  /// In en, this message translates to:
  /// **'Register'**
  String get register;

  /// Label for submit grievance button
  ///
  /// In en, this message translates to:
  /// **'Submit Grievance'**
  String get submitGrievance;

  /// Error message for failed login
  ///
  /// In en, this message translates to:
  /// **'Authentication failed'**
  String get authenticationFailed;

  /// Generic error label
  ///
  /// In en, this message translates to:
  /// **'An error occurred'**
  String get error;

  /// Label for name input field
  ///
  /// In en, this message translates to:
  /// **'Name'**
  String get name;

  /// Label for email input field
  ///
  /// In en, this message translates to:
  /// **'Email'**
  String get email;

  /// Label for password input field
  ///
  /// In en, this message translates to:
  /// **'Password'**
  String get password;

  /// Prompt to register
  ///
  /// In en, this message translates to:
  /// **'Don\'t have an account? Register'**
  String get registerPrompt;

  /// Prompt to login
  ///
  /// In en, this message translates to:
  /// **'Already have an account? Login'**
  String get loginPrompt;

  /// Label for Google login button
  ///
  /// In en, this message translates to:
  /// **'Login with Google'**
  String get googleLogin;

  /// Error message for failed Google login
  ///
  /// In en, this message translates to:
  /// **'Google login failed'**
  String get googleLoginFailed;

  /// Label for settings screen
  ///
  /// In en, this message translates to:
  /// **'Settings'**
  String get settings;

  /// Label for dark mode toggle
  ///
  /// In en, this message translates to:
  /// **'Dark Mode'**
  String get darkMode;

  /// Label for language selector
  ///
  /// In en, this message translates to:
  /// **'Language'**
  String get language;

  /// No description provided for @comments.
  ///
  /// In en, this message translates to:
  /// **'Comments'**
  String get comments;

  /// No description provided for @noComments.
  ///
  /// In en, this message translates to:
  /// **'No Comments Yet'**
  String get noComments;

  /// No description provided for @noCommentsMessage.
  ///
  /// In en, this message translates to:
  /// **'Be the first to add a comment!'**
  String get noCommentsMessage;

  /// No description provided for @addComment.
  ///
  /// In en, this message translates to:
  /// **'Add Comment'**
  String get addComment;

  /// No description provided for @yourComment.
  ///
  /// In en, this message translates to:
  /// **'Your Comment'**
  String get yourComment;

  /// No description provided for @commentCannotBeEmpty.
  ///
  /// In en, this message translates to:
  /// **'Comment cannot be empty'**
  String get commentCannotBeEmpty;

  /// No description provided for @cancel.
  ///
  /// In en, this message translates to:
  /// **'Cancel'**
  String get cancel;

  /// No description provided for @submit.
  ///
  /// In en, this message translates to:
  /// **'Submit'**
  String get submit;

  /// No description provided for @commentAddedSuccess.
  ///
  /// In en, this message translates to:
  /// **'Comment added successfully'**
  String get commentAddedSuccess;

  /// No description provided for @failedToAddComment.
  ///
  /// In en, this message translates to:
  /// **'Failed to add comment'**
  String get failedToAddComment;

  /// No description provided for @grievanceDetails.
  ///
  /// In en, this message translates to:
  /// **'Grievance Details'**
  String get grievanceDetails;

  /// No description provided for @status.
  ///
  /// In en, this message translates to:
  /// **'Status'**
  String get status;

  /// No description provided for @submitFeedback.
  ///
  /// In en, this message translates to:
  /// **'Submit Feedback'**
  String get submitFeedback;

  /// No description provided for @selectRating.
  ///
  /// In en, this message translates to:
  /// **'Select Rating'**
  String get selectRating;

  /// No description provided for @feedback.
  ///
  /// In en, this message translates to:
  /// **'Feedback'**
  String get feedback;

  /// No description provided for @pleaseProvideRating.
  ///
  /// In en, this message translates to:
  /// **'Please provide a rating'**
  String get pleaseProvideRating;

  /// No description provided for @feedbackSubmitted.
  ///
  /// In en, this message translates to:
  /// **'Your feedback has been submitted'**
  String get feedbackSubmitted;

  /// No description provided for @failedToLoadGrievance.
  ///
  /// In en, this message translates to:
  /// **'Failed to load grievance'**
  String get failedToLoadGrievance;

  /// No description provided for @userHistory.
  ///
  /// In en, this message translates to:
  /// **'User History'**
  String get userHistory;

  /// No description provided for @userNotFound.
  ///
  /// In en, this message translates to:
  /// **'User not found'**
  String get userNotFound;

  /// No description provided for @noGrievancesFound.
  ///
  /// In en, this message translates to:
  /// **'No grievances found'**
  String get noGrievancesFound;

  /// No description provided for @noGrievances.
  ///
  /// In en, this message translates to:
  /// **'No Grievances'**
  String get noGrievances;

  /// No description provided for @noGrievancesMessage.
  ///
  /// In en, this message translates to:
  /// **'There are no grievances to display.'**
  String get noGrievancesMessage;

  /// No description provided for @retry.
  ///
  /// In en, this message translates to:
  /// **'Retry'**
  String get retry;

  /// No description provided for @filterByStatus.
  ///
  /// In en, this message translates to:
  /// **'Filter by Status'**
  String get filterByStatus;

  /// No description provided for @filterByPriority.
  ///
  /// In en, this message translates to:
  /// **'Filter by Priority'**
  String get filterByPriority;

  /// No description provided for @filterByArea.
  ///
  /// In en, this message translates to:
  /// **'Filter by Area'**
  String get filterByArea;

  /// No description provided for @filterBySubject.
  ///
  /// In en, this message translates to:
  /// **'Filter by Subject'**
  String get filterBySubject;

  /// No description provided for @reassign.
  ///
  /// In en, this message translates to:
  /// **'Reassign'**
  String get reassign;

  /// No description provided for @escalate.
  ///
  /// In en, this message translates to:
  /// **'Escalate'**
  String get escalate;

  /// No description provided for @updateStatus.
  ///
  /// In en, this message translates to:
  /// **'Update Status'**
  String get updateStatus;

  /// No description provided for @viewDetails.
  ///
  /// In en, this message translates to:
  /// **'View Details'**
  String get viewDetails;

  /// No description provided for @reassignGrievance.
  ///
  /// In en, this message translates to:
  /// **'Reassign Grievance'**
  String get reassignGrievance;

  /// No description provided for @selectAssignee.
  ///
  /// In en, this message translates to:
  /// **'Select Assignee'**
  String get selectAssignee;

  /// No description provided for @selectStatus.
  ///
  /// In en, this message translates to:
  /// **'Select Status'**
  String get selectStatus;

  /// No description provided for @update.
  ///
  /// In en, this message translates to:
  /// **'Update'**
  String get update;

  /// No description provided for @noComplaints.
  ///
  /// In en, this message translates to:
  /// **'No Complaints'**
  String get noComplaints;

  /// No description provided for @noComplaintsMessage.
  ///
  /// In en, this message translates to:
  /// **'There are no complaints to display.'**
  String get noComplaintsMessage;

  /// No description provided for @tryAgain.
  ///
  /// In en, this message translates to:
  /// **'Retry'**
  String get tryAgain;

  /// No description provided for @reassignComplaint.
  ///
  /// In en, this message translates to:
  /// **'Assign'**
  String get reassignComplaint;

  /// No description provided for @escalateComplaint.
  ///
  /// In en, this message translates to:
  /// **'Escalate'**
  String get escalateComplaint;

  /// Error message when user ID is not provided
  ///
  /// In en, this message translates to:
  /// **'User ID is required'**
  String get userIdRequired;

  /// No description provided for @noConfigs.
  ///
  /// In en, this message translates to:
  /// **'No Configurations'**
  String get noConfigs;

  /// No description provided for @noConfigsMessage.
  ///
  /// In en, this message translates to:
  /// **'There are no configurations to display. Add one below.'**
  String get noConfigsMessage;

  /// No description provided for @addConfig.
  ///
  /// In en, this message translates to:
  /// **'Add Configuration'**
  String get addConfig;

  /// No description provided for @editConfig.
  ///
  /// In en, this message translates to:
  /// **'Edit Configuration'**
  String get editConfig;

  /// No description provided for @configKey.
  ///
  /// In en, this message translates to:
  /// **'Configuration Key'**
  String get configKey;

  /// No description provided for @configValue.
  ///
  /// In en, this message translates to:
  /// **'Configuration Value'**
  String get configValue;

  /// No description provided for @configCannotBeEmpty.
  ///
  /// In en, this message translates to:
  /// **'Key and Value cannot be empty'**
  String get configCannotBeEmpty;

  /// No description provided for @configValueCannotBeEmpty.
  ///
  /// In en, this message translates to:
  /// **'Value cannot be empty'**
  String get configValueCannotBeEmpty;

  /// No description provided for @configAddedSuccess.
  ///
  /// In en, this message translates to:
  /// **'Configuration added successfully'**
  String get configAddedSuccess;

  /// No description provided for @configUpdatedSuccess.
  ///
  /// In en, this message translates to:
  /// **'Configuration updated successfully'**
  String get configUpdatedSuccess;

  /// No description provided for @track_grievances.
  ///
  /// In en, this message translates to:
  /// **'Track Your Grievances'**
  String get track_grievances;

  /// No description provided for @no_grievances.
  ///
  /// In en, this message translates to:
  /// **'No Grievances Yet'**
  String get no_grievances;

  /// No description provided for @no_grievances_message.
  ///
  /// In en, this message translates to:
  /// **'Submit your first grievance to get started'**
  String get no_grievances_message;

  /// No description provided for @submit_grievance.
  ///
  /// In en, this message translates to:
  /// **'Submit Grievance'**
  String get submit_grievance;

  /// No description provided for @your_grievances.
  ///
  /// In en, this message translates to:
  /// **'Your Grievances'**
  String get your_grievances;

  /// No description provided for @please_login.
  ///
  /// In en, this message translates to:
  /// **'Please login'**
  String get please_login;

  /// No description provided for @addUser.
  ///
  /// In en, this message translates to:
  /// **'Add User'**
  String get addUser;

  /// No description provided for @role.
  ///
  /// In en, this message translates to:
  /// **'Role'**
  String get role;

  /// No description provided for @add.
  ///
  /// In en, this message translates to:
  /// **'Add'**
  String get add;

  /// No description provided for @userAddedSuccess.
  ///
  /// In en, this message translates to:
  /// **'User added successfully'**
  String get userAddedSuccess;

  /// No description provided for @failedToAddUser.
  ///
  /// In en, this message translates to:
  /// **'Failed to add user'**
  String get failedToAddUser;

  /// No description provided for @editUser.
  ///
  /// In en, this message translates to:
  /// **'Edit User'**
  String get editUser;

  /// No description provided for @deleteUser.
  ///
  /// In en, this message translates to:
  /// **'Delete User'**
  String get deleteUser;

  /// No description provided for @userUpdatedSuccess.
  ///
  /// In en, this message translates to:
  /// **'User updated successfully'**
  String get userUpdatedSuccess;

  /// No description provided for @failedToUpdateUser.
  ///
  /// In en, this message translates to:
  /// **'Failed to update user'**
  String get failedToUpdateUser;

  /// No description provided for @deleteUserConfirmation.
  ///
  /// In en, this message translates to:
  /// **'Are you sure you want to delete this user?'**
  String get deleteUserConfirmation;

  /// No description provided for @userDeletedSuccess.
  ///
  /// In en, this message translates to:
  /// **'User deleted successfully'**
  String get userDeletedSuccess;

  /// No description provided for @delete.
  ///
  /// In en, this message translates to:
  /// **'Delete'**
  String get delete;

  /// No description provided for @failedToDeleteUser.
  ///
  /// In en, this message translates to:
  /// **'Failed to delete User'**
  String get failedToDeleteUser;

  /// No description provided for @manageUsers.
  ///
  /// In en, this message translates to:
  /// **'Manage Users'**
  String get manageUsers;

  /// No description provided for @noUsers.
  ///
  /// In en, this message translates to:
  /// **'No Users'**
  String get noUsers;

  /// No description provided for @noUsersMessage.
  ///
  /// In en, this message translates to:
  /// **'There are no users to display.'**
  String get noUsersMessage;

  /// No description provided for @noEmail.
  ///
  /// In en, this message translates to:
  /// **'No Email'**
  String get noEmail;

  /// No description provided for @loading.
  ///
  /// In en, this message translates to:
  /// **'Processing login...'**
  String get loading;

  /// No description provided for @viewgrievanceetails.
  ///
  /// In en, this message translates to:
  /// **'View Grievances'**
  String get viewgrievanceetails;

  /// No description provided for @assignGrievance.
  ///
  /// In en, this message translates to:
  /// **'Assign Grievance'**
  String get assignGrievance;

  /// No description provided for @rejectGrievance.
  ///
  /// In en, this message translates to:
  /// **'Reject Grievance'**
  String get rejectGrievance;

  /// No description provided for @rejectionReason.
  ///
  /// In en, this message translates to:
  /// **'Rejection Reason'**
  String get rejectionReason;

  /// No description provided for @reject.
  ///
  /// In en, this message translates to:
  /// **'Reject'**
  String get reject;

  /// No description provided for @assignedGrievances.
  ///
  /// In en, this message translates to:
  /// **'Assigned Grievances'**
  String get assignedGrievances;

  /// No description provided for @noAssigned.
  ///
  /// In en, this message translates to:
  /// **'No Assigned Grievances'**
  String get noAssigned;

  /// No description provided for @noAssignedMessage.
  ///
  /// In en, this message translates to:
  /// **'There are no grievances assigned to you.'**
  String get noAssignedMessage;

  /// No description provided for @upload.
  ///
  /// In en, this message translates to:
  /// **'Upload'**
  String get upload;

  /// No description provided for @uploadWorkproof.
  ///
  /// In en, this message translates to:
  /// **'Upload Work Proof'**
  String get uploadWorkproof;

  /// No description provided for @guest.
  ///
  /// In en, this message translates to:
  /// **'Guest'**
  String get guest;

  /// No description provided for @invalidRole.
  ///
  /// In en, this message translates to:
  /// **'Invalid Role'**
  String get invalidRole;

  /// No description provided for @profile.
  ///
  /// In en, this message translates to:
  /// **'Profile'**
  String get profile;

  /// No description provided for @logout.
  ///
  /// In en, this message translates to:
  /// **'Logout'**
  String get logout;

  /// No description provided for @logoutFailed.
  ///
  /// In en, this message translates to:
  /// **'Logout Failed'**
  String get logoutFailed;

  /// No description provided for @notifications.
  ///
  /// In en, this message translates to:
  /// **'Notifications'**
  String get notifications;

  /// No description provided for @save.
  ///
  /// In en, this message translates to:
  /// **'Save'**
  String get save;

  /// No description provided for @appVersion.
  ///
  /// In en, this message translates to:
  /// **'App Version'**
  String get appVersion;

  /// No description provided for @about.
  ///
  /// In en, this message translates to:
  /// **'About'**
  String get about;

  /// No description provided for @contactSupport.
  ///
  /// In en, this message translates to:
  /// **'Contact Support'**
  String get contactSupport;

  /// No description provided for @faqs.
  ///
  /// In en, this message translates to:
  /// **'FAQs'**
  String get faqs;

  /// No description provided for @helpSupport.
  ///
  /// In en, this message translates to:
  /// **'Help & Support'**
  String get helpSupport;

  /// No description provided for @viewPrivacyPolicyprivacySecurity.
  ///
  /// In en, this message translates to:
  /// **'View Privacy Policy / Privacy & Security'**
  String get viewPrivacyPolicyprivacySecurity;

  /// No description provided for @enableNotifications.
  ///
  /// In en, this message translates to:
  /// **'Enable Notifications'**
  String get enableNotifications;

  /// No description provided for @account.
  ///
  /// In en, this message translates to:
  /// **'Account'**
  String get account;

  /// No description provided for @privacySecurity.
  ///
  /// In en, this message translates to:
  /// **'Privacy & Security'**
  String get privacySecurity;

  /// No description provided for @viewPrivacyPolicy.
  ///
  /// In en, this message translates to:
  /// **'View Privacy Policy'**
  String get viewPrivacyPolicy;

  /// No description provided for @invalidEmail.
  ///
  /// In en, this message translates to:
  /// **'Invalid Email'**
  String get invalidEmail;

  /// No description provided for @nameRequired.
  ///
  /// In en, this message translates to:
  /// **'Name is required'**
  String get nameRequired;

  /// No description provided for @emailRequired.
  ///
  /// In en, this message translates to:
  /// **'Email is required'**
  String get emailRequired;

  /// No description provided for @passwordRequired.
  ///
  /// In en, this message translates to:
  /// **'Password is required'**
  String get passwordRequired;

  /// No description provided for @recentComplaints.
  ///
  /// In en, this message translates to:
  /// **'Recent Complaints'**
  String get recentComplaints;

  /// No description provided for @filterByPeriod.
  ///
  /// In en, this message translates to:
  /// **'Filter by Period'**
  String get filterByPeriod;

  /// No description provided for @totalComplaints.
  ///
  /// In en, this message translates to:
  /// **'Total Complaints'**
  String get totalComplaints;

  /// No description provided for @day.
  ///
  /// In en, this message translates to:
  /// **'Day'**
  String get day;

  /// No description provided for @week.
  ///
  /// In en, this message translates to:
  /// **'Week'**
  String get week;

  /// No description provided for @month.
  ///
  /// In en, this message translates to:
  /// **'Month'**
  String get month;

  /// No description provided for @year.
  ///
  /// In en, this message translates to:
  /// **'Year'**
  String get year;

  /// No description provided for @allTime.
  ///
  /// In en, this message translates to:
  /// **'All Time'**
  String get allTime;

  /// No description provided for @complaintStatusOverview.
  ///
  /// In en, this message translates to:
  /// **'Complaint Status Overview'**
  String get complaintStatusOverview;

  /// No description provided for @grievanceTrend.
  ///
  /// In en, this message translates to:
  /// **'Grievance Trend'**
  String get grievanceTrend;

  /// No description provided for @numberOfGrievances.
  ///
  /// In en, this message translates to:
  /// **'Number of Grievances'**
  String get numberOfGrievances;

  /// No description provided for @timePeriod.
  ///
  /// In en, this message translates to:
  /// **'Time Period'**
  String get timePeriod;

  /// No description provided for @deptWiseDistribution.
  ///
  /// In en, this message translates to:
  /// **'Department-wise Distribution'**
  String get deptWiseDistribution;

  /// No description provided for @department.
  ///
  /// In en, this message translates to:
  /// **'Department'**
  String get department;

  /// No description provided for @slaMetrics.
  ///
  /// In en, this message translates to:
  /// **'SLA Metrics'**
  String get slaMetrics;

  /// No description provided for @slaDays.
  ///
  /// In en, this message translates to:
  /// **'SLA Days'**
  String get slaDays;

  /// No description provided for @complianceRate.
  ///
  /// In en, this message translates to:
  /// **'Compliance Rate'**
  String get complianceRate;

  /// No description provided for @avgResolutionTime.
  ///
  /// In en, this message translates to:
  /// **'Avg Resolution Time'**
  String get avgResolutionTime;

  /// No description provided for @exportPDF.
  ///
  /// In en, this message translates to:
  /// **'Export PDF'**
  String get exportPDF;

  /// No description provided for @exportCSV.
  ///
  /// In en, this message translates to:
  /// **'Export CSV'**
  String get exportCSV;

  /// No description provided for @exportExcel.
  ///
  /// In en, this message translates to:
  /// **'Export Excel'**
  String get exportExcel;

  /// No description provided for @reportExported.
  ///
  /// In en, this message translates to:
  /// **'Report exported'**
  String get reportExported;

  /// No description provided for @errorExportingReport.
  ///
  /// In en, this message translates to:
  /// **'Error exporting report'**
  String get errorExportingReport;

  /// No description provided for @viewAuditLogs.
  ///
  /// In en, this message translates to:
  /// **'View Audit Logs'**
  String get viewAuditLogs;

  /// No description provided for @complaintManagement.
  ///
  /// In en, this message translates to:
  /// **'Complaint Management'**
  String get complaintManagement;

  /// No description provided for @manageConfigs.
  ///
  /// In en, this message translates to:
  /// **'Manage Configurations'**
  String get manageConfigs;

  /// No description provided for @manageSubjects.
  ///
  /// In en, this message translates to:
  /// **'Manage Subjects'**
  String get manageSubjects;

  /// No description provided for @manageAreas.
  ///
  /// In en, this message translates to:
  /// **'Manage Areas'**
  String get manageAreas;

  /// No description provided for @reports.
  ///
  /// In en, this message translates to:
  /// **'Reports'**
  String get reports;

  /// No description provided for @assignedList.
  ///
  /// In en, this message translates to:
  /// **'Assigned Grievances'**
  String get assignedList;

  /// No description provided for @announcements.
  ///
  /// In en, this message translates to:
  /// **'Announcements'**
  String get announcements;

  /// No description provided for @privacyPolicy.
  ///
  /// In en, this message translates to:
  /// **'Privacy Policy'**
  String get privacyPolicy;

  /// No description provided for @clearFilters.
  ///
  /// In en, this message translates to:
  /// **'Clear Filters'**
  String get clearFilters;

  /// No description provided for @addAnnouncement.
  ///
  /// In en, this message translates to:
  /// **'Add Announcement'**
  String get addAnnouncement;

  /// No description provided for @noAnnouncements.
  ///
  /// In en, this message translates to:
  /// **'No announcements available'**
  String get noAnnouncements;

  /// No description provided for @title.
  ///
  /// In en, this message translates to:
  /// **'Title'**
  String get title;

  /// No description provided for @message.
  ///
  /// In en, this message translates to:
  /// **'Message'**
  String get message;

  /// No description provided for @type.
  ///
  /// In en, this message translates to:
  /// **'Type'**
  String get type;

  /// No description provided for @targetRole.
  ///
  /// In en, this message translates to:
  /// **'Target Role'**
  String get targetRole;

  /// No description provided for @selectExpiration.
  ///
  /// In en, this message translates to:
  /// **'Select Expiration'**
  String get selectExpiration;

  /// No description provided for @announcementAdded.
  ///
  /// In en, this message translates to:
  /// **'Announcement added successfully'**
  String get announcementAdded;

  /// No description provided for @takeAction.
  ///
  /// In en, this message translates to:
  /// **'Take Action'**
  String get takeAction;

  /// No description provided for @refresh.
  ///
  /// In en, this message translates to:
  /// **'Refresh'**
  String get refresh;

  /// No description provided for @exportReports.
  ///
  /// In en, this message translates to:
  /// **'Export Reports'**
  String get exportReports;

  /// No description provided for @filters.
  ///
  /// In en, this message translates to:
  /// **'Filters'**
  String get filters;

  /// No description provided for @apply.
  ///
  /// In en, this message translates to:
  /// **'Apply'**
  String get apply;

  /// No description provided for @locationPermissionDenied.
  ///
  /// In en, this message translates to:
  /// **'Location permission denied'**
  String get locationPermissionDenied;

  /// No description provided for @pleaseFillAllFields.
  ///
  /// In en, this message translates to:
  /// **'Please fill all fields'**
  String get pleaseFillAllFields;

  /// No description provided for @grievanceSubmitted.
  ///
  /// In en, this message translates to:
  /// **'Grievance submitted'**
  String get grievanceSubmitted;

  /// No description provided for @titleRequired.
  ///
  /// In en, this message translates to:
  /// **'Title is required'**
  String get titleRequired;

  /// No description provided for @description.
  ///
  /// In en, this message translates to:
  /// **'Description'**
  String get description;

  /// No description provided for @descriptionRequired.
  ///
  /// In en, this message translates to:
  /// **'Description is required'**
  String get descriptionRequired;

  /// No description provided for @categorization.
  ///
  /// In en, this message translates to:
  /// **'Categorization'**
  String get categorization;

  /// No description provided for @subjectRequired.
  ///
  /// In en, this message translates to:
  /// **'Subject is required'**
  String get subjectRequired;

  /// No description provided for @areaRequired.
  ///
  /// In en, this message translates to:
  /// **'Area is required'**
  String get areaRequired;

  /// No description provided for @locationDetails.
  ///
  /// In en, this message translates to:
  /// **'Location details'**
  String get locationDetails;

  /// No description provided for @searchByName.
  ///
  /// In en, this message translates to:
  /// **'Search by name'**
  String get searchByName;

  /// No description provided for @noResultsFound.
  ///
  /// In en, this message translates to:
  /// **'No results found'**
  String get noResultsFound;

  /// No description provided for @noMatchingGrievances.
  ///
  /// In en, this message translates to:
  /// **'No matching grievances found'**
  String get noMatchingGrievances;

  /// No description provided for @allUsersHistory.
  ///
  /// In en, this message translates to:
  /// **'All Users History'**
  String get allUsersHistory;

  /// No description provided for @edit.
  ///
  /// In en, this message translates to:
  /// **'Edit'**
  String get edit;

  /// No description provided for @areYouSureDeleteGrievance.
  ///
  /// In en, this message translates to:
  /// **'Are you sure you want to delete the grievance?'**
  String get areYouSureDeleteGrievance;

  /// No description provided for @confirmDelete.
  ///
  /// In en, this message translates to:
  /// **'Confirm Delete'**
  String get confirmDelete;

  /// No description provided for @failedToDeleteGrievance.
  ///
  /// In en, this message translates to:
  /// **'Failed to delete grievance'**
  String get failedToDeleteGrievance;

  /// No description provided for @grievanceDeletedSuccessfully.
  ///
  /// In en, this message translates to:
  /// **'Grievance deleted successfully'**
  String get grievanceDeletedSuccessfully;

  /// No description provided for @editGrievance.
  ///
  /// In en, this message translates to:
  /// **'Edit Grievance'**
  String get editGrievance;

  /// No description provided for @statusNew.
  ///
  /// In en, this message translates to:
  /// **'New'**
  String get statusNew;

  /// No description provided for @statusInProgress.
  ///
  /// In en, this message translates to:
  /// **'In Progress'**
  String get statusInProgress;

  /// No description provided for @statusResolved.
  ///
  /// In en, this message translates to:
  /// **'Resolved'**
  String get statusResolved;

  /// No description provided for @statusRejected.
  ///
  /// In en, this message translates to:
  /// **'Rejected'**
  String get statusRejected;

  /// No description provided for @statusOnHold.
  ///
  /// In en, this message translates to:
  /// **'On Hold'**
  String get statusOnHold;

  /// No description provided for @statusClosed.
  ///
  /// In en, this message translates to:
  /// **'Closed'**
  String get statusClosed;

  /// No description provided for @statusUnknown.
  ///
  /// In en, this message translates to:
  /// **'Unknown'**
  String get statusUnknown;

  /// No description provided for @submitGrievanceSubtitle.
  ///
  /// In en, this message translates to:
  /// **'Report issues in just a few taps'**
  String get submitGrievanceSubtitle;

  /// No description provided for @trackGrievancesSubtitle.
  ///
  /// In en, this message translates to:
  /// **'Real-time updates on your complaints'**
  String get trackGrievancesSubtitle;

  /// No description provided for @quickResolutionsTitle.
  ///
  /// In en, this message translates to:
  /// **'Quick Resolutions'**
  String get quickResolutionsTitle;

  /// No description provided for @quickResolutionsSubtitle.
  ///
  /// In en, this message translates to:
  /// **'Get your issues resolved faster'**
  String get quickResolutionsSubtitle;

  /// No description provided for @track.
  ///
  /// In en, this message translates to:
  /// **'Track'**
  String get track;

  /// No description provided for @stageReviewedBySupervisor.
  ///
  /// In en, this message translates to:
  /// **'Reviewed by Supervisor'**
  String get stageReviewedBySupervisor;

  /// No description provided for @stageAssignedToFieldStaff.
  ///
  /// In en, this message translates to:
  /// **'Assigned to Field Staff'**
  String get stageAssignedToFieldStaff;

  /// No description provided for @stageResolved.
  ///
  /// In en, this message translates to:
  /// **'Resolved'**
  String get stageResolved;

  /// No description provided for @submittedOn.
  ///
  /// In en, this message translates to:
  /// **'Submitted on'**
  String get submittedOn;

  /// No description provided for @userLabel.
  ///
  /// In en, this message translates to:
  /// **'User'**
  String get userLabel;

  /// No description provided for @grievanceProgressTitle.
  ///
  /// In en, this message translates to:
  /// **'Grievance Progress'**
  String get grievanceProgressTitle;

  /// No description provided for @stageSubmitted.
  ///
  /// In en, this message translates to:
  /// **'Submitted'**
  String get stageSubmitted;

  /// No description provided for @assignedToLabel.
  ///
  /// In en, this message translates to:
  /// **'Assigned to'**
  String get assignedToLabel;

  /// No description provided for @fieldStaffLabel.
  ///
  /// In en, this message translates to:
  /// **'Field Staff'**
  String get fieldStaffLabel;

  /// No description provided for @resolvedOn.
  ///
  /// In en, this message translates to:
  /// **'Resolved on'**
  String get resolvedOn;

  /// Time difference in days
  ///
  /// In en, this message translates to:
  /// **'{days, plural, one{1 day ago} other{{days} days ago}}'**
  String timeAgoDays(num days);

  /// Time difference in hours
  ///
  /// In en, this message translates to:
  /// **'{hours, plural, one{1 hour ago} other{{hours} hours ago}}'**
  String timeAgoHours(num hours);

  /// Time difference in minutes
  ///
  /// In en, this message translates to:
  /// **'{minutes, plural, one{1 minute ago} other{{minutes} minutes ago}}'**
  String timeAgoMinutes(num minutes);

  /// No description provided for @timeAgoJustNow.
  ///
  /// In en, this message translates to:
  /// **'just now'**
  String get timeAgoJustNow;

  /// No description provided for @notApplicable.
  ///
  /// In en, this message translates to:
  /// **'N/A'**
  String get notApplicable;

  /// Error message when a URL cannot be opened.
  ///
  /// In en, this message translates to:
  /// **'Could not launch {url}'**
  String couldNotLaunchUrl(Object url);

  /// No description provided for @details.
  ///
  /// In en, this message translates to:
  /// **'Details'**
  String get details;

  /// No description provided for @created.
  ///
  /// In en, this message translates to:
  /// **'Created'**
  String get created;

  /// No description provided for @lastUpdated.
  ///
  /// In en, this message translates to:
  /// **'Last Updated'**
  String get lastUpdated;

  /// No description provided for @attachments.
  ///
  /// In en, this message translates to:
  /// **'Attachments'**
  String get attachments;

  /// No description provided for @address.
  ///
  /// In en, this message translates to:
  /// **'Address'**
  String get address;

  /// No description provided for @unknownRole.
  ///
  /// In en, this message translates to:
  /// **'Unknown Role'**
  String get unknownRole;

  /// No description provided for @profilePictureUpdateMessage.
  ///
  /// In en, this message translates to:
  /// **'Profile picture selected. Save to upload.'**
  String get profilePictureUpdateMessage;

  /// No description provided for @lastLogin.
  ///
  /// In en, this message translates to:
  /// **'Last Login'**
  String get lastLogin;

  /// No description provided for @accountStatus.
  ///
  /// In en, this message translates to:
  /// **'Account Status'**
  String get accountStatus;

  /// No description provided for @statusActive.
  ///
  /// In en, this message translates to:
  /// **'Active'**
  String get statusActive;

  /// No description provided for @statusInactive.
  ///
  /// In en, this message translates to:
  /// **'Inactive'**
  String get statusInactive;

  /// No description provided for @editProfile.
  ///
  /// In en, this message translates to:
  /// **'Edit Profile'**
  String get editProfile;

  /// No description provided for @loadingData.
  ///
  /// In en, this message translates to:
  /// **'Loading...'**
  String get loadingData;

  /// No description provided for @appNameFallback.
  ///
  /// In en, this message translates to:
  /// **'PCMC App'**
  String get appNameFallback;

  /// No description provided for @packageNameFallback.
  ///
  /// In en, this message translates to:
  /// **'com.example.pcmcapp'**
  String get packageNameFallback;

  /// No description provided for @currentVersion.
  ///
  /// In en, this message translates to:
  /// **'Current Version'**
  String get currentVersion;

  /// No description provided for @minimumOS.
  ///
  /// In en, this message translates to:
  /// **'Minimum OS'**
  String get minimumOS;

  /// No description provided for @checkForUpdates.
  ///
  /// In en, this message translates to:
  /// **'Check for Updates'**
  String get checkForUpdates;

  /// No description provided for @versionInformation.
  ///
  /// In en, this message translates to:
  /// **'Version Information'**
  String get versionInformation;

  /// No description provided for @upToDate.
  ///
  /// In en, this message translates to:
  /// **'Up to date'**
  String get upToDate;

  /// No description provided for @releaseType.
  ///
  /// In en, this message translates to:
  /// **'Release Type'**
  String get releaseType;

  /// No description provided for @size.
  ///
  /// In en, this message translates to:
  /// **'Size'**
  String get size;

  /// No description provided for @thankYouMessage.
  ///
  /// In en, this message translates to:
  /// **'Thank you for using our app!'**
  String get thankYouMessage;

  /// No description provided for @needHelp.
  ///
  /// In en, this message translates to:
  /// **'Need Help?'**
  String get needHelp;

  /// No description provided for @supportTeamMessage.
  ///
  /// In en, this message translates to:
  /// **'Our support team is here to help you with any questions or issues you might have'**
  String get supportTeamMessage;

  /// No description provided for @contactOptions.
  ///
  /// In en, this message translates to:
  /// **'Contact Options'**
  String get contactOptions;

  /// No description provided for @emailSupport.
  ///
  /// In en, this message translates to:
  /// **'Email Support'**
  String get emailSupport;

  /// No description provided for @emailSupportResponseTime.
  ///
  /// In en, this message translates to:
  /// **'Get responses within 24 hours'**
  String get emailSupportResponseTime;

  /// No description provided for @callSupport.
  ///
  /// In en, this message translates to:
  /// **'Call Support'**
  String get callSupport;

  /// No description provided for @callSupportAvailability.
  ///
  /// In en, this message translates to:
  /// **'Available 9AM - 6PM (Mon-Sat)'**
  String get callSupportAvailability;

  /// No description provided for @faqsHelpCenter.
  ///
  /// In en, this message translates to:
  /// **'FAQs & Help Center'**
  String get faqsHelpCenter;

  /// No description provided for @faqsHelpCenterSubtitle.
  ///
  /// In en, this message translates to:
  /// **'Find answers to common questions'**
  String get faqsHelpCenterSubtitle;

  /// No description provided for @weAreHereToHelp.
  ///
  /// In en, this message translates to:
  /// **'We\'re here to help you!'**
  String get weAreHereToHelp;

  /// No description provided for @couldNotLaunchPhone.
  ///
  /// In en, this message translates to:
  /// **'Could not launch phone'**
  String get couldNotLaunchPhone;

  /// No description provided for @privacyPolicyCommitmentTitle.
  ///
  /// In en, this message translates to:
  /// **'Our Commitment'**
  String get privacyPolicyCommitmentTitle;

  /// No description provided for @privacyPolicyCommitmentBody.
  ///
  /// In en, this message translates to:
  /// **'We value your privacy and are committed to protecting your personal data. This policy explains how we handle your information securely.'**
  String get privacyPolicyCommitmentBody;

  /// No description provided for @privacyPolicyDataCollectionTitle.
  ///
  /// In en, this message translates to:
  /// **'1. Data Collection'**
  String get privacyPolicyDataCollectionTitle;

  /// No description provided for @privacyPolicyDataCollectionBody.
  ///
  /// In en, this message translates to:
  /// **'We collect your name, email, and grievance details only to process complaints.'**
  String get privacyPolicyDataCollectionBody;

  /// No description provided for @privacyPolicyDataUsageTitle.
  ///
  /// In en, this message translates to:
  /// **'2. Data Usage'**
  String get privacyPolicyDataUsageTitle;

  /// No description provided for @privacyPolicyDataUsageBody.
  ///
  /// In en, this message translates to:
  /// **'Your data is used solely for grievance redressal and system improvement.'**
  String get privacyPolicyDataUsageBody;

  /// No description provided for @privacyPolicySecurityTitle.
  ///
  /// In en, this message translates to:
  /// **'3. Security'**
  String get privacyPolicySecurityTitle;

  /// No description provided for @privacyPolicySecurityBody.
  ///
  /// In en, this message translates to:
  /// **'We implement encryption and strict access policies to safeguard your information.'**
  String get privacyPolicySecurityBody;

  /// No description provided for @faqsHeaderSubtitle.
  ///
  /// In en, this message translates to:
  /// **'Find answers to common questions about using our app'**
  String get faqsHeaderSubtitle;

  /// No description provided for @faqsCommonQuestions.
  ///
  /// In en, this message translates to:
  /// **'Common Questions'**
  String get faqsCommonQuestions;

  /// No description provided for @faqsStillNeedHelp.
  ///
  /// In en, this message translates to:
  /// **'Still need help?'**
  String get faqsStillNeedHelp;

  /// No description provided for @faqsContactSupportMessage.
  ///
  /// In en, this message translates to:
  /// **'Can\'t find the answer you\'re looking for? Contact our support team for assistance.'**
  String get faqsContactSupportMessage;

  /// No description provided for @faq1_q.
  ///
  /// In en, this message translates to:
  /// **'How to submit a grievance?'**
  String get faq1_q;

  /// No description provided for @faq1_a.
  ///
  /// In en, this message translates to:
  /// **'Go to \'Submit Grievance\' from the home screen and fill in details.'**
  String get faq1_a;

  /// No description provided for @faq2_q.
  ///
  /// In en, this message translates to:
  /// **'How can I track my complaint?'**
  String get faq2_q;

  /// No description provided for @faq2_a.
  ///
  /// In en, this message translates to:
  /// **'Navigate to \'Track Grievance\' and enter your grievance ID.'**
  String get faq2_a;

  /// No description provided for @faq3_q.
  ///
  /// In en, this message translates to:
  /// **'Can I upload documents?'**
  String get faq3_q;

  /// No description provided for @faq3_a.
  ///
  /// In en, this message translates to:
  /// **'Yes, you can upload photos or PDFs as proof while submitting grievances.'**
  String get faq3_a;

  /// No description provided for @faq4_q.
  ///
  /// In en, this message translates to:
  /// **'How long does it take to resolve?'**
  String get faq4_q;

  /// No description provided for @faq4_a.
  ///
  /// In en, this message translates to:
  /// **'It usually takes 7 working days, depending on priority.'**
  String get faq4_a;

  /// No description provided for @faq5_q.
  ///
  /// In en, this message translates to:
  /// **'What types of grievances can I report?'**
  String get faq5_q;

  /// No description provided for @faq5_a.
  ///
  /// In en, this message translates to:
  /// **'You can report issues related to sanitation, roads, water supply, electricity, and other civic issues.'**
  String get faq5_a;

  /// No description provided for @faq6_q.
  ///
  /// In en, this message translates to:
  /// **'Is there a way to edit my submitted grievance?'**
  String get faq6_q;

  /// No description provided for @faq6_a.
  ///
  /// In en, this message translates to:
  /// **'You can edit your grievance within 24 hours of submission from the \'My Grievances\' section.'**
  String get faq6_a;

  /// No description provided for @faq7_q.
  ///
  /// In en, this message translates to:
  /// **'How will I be notified about updates?'**
  String get faq7_q;

  /// No description provided for @faq7_a.
  ///
  /// In en, this message translates to:
  /// **'You\'ll receive push notifications and email updates when there\'s progress on your grievance.'**
  String get faq7_a;

  /// No description provided for @phoneNumber.
  ///
  /// In en, this message translates to:
  /// **'Phone Number'**
  String get phoneNumber;

  /// No description provided for @phoneNumberRequired.
  ///
  /// In en, this message translates to:
  /// **'Phone number is required'**
  String get phoneNumberRequired;

  /// No description provided for @invalidPhoneNumber.
  ///
  /// In en, this message translates to:
  /// **'Invalid phone number'**
  String get invalidPhoneNumber;

  /// No description provided for @passwordTooShort.
  ///
  /// In en, this message translates to:
  /// **'Password must be at least 6 characters'**
  String get passwordTooShort;

  /// No description provided for @departmentIdOptional.
  ///
  /// In en, this message translates to:
  /// **'Department ID (Optional)'**
  String get departmentIdOptional;

  /// No description provided for @roleCitizen.
  ///
  /// In en, this message translates to:
  /// **'CITIZEN'**
  String get roleCitizen;

  /// No description provided for @roleSupervisor.
  ///
  /// In en, this message translates to:
  /// **'SUPERVISOR'**
  String get roleSupervisor;

  /// No description provided for @roleFieldStaff.
  ///
  /// In en, this message translates to:
  /// **'FIELD_STAFF'**
  String get roleFieldStaff;

  /// No description provided for @roleAdmin.
  ///
  /// In en, this message translates to:
  /// **'ADMIN'**
  String get roleAdmin;

  /// No description provided for @noMatchingUsers.
  ///
  /// In en, this message translates to:
  /// **'No users found matching your search'**
  String get noMatchingUsers;

  /// No description provided for @searchByNameOrEmail.
  ///
  /// In en, this message translates to:
  /// **'Search by name or email...'**
  String get searchByNameOrEmail;

  /// No description provided for @welcomeBack.
  ///
  /// In en, this message translates to:
  /// **'Welcome back! Please sign in to continue'**
  String get welcomeBack;

  /// No description provided for @createAccountPrompt.
  ///
  /// In en, this message translates to:
  /// **'Create an account to get started'**
  String get createAccountPrompt;

  /// No description provided for @voterId.
  ///
  /// In en, this message translates to:
  /// **'Voter ID'**
  String get voterId;

  /// No description provided for @invalidMobileNumber.
  ///
  /// In en, this message translates to:
  /// **'Enter a valid mobile number'**
  String get invalidMobileNumber;

  /// No description provided for @citizenName.
  ///
  /// In en, this message translates to:
  /// **'Citizen Name'**
  String get citizenName;

  /// No description provided for @citizenId.
  ///
  /// In en, this message translates to:
  /// **'Citizen ID'**
  String get citizenId;

  /// No description provided for @submittedFeedback.
  ///
  /// In en, this message translates to:
  /// **'Submitted Feedback'**
  String get submittedFeedback;

  /// No description provided for @rating.
  ///
  /// In en, this message translates to:
  /// **'Rating'**
  String get rating;

  /// No description provided for @feedbackComments.
  ///
  /// In en, this message translates to:
  /// **'Feedback Comments'**
  String get feedbackComments;
}

class _AppLocalizationsDelegate
    extends LocalizationsDelegate<AppLocalizations> {
  const _AppLocalizationsDelegate();

  @override
  Future<AppLocalizations> load(Locale locale) {
    return SynchronousFuture<AppLocalizations>(lookupAppLocalizations(locale));
  }

  @override
  bool isSupported(Locale locale) =>
      <String>['en', 'hi', 'mr'].contains(locale.languageCode);

  @override
  bool shouldReload(_AppLocalizationsDelegate old) => false;
}

AppLocalizations lookupAppLocalizations(Locale locale) {
  // Lookup logic when only language code is specified.
  switch (locale.languageCode) {
    case 'en':
      return AppLocalizationsEn();
    case 'hi':
      return AppLocalizationsHi();
    case 'mr':
      return AppLocalizationsMr();
  }

  throw FlutterError(
    'AppLocalizations.delegate failed to load unsupported locale "$locale". This is likely '
    'an issue with the localizations generation tool. Please file an issue '
    'on GitHub with a reproducible sample app and the gen-l10n configuration '
    'that was used.',
  );
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\l10n\app_localizations_en.dart ---
// ignore: unused_import
import 'package:intl/intl.dart' as intl;
import 'app_localizations.dart';

// ignore_for_file: type=lint

/// The translations for English (`en`).
class AppLocalizationsEn extends AppLocalizations {
  AppLocalizationsEn([String locale = 'en']) : super(locale);

  @override
  String get appTitle => 'NIVARAN';

  @override
  String get login => 'Login';

  @override
  String get register => 'Register';

  @override
  String get submitGrievance => 'Submit Grievance';

  @override
  String get authenticationFailed => 'Authentication failed';

  @override
  String get error => 'An error occurred';

  @override
  String get name => 'Name';

  @override
  String get email => 'Email';

  @override
  String get password => 'Password';

  @override
  String get registerPrompt => 'Don\'t have an account? Register';

  @override
  String get loginPrompt => 'Already have an account? Login';

  @override
  String get googleLogin => 'Login with Google';

  @override
  String get googleLoginFailed => 'Google login failed';

  @override
  String get settings => 'Settings';

  @override
  String get darkMode => 'Dark Mode';

  @override
  String get language => 'Language';

  @override
  String get comments => 'Comments';

  @override
  String get noComments => 'No Comments Yet';

  @override
  String get noCommentsMessage => 'Be the first to add a comment!';

  @override
  String get addComment => 'Add Comment';

  @override
  String get yourComment => 'Your Comment';

  @override
  String get commentCannotBeEmpty => 'Comment cannot be empty';

  @override
  String get cancel => 'Cancel';

  @override
  String get submit => 'Submit';

  @override
  String get commentAddedSuccess => 'Comment added successfully';

  @override
  String get failedToAddComment => 'Failed to add comment';

  @override
  String get grievanceDetails => 'Grievance Details';

  @override
  String get status => 'Status';

  @override
  String get submitFeedback => 'Submit Feedback';

  @override
  String get selectRating => 'Select Rating';

  @override
  String get feedback => 'Feedback';

  @override
  String get pleaseProvideRating => 'Please provide a rating';

  @override
  String get feedbackSubmitted => 'Your feedback has been submitted';

  @override
  String get failedToLoadGrievance => 'Failed to load grievance';

  @override
  String get userHistory => 'User History';

  @override
  String get userNotFound => 'User not found';

  @override
  String get noGrievancesFound => 'No grievances found';

  @override
  String get noGrievances => 'No Grievances';

  @override
  String get noGrievancesMessage => 'There are no grievances to display.';

  @override
  String get retry => 'Retry';

  @override
  String get filterByStatus => 'Filter by Status';

  @override
  String get filterByPriority => 'Filter by Priority';

  @override
  String get filterByArea => 'Filter by Area';

  @override
  String get filterBySubject => 'Filter by Subject';

  @override
  String get reassign => 'Reassign';

  @override
  String get escalate => 'Escalate';

  @override
  String get updateStatus => 'Update Status';

  @override
  String get viewDetails => 'View Details';

  @override
  String get reassignGrievance => 'Reassign Grievance';

  @override
  String get selectAssignee => 'Select Assignee';

  @override
  String get selectStatus => 'Select Status';

  @override
  String get update => 'Update';

  @override
  String get noComplaints => 'No Complaints';

  @override
  String get noComplaintsMessage => 'There are no complaints to display.';

  @override
  String get tryAgain => 'Retry';

  @override
  String get reassignComplaint => 'Assign';

  @override
  String get escalateComplaint => 'Escalate';

  @override
  String get userIdRequired => 'User ID is required';

  @override
  String get noConfigs => 'No Configurations';

  @override
  String get noConfigsMessage =>
      'There are no configurations to display. Add one below.';

  @override
  String get addConfig => 'Add Configuration';

  @override
  String get editConfig => 'Edit Configuration';

  @override
  String get configKey => 'Configuration Key';

  @override
  String get configValue => 'Configuration Value';

  @override
  String get configCannotBeEmpty => 'Key and Value cannot be empty';

  @override
  String get configValueCannotBeEmpty => 'Value cannot be empty';

  @override
  String get configAddedSuccess => 'Configuration added successfully';

  @override
  String get configUpdatedSuccess => 'Configuration updated successfully';

  @override
  String get track_grievances => 'Track Your Grievances';

  @override
  String get no_grievances => 'No Grievances Yet';

  @override
  String get no_grievances_message =>
      'Submit your first grievance to get started';

  @override
  String get submit_grievance => 'Submit Grievance';

  @override
  String get your_grievances => 'Your Grievances';

  @override
  String get please_login => 'Please login';

  @override
  String get addUser => 'Add User';

  @override
  String get role => 'Role';

  @override
  String get add => 'Add';

  @override
  String get userAddedSuccess => 'User added successfully';

  @override
  String get failedToAddUser => 'Failed to add user';

  @override
  String get editUser => 'Edit User';

  @override
  String get deleteUser => 'Delete User';

  @override
  String get userUpdatedSuccess => 'User updated successfully';

  @override
  String get failedToUpdateUser => 'Failed to update user';

  @override
  String get deleteUserConfirmation =>
      'Are you sure you want to delete this user?';

  @override
  String get userDeletedSuccess => 'User deleted successfully';

  @override
  String get delete => 'Delete';

  @override
  String get failedToDeleteUser => 'Failed to delete User';

  @override
  String get manageUsers => 'Manage Users';

  @override
  String get noUsers => 'No Users';

  @override
  String get noUsersMessage => 'There are no users to display.';

  @override
  String get noEmail => 'No Email';

  @override
  String get loading => 'Processing login...';

  @override
  String get viewgrievanceetails => 'View Grievances';

  @override
  String get assignGrievance => 'Assign Grievance';

  @override
  String get rejectGrievance => 'Reject Grievance';

  @override
  String get rejectionReason => 'Rejection Reason';

  @override
  String get reject => 'Reject';

  @override
  String get assignedGrievances => 'Assigned Grievances';

  @override
  String get noAssigned => 'No Assigned Grievances';

  @override
  String get noAssignedMessage => 'There are no grievances assigned to you.';

  @override
  String get upload => 'Upload';

  @override
  String get uploadWorkproof => 'Upload Work Proof';

  @override
  String get guest => 'Guest';

  @override
  String get invalidRole => 'Invalid Role';

  @override
  String get profile => 'Profile';

  @override
  String get logout => 'Logout';

  @override
  String get logoutFailed => 'Logout Failed';

  @override
  String get notifications => 'Notifications';

  @override
  String get save => 'Save';

  @override
  String get appVersion => 'App Version';

  @override
  String get about => 'About';

  @override
  String get contactSupport => 'Contact Support';

  @override
  String get faqs => 'FAQs';

  @override
  String get helpSupport => 'Help & Support';

  @override
  String get viewPrivacyPolicyprivacySecurity =>
      'View Privacy Policy / Privacy & Security';

  @override
  String get enableNotifications => 'Enable Notifications';

  @override
  String get account => 'Account';

  @override
  String get privacySecurity => 'Privacy & Security';

  @override
  String get viewPrivacyPolicy => 'View Privacy Policy';

  @override
  String get invalidEmail => 'Invalid Email';

  @override
  String get nameRequired => 'Name is required';

  @override
  String get emailRequired => 'Email is required';

  @override
  String get passwordRequired => 'Password is required';

  @override
  String get recentComplaints => 'Recent Complaints';

  @override
  String get filterByPeriod => 'Filter by Period';

  @override
  String get totalComplaints => 'Total Complaints';

  @override
  String get day => 'Day';

  @override
  String get week => 'Week';

  @override
  String get month => 'Month';

  @override
  String get year => 'Year';

  @override
  String get allTime => 'All Time';

  @override
  String get complaintStatusOverview => 'Complaint Status Overview';

  @override
  String get grievanceTrend => 'Grievance Trend';

  @override
  String get numberOfGrievances => 'Number of Grievances';

  @override
  String get timePeriod => 'Time Period';

  @override
  String get deptWiseDistribution => 'Department-wise Distribution';

  @override
  String get department => 'Department';

  @override
  String get slaMetrics => 'SLA Metrics';

  @override
  String get slaDays => 'SLA Days';

  @override
  String get complianceRate => 'Compliance Rate';

  @override
  String get avgResolutionTime => 'Avg Resolution Time';

  @override
  String get exportPDF => 'Export PDF';

  @override
  String get exportCSV => 'Export CSV';

  @override
  String get exportExcel => 'Export Excel';

  @override
  String get reportExported => 'Report exported';

  @override
  String get errorExportingReport => 'Error exporting report';

  @override
  String get viewAuditLogs => 'View Audit Logs';

  @override
  String get complaintManagement => 'Complaint Management';

  @override
  String get manageConfigs => 'Manage Configurations';

  @override
  String get manageSubjects => 'Manage Subjects';

  @override
  String get manageAreas => 'Manage Areas';

  @override
  String get reports => 'Reports';

  @override
  String get assignedList => 'Assigned Grievances';

  @override
  String get announcements => 'Announcements';

  @override
  String get privacyPolicy => 'Privacy Policy';

  @override
  String get clearFilters => 'Clear Filters';

  @override
  String get addAnnouncement => 'Add Announcement';

  @override
  String get noAnnouncements => 'No announcements available';

  @override
  String get title => 'Title';

  @override
  String get message => 'Message';

  @override
  String get type => 'Type';

  @override
  String get targetRole => 'Target Role';

  @override
  String get selectExpiration => 'Select Expiration';

  @override
  String get announcementAdded => 'Announcement added successfully';

  @override
  String get takeAction => 'Take Action';

  @override
  String get refresh => 'Refresh';

  @override
  String get exportReports => 'Export Reports';

  @override
  String get filters => 'Filters';

  @override
  String get apply => 'Apply';

  @override
  String get locationPermissionDenied => 'Location permission denied';

  @override
  String get pleaseFillAllFields => 'Please fill all fields';

  @override
  String get grievanceSubmitted => 'Grievance submitted';

  @override
  String get titleRequired => 'Title is required';

  @override
  String get description => 'Description';

  @override
  String get descriptionRequired => 'Description is required';

  @override
  String get categorization => 'Categorization';

  @override
  String get subjectRequired => 'Subject is required';

  @override
  String get areaRequired => 'Area is required';

  @override
  String get locationDetails => 'Location details';

  @override
  String get searchByName => 'Search by name';

  @override
  String get noResultsFound => 'No results found';

  @override
  String get noMatchingGrievances => 'No matching grievances found';

  @override
  String get allUsersHistory => 'All Users History';

  @override
  String get edit => 'Edit';

  @override
  String get areYouSureDeleteGrievance =>
      'Are you sure you want to delete the grievance?';

  @override
  String get confirmDelete => 'Confirm Delete';

  @override
  String get failedToDeleteGrievance => 'Failed to delete grievance';

  @override
  String get grievanceDeletedSuccessfully => 'Grievance deleted successfully';

  @override
  String get editGrievance => 'Edit Grievance';

  @override
  String get statusNew => 'New';

  @override
  String get statusInProgress => 'In Progress';

  @override
  String get statusResolved => 'Resolved';

  @override
  String get statusRejected => 'Rejected';

  @override
  String get statusOnHold => 'On Hold';

  @override
  String get statusClosed => 'Closed';

  @override
  String get statusUnknown => 'Unknown';

  @override
  String get submitGrievanceSubtitle => 'Report issues in just a few taps';

  @override
  String get trackGrievancesSubtitle => 'Real-time updates on your complaints';

  @override
  String get quickResolutionsTitle => 'Quick Resolutions';

  @override
  String get quickResolutionsSubtitle => 'Get your issues resolved faster';

  @override
  String get track => 'Track';

  @override
  String get stageReviewedBySupervisor => 'Reviewed by Supervisor';

  @override
  String get stageAssignedToFieldStaff => 'Assigned to Field Staff';

  @override
  String get stageResolved => 'Resolved';

  @override
  String get submittedOn => 'Submitted on';

  @override
  String get userLabel => 'User';

  @override
  String get grievanceProgressTitle => 'Grievance Progress';

  @override
  String get stageSubmitted => 'Submitted';

  @override
  String get assignedToLabel => 'Assigned to';

  @override
  String get fieldStaffLabel => 'Field Staff';

  @override
  String get resolvedOn => 'Resolved on';

  @override
  String timeAgoDays(num days) {
    String _temp0 = intl.Intl.pluralLogic(
      days,
      locale: localeName,
      other: '$days days ago',
      one: '1 day ago',
    );
    return '$_temp0';
  }

  @override
  String timeAgoHours(num hours) {
    String _temp0 = intl.Intl.pluralLogic(
      hours,
      locale: localeName,
      other: '$hours hours ago',
      one: '1 hour ago',
    );
    return '$_temp0';
  }

  @override
  String timeAgoMinutes(num minutes) {
    String _temp0 = intl.Intl.pluralLogic(
      minutes,
      locale: localeName,
      other: '$minutes minutes ago',
      one: '1 minute ago',
    );
    return '$_temp0';
  }

  @override
  String get timeAgoJustNow => 'just now';

  @override
  String get notApplicable => 'N/A';

  @override
  String couldNotLaunchUrl(Object url) {
    return 'Could not launch $url';
  }

  @override
  String get details => 'Details';

  @override
  String get created => 'Created';

  @override
  String get lastUpdated => 'Last Updated';

  @override
  String get attachments => 'Attachments';

  @override
  String get address => 'Address';

  @override
  String get unknownRole => 'Unknown Role';

  @override
  String get profilePictureUpdateMessage =>
      'Profile picture selected. Save to upload.';

  @override
  String get lastLogin => 'Last Login';

  @override
  String get accountStatus => 'Account Status';

  @override
  String get statusActive => 'Active';

  @override
  String get statusInactive => 'Inactive';

  @override
  String get editProfile => 'Edit Profile';

  @override
  String get loadingData => 'Loading...';

  @override
  String get appNameFallback => 'PCMC App';

  @override
  String get packageNameFallback => 'com.example.pcmcapp';

  @override
  String get currentVersion => 'Current Version';

  @override
  String get minimumOS => 'Minimum OS';

  @override
  String get checkForUpdates => 'Check for Updates';

  @override
  String get versionInformation => 'Version Information';

  @override
  String get upToDate => 'Up to date';

  @override
  String get releaseType => 'Release Type';

  @override
  String get size => 'Size';

  @override
  String get thankYouMessage => 'Thank you for using our app!';

  @override
  String get needHelp => 'Need Help?';

  @override
  String get supportTeamMessage =>
      'Our support team is here to help you with any questions or issues you might have';

  @override
  String get contactOptions => 'Contact Options';

  @override
  String get emailSupport => 'Email Support';

  @override
  String get emailSupportResponseTime => 'Get responses within 24 hours';

  @override
  String get callSupport => 'Call Support';

  @override
  String get callSupportAvailability => 'Available 9AM - 6PM (Mon-Sat)';

  @override
  String get faqsHelpCenter => 'FAQs & Help Center';

  @override
  String get faqsHelpCenterSubtitle => 'Find answers to common questions';

  @override
  String get weAreHereToHelp => 'We\'re here to help you!';

  @override
  String get couldNotLaunchPhone => 'Could not launch phone';

  @override
  String get privacyPolicyCommitmentTitle => 'Our Commitment';

  @override
  String get privacyPolicyCommitmentBody =>
      'We value your privacy and are committed to protecting your personal data. This policy explains how we handle your information securely.';

  @override
  String get privacyPolicyDataCollectionTitle => '1. Data Collection';

  @override
  String get privacyPolicyDataCollectionBody =>
      'We collect your name, email, and grievance details only to process complaints.';

  @override
  String get privacyPolicyDataUsageTitle => '2. Data Usage';

  @override
  String get privacyPolicyDataUsageBody =>
      'Your data is used solely for grievance redressal and system improvement.';

  @override
  String get privacyPolicySecurityTitle => '3. Security';

  @override
  String get privacyPolicySecurityBody =>
      'We implement encryption and strict access policies to safeguard your information.';

  @override
  String get faqsHeaderSubtitle =>
      'Find answers to common questions about using our app';

  @override
  String get faqsCommonQuestions => 'Common Questions';

  @override
  String get faqsStillNeedHelp => 'Still need help?';

  @override
  String get faqsContactSupportMessage =>
      'Can\'t find the answer you\'re looking for? Contact our support team for assistance.';

  @override
  String get faq1_q => 'How to submit a grievance?';

  @override
  String get faq1_a =>
      'Go to \'Submit Grievance\' from the home screen and fill in details.';

  @override
  String get faq2_q => 'How can I track my complaint?';

  @override
  String get faq2_a =>
      'Navigate to \'Track Grievance\' and enter your grievance ID.';

  @override
  String get faq3_q => 'Can I upload documents?';

  @override
  String get faq3_a =>
      'Yes, you can upload photos or PDFs as proof while submitting grievances.';

  @override
  String get faq4_q => 'How long does it take to resolve?';

  @override
  String get faq4_a =>
      'It usually takes 7 working days, depending on priority.';

  @override
  String get faq5_q => 'What types of grievances can I report?';

  @override
  String get faq5_a =>
      'You can report issues related to sanitation, roads, water supply, electricity, and other civic issues.';

  @override
  String get faq6_q => 'Is there a way to edit my submitted grievance?';

  @override
  String get faq6_a =>
      'You can edit your grievance within 24 hours of submission from the \'My Grievances\' section.';

  @override
  String get faq7_q => 'How will I be notified about updates?';

  @override
  String get faq7_a =>
      'You\'ll receive push notifications and email updates when there\'s progress on your grievance.';

  @override
  String get phoneNumber => 'Phone Number';

  @override
  String get phoneNumberRequired => 'Phone number is required';

  @override
  String get invalidPhoneNumber => 'Invalid phone number';

  @override
  String get passwordTooShort => 'Password must be at least 6 characters';

  @override
  String get departmentIdOptional => 'Department ID (Optional)';

  @override
  String get roleCitizen => 'CITIZEN';

  @override
  String get roleSupervisor => 'SUPERVISOR';

  @override
  String get roleFieldStaff => 'FIELD_STAFF';

  @override
  String get roleAdmin => 'ADMIN';

  @override
  String get noMatchingUsers => 'No users found matching your search';

  @override
  String get searchByNameOrEmail => 'Search by name or email...';

  @override
  String get welcomeBack => 'Welcome back! Please sign in to continue';

  @override
  String get createAccountPrompt => 'Create an account to get started';

  @override
  String get voterId => 'Voter ID';

  @override
  String get invalidMobileNumber => 'Enter a valid mobile number';

  @override
  String get citizenName => 'Citizen Name';

  @override
  String get citizenId => 'Citizen ID';

  @override
  String get submittedFeedback => 'Submitted Feedback';

  @override
  String get rating => 'Rating';

  @override
  String get feedbackComments => 'Feedback Comments';
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\l10n\app_localizations_hi.dart ---
// ignore: unused_import
import 'package:intl/intl.dart' as intl;
import 'app_localizations.dart';

// ignore_for_file: type=lint

/// The translations for Hindi (`hi`).
class AppLocalizationsHi extends AppLocalizations {
  AppLocalizationsHi([String locale = 'hi']) : super(locale);

  @override
  String get appTitle => 'निवारण';

  @override
  String get login => 'लॉगिन';

  @override
  String get register => 'पंजीकरण';

  @override
  String get submitGrievance => 'शिकायत सबमिट करें';

  @override
  String get authenticationFailed => 'प्रमाणीकरण विफल';

  @override
  String get error => 'एक त्रुटि हुई';

  @override
  String get name => 'नाम';

  @override
  String get email => 'ईमेल';

  @override
  String get password => 'पासवर्ड';

  @override
  String get registerPrompt => 'खाता नहीं है? पंजीकरण करें';

  @override
  String get loginPrompt => 'पहले से खाता है? लॉगिन करें';

  @override
  String get googleLogin => 'गूगल के साथ लॉगिन';

  @override
  String get googleLoginFailed => 'गूगल लॉगिन विफल';

  @override
  String get settings => 'सेटिंग्स';

  @override
  String get darkMode => 'डार्क मोड';

  @override
  String get language => 'भाषा';

  @override
  String get comments => 'टिप्पणियाँ';

  @override
  String get noComments => 'अभी तक कोई टिप्पणी नहीं';

  @override
  String get noCommentsMessage => 'सबसे पहले टिप्पणी करें!';

  @override
  String get addComment => 'टिप्पणी जोड़ें';

  @override
  String get yourComment => 'आपकी टिप्पणी';

  @override
  String get commentCannotBeEmpty => 'टिप्पणी खाली नहीं हो सकती';

  @override
  String get cancel => 'रद्द करें';

  @override
  String get submit => 'सबमिट करें';

  @override
  String get commentAddedSuccess => 'टिप्पणी सफलतापूर्वक जोड़ दी गई';

  @override
  String get failedToAddComment => 'टिप्पणी जोड़ने में विफल';

  @override
  String get grievanceDetails => 'शिकायत विवरण';

  @override
  String get status => 'स्थिति';

  @override
  String get submitFeedback => 'प्रतिक्रिया सबमिट करें';

  @override
  String get selectRating => 'रेटिंग चुनें';

  @override
  String get feedback => 'प्रतिक्रिया';

  @override
  String get pleaseProvideRating => 'कृपया रेटिंग दें';

  @override
  String get feedbackSubmitted => 'आपकी प्रतिक्रिया सबमिट हो गई है';

  @override
  String get failedToLoadGrievance => 'शिकायत लोड करने में विफल';

  @override
  String get userHistory => 'उपयोगकर्ता इतिहास';

  @override
  String get userNotFound => 'उपयोगकर्ता नहीं मिला';

  @override
  String get noGrievancesFound => 'कोई शिकायत नहीं मिली';

  @override
  String get noGrievances => 'कोई शिकायत नहीं';

  @override
  String get noGrievancesMessage => 'प्रदर्शित करने के लिए कोई शिकायत नहीं है।';

  @override
  String get retry => 'पुनः प्रयास करें';

  @override
  String get filterByStatus => 'स्थिति अनुसार फ़िल्टर करें';

  @override
  String get filterByPriority => 'प्राथमिकता अनुसार फ़िल्टर करें';

  @override
  String get filterByArea => 'क्षेत्र अनुसार फ़िल्टर करें';

  @override
  String get filterBySubject => 'विषय अनुसार फ़िल्टर करें';

  @override
  String get reassign => 'पुनः असाइन करें';

  @override
  String get escalate => 'एस्केलेट करें';

  @override
  String get updateStatus => 'स्थिति अपडेट करें';

  @override
  String get viewDetails => 'विवरण देखें';

  @override
  String get reassignGrievance => 'शिकायत पुनः असाइन करें';

  @override
  String get selectAssignee => 'असाइनी चुनें';

  @override
  String get selectStatus => 'स्थिति चुनें';

  @override
  String get update => 'अपडेट करें';

  @override
  String get noComplaints => 'कोई शिकायत नहीं';

  @override
  String get noComplaintsMessage => 'प्रदर्शित करने के लिए कोई शिकायत नहीं है।';

  @override
  String get tryAgain => 'पुनः प्रयास करें';

  @override
  String get reassignComplaint => 'शिकायत सौंपें';

  @override
  String get escalateComplaint => 'शिकायत बढ़ाएँ';

  @override
  String get userIdRequired => 'उपयोगकर्ता आईडी आवश्यक है';

  @override
  String get noConfigs => 'कोई कॉन्फ़िगरेशन नहीं';

  @override
  String get noConfigsMessage =>
      'प्रदर्शित करने के लिए कोई कॉन्फ़िगरेशन नहीं है। नीचे एक जोड़ें।';

  @override
  String get addConfig => 'कॉन्फ़िगरेशन जोड़ें';

  @override
  String get editConfig => 'कॉन्फ़िगरेशन संपादित करें';

  @override
  String get configKey => 'कॉन्फ़िगरेशन कुंजी';

  @override
  String get configValue => 'कॉन्फ़िगरेशन मान';

  @override
  String get configCannotBeEmpty => 'कुंजी और मान खाली नहीं हो सकते';

  @override
  String get configValueCannotBeEmpty => 'मान खाली नहीं हो सकता';

  @override
  String get configAddedSuccess => 'कॉन्फ़िगरेशन सफलतापूर्वक जोड़ा गया';

  @override
  String get configUpdatedSuccess => 'कॉन्फ़िगरेशन सफलतापूर्वक अपडेट किया गया';

  @override
  String get track_grievances => 'अपनी शिकायतें ट्रैक करें';

  @override
  String get no_grievances => 'अभी तक कोई शिकायत नहीं';

  @override
  String get no_grievances_message =>
      'शुरू करने के लिए अपनी पहली शिकायत दर्ज करें';

  @override
  String get submit_grievance => 'शिकायत दर्ज करें';

  @override
  String get your_grievances => 'आपकी शिकायतें';

  @override
  String get please_login => 'कृपया लॉगिन करें';

  @override
  String get addUser => 'उपयोगकर्ता जोड़ें';

  @override
  String get role => 'भूमिका';

  @override
  String get add => 'जोड़ें';

  @override
  String get userAddedSuccess => 'उपयोगकर्ता सफलतापूर्वक जोड़ा गया';

  @override
  String get failedToAddUser => 'उपयोगकर्ता जोड़ने में विफल';

  @override
  String get editUser => 'उपयोगकर्ता संपादित करें';

  @override
  String get deleteUser => 'उपयोगकर्ता हटाएं';

  @override
  String get userUpdatedSuccess => 'उपयोगकर्ता सफलतापूर्वक अपडेट किया गया';

  @override
  String get failedToUpdateUser => 'उपयोगकर्ता अपडेट करने में विफल';

  @override
  String get deleteUserConfirmation =>
      'क्या आप वाकई इस उपयोगकर्ता को हटाना चाहते हैं?';

  @override
  String get userDeletedSuccess => 'उपयोगकर्ता सफलतापूर्वक हटाया गया';

  @override
  String get delete => 'हटाएं';

  @override
  String get failedToDeleteUser => 'उपयोगकर्ता हटाने में विफल';

  @override
  String get manageUsers => 'उपयोगकर्ताओं का प्रबंधन करें';

  @override
  String get noUsers => 'कोई उपयोगकर्ता नहीं';

  @override
  String get noUsersMessage => 'दिखाने के लिए कोई उपयोगकर्ता नहीं है।';

  @override
  String get noEmail => 'कोई ईमेल नहीं';

  @override
  String get loading => 'लॉगिन प्रक्रिया चल रही है...';

  @override
  String get viewgrievanceetails => 'View Grievances';

  @override
  String get assignGrievance => 'शिकायत सौंपें';

  @override
  String get rejectGrievance => 'शिकायत अस्वीकारें';

  @override
  String get rejectionReason => 'अस्वीकृति का कारण';

  @override
  String get reject => 'अस्वीकारें';

  @override
  String get assignedGrievances => 'सौंपे गए शिकायतें';

  @override
  String get noAssigned => 'कोई शिकायतें नहीं सौंपी गई';

  @override
  String get noAssignedMessage => 'आपको कोई शिकायतें नहीं सौंपी गई हैं।';

  @override
  String get upload => 'अपलोड करें';

  @override
  String get uploadWorkproof => 'कार्य का प्रमाण अपलोड करें';

  @override
  String get guest => 'अतिथि';

  @override
  String get invalidRole => 'अमान्य भूमिका';

  @override
  String get profile => 'प्रोफ़ाइल';

  @override
  String get logout => 'लॉगआउट';

  @override
  String get logoutFailed => 'लॉगआउट विफल रहा';

  @override
  String get notifications => 'सूचनाएँ';

  @override
  String get save => 'सहेजें';

  @override
  String get appVersion => 'ऐप संस्करण';

  @override
  String get about => 'के बारे में';

  @override
  String get contactSupport => 'सहायता से संपर्क करें';

  @override
  String get faqs => 'अक्सर पूछे जाने वाले प्रश्न';

  @override
  String get helpSupport => 'मदद और समर्थन';

  @override
  String get viewPrivacyPolicyprivacySecurity =>
      'गोपनीयता नीति / गोपनीयता और सुरक्षा देखें';

  @override
  String get enableNotifications => 'सूचनाएं सक्षम करें';

  @override
  String get account => 'खाता';

  @override
  String get privacySecurity => 'गोपनीयता और सुरक्षा';

  @override
  String get viewPrivacyPolicy => 'गोपनीयता नीति देखें';

  @override
  String get invalidEmail => 'अमान्य ईमेल';

  @override
  String get nameRequired => 'नाम आवश्यक है';

  @override
  String get emailRequired => 'ईमेल आवश्यक है';

  @override
  String get passwordRequired => 'पासवर्ड आवश्यक है';

  @override
  String get recentComplaints => 'हाल की शिकायतें';

  @override
  String get filterByPeriod => 'अवधि अनुसार फ़िल्टर करें';

  @override
  String get totalComplaints => 'कुल शिकायतें';

  @override
  String get day => 'दिन';

  @override
  String get week => 'सप्ताह';

  @override
  String get month => 'महीना';

  @override
  String get year => 'साल';

  @override
  String get allTime => 'सभी समय';

  @override
  String get complaintStatusOverview => 'शिकायत स्थिति अवलोकन';

  @override
  String get grievanceTrend => 'शिकायत प्रवृत्ति';

  @override
  String get numberOfGrievances => 'शिकायतों की संख्या';

  @override
  String get timePeriod => 'समय अवधि';

  @override
  String get deptWiseDistribution => 'विभागवार वितरण';

  @override
  String get department => 'विभाग';

  @override
  String get slaMetrics => 'SLA मेट्रिक्स';

  @override
  String get slaDays => 'SLA दिन';

  @override
  String get complianceRate => 'अनुपालन दर';

  @override
  String get avgResolutionTime => 'औसत समाधान समय';

  @override
  String get exportPDF => 'PDF निर्यात करें';

  @override
  String get exportCSV => 'CSV निर्यात करें';

  @override
  String get exportExcel => 'Excel निर्यात करें';

  @override
  String get reportExported => 'रिपोर्ट निर्यात की गई';

  @override
  String get errorExportingReport => 'रिपोर्ट निर्यात करने में त्रुटि';

  @override
  String get viewAuditLogs => 'ऑडिट लॉग देखें';

  @override
  String get complaintManagement => 'शिकायत प्रबंधन';

  @override
  String get manageConfigs => 'कॉन्फ़िगरेशन प्रबंधित करें';

  @override
  String get manageSubjects => 'विषयों का प्रबंधन करें';

  @override
  String get manageAreas => 'क्षेत्र प्रबंधित करें';

  @override
  String get reports => 'रिपोर्ट्स';

  @override
  String get assignedList => 'निर्धारित शिकायतें';

  @override
  String get announcements => 'सूचनाएँ';

  @override
  String get privacyPolicy => 'गोपनीयता नीति';

  @override
  String get clearFilters => 'फ़िल्टर साफ़ करें';

  @override
  String get addAnnouncement => 'घोषणा जोड़ें';

  @override
  String get noAnnouncements => 'कोई घोषणाएँ उपलब्ध नहीं हैं';

  @override
  String get title => 'शीर्षक';

  @override
  String get message => 'संदेश';

  @override
  String get type => 'प्रकार';

  @override
  String get targetRole => 'लक्षित भूमिका';

  @override
  String get selectExpiration => 'समाप्ति तिथि चुनें';

  @override
  String get announcementAdded => 'घोषणा सफलतापूर्वक जोड़ी गई';

  @override
  String get takeAction => 'कार्रवाई करें';

  @override
  String get refresh => 'ताज़ा करें';

  @override
  String get exportReports => 'रिपोर्ट निर्यात करें';

  @override
  String get filters => 'फ़िल्टर';

  @override
  String get apply => 'लागू करें';

  @override
  String get locationPermissionDenied => 'स्थान अनुमति अस्वीकृत';

  @override
  String get pleaseFillAllFields => 'कृपया सभी फ़ील्ड भरें';

  @override
  String get grievanceSubmitted => 'शिकायत दर्ज की गई';

  @override
  String get titleRequired => 'शीर्षक आवश्यक है';

  @override
  String get description => 'विवरण';

  @override
  String get descriptionRequired => 'विवरण आवश्यक है';

  @override
  String get categorization => 'श्रेणीकरण';

  @override
  String get subjectRequired => 'विषय आवश्यक है';

  @override
  String get areaRequired => 'क्षेत्र आवश्यक है';

  @override
  String get locationDetails => 'स्थान विवरण';

  @override
  String get searchByName => 'नाम से खोजें';

  @override
  String get noResultsFound => 'कोई परिणाम नहीं मिला';

  @override
  String get noMatchingGrievances => 'कोई मिलान करने वाली शिकायतें नहीं मिलीं';

  @override
  String get allUsersHistory => 'सभी उपयोगकर्ताओं का इतिहास';

  @override
  String get edit => 'संपादित करें';

  @override
  String get areYouSureDeleteGrievance =>
      'क्या आप वाकई शिकायत हटाना चाहते हैं?';

  @override
  String get confirmDelete => 'हटाने की पुष्टि करें';

  @override
  String get failedToDeleteGrievance => 'शिकायत हटाने में विफल';

  @override
  String get grievanceDeletedSuccessfully => 'शिकायत सफलतापूर्वक हटाई गई';

  @override
  String get editGrievance => 'शिकायत संपादित करें';

  @override
  String get statusNew => 'नया';

  @override
  String get statusInProgress => 'प्रगति में';

  @override
  String get statusResolved => 'हल किया गया';

  @override
  String get statusRejected => 'अस्वीकृत';

  @override
  String get statusOnHold => 'होल्ड पर';

  @override
  String get statusClosed => 'बंद';

  @override
  String get statusUnknown => 'अज्ञात';

  @override
  String get submitGrievanceSubtitle =>
      'कुछ ही टैप में समस्याओं की रिपोर्ट करें';

  @override
  String get trackGrievancesSubtitle => 'आपकी शिकायतों पर रीयल-टाइम अपडेट';

  @override
  String get quickResolutionsTitle => 'त्वरित समाधान';

  @override
  String get quickResolutionsSubtitle => 'अपनी समस्याओं का तेजी से समाधान पाएं';

  @override
  String get track => 'ट्रैक';

  @override
  String get stageReviewedBySupervisor => 'पर्यवेक्षक द्वारा समीक्षा की गई';

  @override
  String get stageAssignedToFieldStaff => 'फील्ड स्टाफ को सौंपा गया';

  @override
  String get stageResolved => 'हल किया गया';

  @override
  String get submittedOn => 'पर जमा किया गया';

  @override
  String get userLabel => 'उपयोगकर्ता';

  @override
  String get grievanceProgressTitle => 'शिकायत प्रगति';

  @override
  String get stageSubmitted => 'जमा किया गया';

  @override
  String get assignedToLabel => 'को सौंपा गया';

  @override
  String get fieldStaffLabel => 'फील्ड स्टाफ';

  @override
  String get resolvedOn => 'पर हल किया गया';

  @override
  String timeAgoDays(num days) {
    String _temp0 = intl.Intl.pluralLogic(
      days,
      locale: localeName,
      other: '$days दिन पहले',
      one: '1 दिन पहले',
    );
    return '$_temp0';
  }

  @override
  String timeAgoHours(num hours) {
    String _temp0 = intl.Intl.pluralLogic(
      hours,
      locale: localeName,
      other: '$hours घंटे पहले',
      one: '1 घंटा पहले',
    );
    return '$_temp0';
  }

  @override
  String timeAgoMinutes(num minutes) {
    String _temp0 = intl.Intl.pluralLogic(
      minutes,
      locale: localeName,
      other: '$minutes मिनट पहले',
      one: '1 मिनट पहले',
    );
    return '$_temp0';
  }

  @override
  String get timeAgoJustNow => 'अभी';

  @override
  String get notApplicable => 'लागू नहीं';

  @override
  String couldNotLaunchUrl(Object url) {
    return '$url लॉन्च नहीं किया जा सका';
  }

  @override
  String get details => 'विवरण';

  @override
  String get created => 'बनाया गया';

  @override
  String get lastUpdated => 'अंतिम अपडेट';

  @override
  String get attachments => 'अटैचमेंट्स';

  @override
  String get address => 'पता';

  @override
  String get unknownRole => 'अज्ञात भूमिका';

  @override
  String get profilePictureUpdateMessage =>
      'प्रोफ़ाइल चित्र चुना गया। अपलोड करने के लिए सहेजें।';

  @override
  String get lastLogin => 'अंतिम लॉगिन';

  @override
  String get accountStatus => 'खाते की स्थिति';

  @override
  String get statusActive => 'सक्रिय';

  @override
  String get statusInactive => 'निष्क्रिय';

  @override
  String get editProfile => 'प्रोफ़ाइल संपादित करें';

  @override
  String get loadingData => 'लोड हो रहा है...';

  @override
  String get appNameFallback => 'पीसीएमसी ऐप';

  @override
  String get packageNameFallback => 'com.example.pcmcapp';

  @override
  String get currentVersion => 'वर्तमान संस्करण';

  @override
  String get minimumOS => 'न्यूनतम ओएस';

  @override
  String get checkForUpdates => 'अपडेट्स के लिए जांचें';

  @override
  String get versionInformation => 'संस्करण जानकारी';

  @override
  String get upToDate => 'अप टू डेट';

  @override
  String get releaseType => 'रिलीज प्रकार';

  @override
  String get size => 'आकार';

  @override
  String get thankYouMessage => 'हमारे ऐप का उपयोग करने के लिए धन्यवाद!';

  @override
  String get needHelp => 'मदद चाहिए?';

  @override
  String get supportTeamMessage =>
      'हमारी सहायता टीम आपके किसी भी प्रश्न या समस्या में मदद करने के लिए यहाँ है';

  @override
  String get contactOptions => 'संपर्क विकल्प';

  @override
  String get emailSupport => 'ईमेल सहायता';

  @override
  String get emailSupportResponseTime => '24 घंटे के भीतर जवाब पाएं';

  @override
  String get callSupport => 'कॉल सहायता';

  @override
  String get callSupportAvailability =>
      'सुबह 9 बजे से शाम 6 बजे तक (सोम-शनि) उपलब्ध';

  @override
  String get faqsHelpCenter => 'अक्सर पूछे जाने वाले प्रश्न और सहायता केंद्र';

  @override
  String get faqsHelpCenterSubtitle => 'सामान्य प्रश्नों के उत्तर खोजें';

  @override
  String get weAreHereToHelp => 'हम आपकी मदद के लिए यहां हैं!';

  @override
  String get couldNotLaunchPhone => 'फोन लॉन्च नहीं किया जा सका';

  @override
  String get privacyPolicyCommitmentTitle => 'हमारी प्रतिबद्धता';

  @override
  String get privacyPolicyCommitmentBody =>
      'हम आपकी गोपनीयता का महत्व देते हैं और आपके व्यक्तिगत डेटा की सुरक्षा के लिए प्रतिबद्ध हैं। यह नीति बताती है कि हम आपकी जानकारी को सुरक्षित रूप से कैसे संभालते हैं।';

  @override
  String get privacyPolicyDataCollectionTitle => '१. डेटा संग्रह';

  @override
  String get privacyPolicyDataCollectionBody =>
      'हम शिकायतों पर कार्रवाई करने के लिए केवल आपका नाम, ईमेल और शिकायत विवरण एकत्र करते हैं।';

  @override
  String get privacyPolicyDataUsageTitle => '२. डेटा उपयोग';

  @override
  String get privacyPolicyDataUsageBody =>
      'आपका डेटा केवल शिकायत निवारण और सिस्टम सुधार के लिए उपयोग किया जाता है।';

  @override
  String get privacyPolicySecurityTitle => '३. सुरक्षा';

  @override
  String get privacyPolicySecurityBody =>
      'हम आपकी जानकारी को सुरक्षित रखने के लिए एन्क्रिप्शन और सख्त पहुंच नीतियां लागू करते हैं।';

  @override
  String get faqsHeaderSubtitle =>
      'हमारे ऐप का उपयोग करने के बारे में सामान्य प्रश्नों के उत्तर खोजें';

  @override
  String get faqsCommonQuestions => 'सामान्य प्रश्न';

  @override
  String get faqsStillNeedHelp => 'अभी भी मदद चाहिए?';

  @override
  String get faqsContactSupportMessage =>
      'क्या आप जिस उत्तर की तलाश में हैं वह नहीं मिल रहा है? सहायता के लिए हमारी सहायता टीम से संपर्क करें।';

  @override
  String get faq1_q => 'शिकायत कैसे दर्ज करें?';

  @override
  String get faq1_a =>
      'होम स्क्रीन से \'शिकायत दर्ज करें\' पर जाएं और विवरण भरें।';

  @override
  String get faq2_q => 'मैं अपनी शिकायत को कैसे ट्रैक कर सकता हूं?';

  @override
  String get faq2_a =>
      '\'शिकायत ट्रैक करें\' पर नेविगेट करें और अपनी शिकायत आईडी दर्ज करें।';

  @override
  String get faq3_q => 'क्या मैं दस्तावेज़ अपलोड कर सकता हूं?';

  @override
  String get faq3_a =>
      'हां, आप शिकायत दर्ज करते समय सबूत के तौर पर फोटो या पीडीएफ अपलोड कर सकते हैं।';

  @override
  String get faq4_q => 'समाधान में कितना समय लगता है?';

  @override
  String get faq4_a =>
      'प्राथमिकता के आधार पर, इसमें आमतौर पर 7 कार्य दिवस लगते हैं।';

  @override
  String get faq5_q => 'मैं किस प्रकार की शिकायतें दर्ज कर सकता हूं?';

  @override
  String get faq5_a =>
      'आप स्वच्छता, सड़क, जलापूर्ति, बिजली और अन्य नागरिक मुद्दों से संबंधित मुद्दों की रिपोर्ट कर सकते हैं।';

  @override
  String get faq6_q =>
      'क्या मेरी दर्ज की गई शिकायत को संपादित करने का कोई तरीका है?';

  @override
  String get faq6_a =>
      'आप \'मेरी शिकायतें\' अनुभाग से अपनी शिकायत जमा करने के 24 घंटे के भीतर उसे संपादित कर सकते हैं।';

  @override
  String get faq7_q => 'मुझे अपडेट के बारे में कैसे सूचित किया जाएगा?';

  @override
  String get faq7_a =>
      'आपकी शिकायत पर प्रगति होने पर आपको पुश सूचनाएं और ईमेल अपडेट प्राप्त होंगे।';

  @override
  String get phoneNumber => 'फ़ोन नंबर';

  @override
  String get phoneNumberRequired => 'फ़ोन नंबर आवश्यक है';

  @override
  String get invalidPhoneNumber => 'अमान्य फ़ोन नंबर';

  @override
  String get passwordTooShort => 'पासवर्ड कम से कम 6 अक्षरों का होना चाहिए';

  @override
  String get departmentIdOptional => 'विभाग आईडी (वैकल्पिक)';

  @override
  String get roleCitizen => 'नागरिक';

  @override
  String get roleSupervisor => 'पर्यवेक्षक';

  @override
  String get roleFieldStaff => 'क्षेत्र कर्मचारी';

  @override
  String get roleAdmin => 'प्रशासक';

  @override
  String get noMatchingUsers =>
      'आपकी खोज से मेल खाने वाले कोई उपयोगकर्ता नहीं मिले';

  @override
  String get searchByNameOrEmail => 'नाम या ईमेल से खोजें...';

  @override
  String get welcomeBack =>
      'वापसी पर स्वागत है! कृपया जारी रखने के लिए साइन इन करें';

  @override
  String get createAccountPrompt => 'शुरू करने के लिए एक खाता बनाएं';

  @override
  String get voterId => 'मतदाता पहचान पत्र';

  @override
  String get invalidMobileNumber => 'एक वैध मोबाइल नंबर दर्ज करें';

  @override
  String get citizenName => 'नागरिक का नाम';

  @override
  String get citizenId => 'नागरिक आईडी';

  @override
  String get submittedFeedback => 'जमा किया गया फीडबैक';

  @override
  String get rating => 'रेटिंग';

  @override
  String get feedbackComments => 'फीडबैक टिप्पणियाँ';
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\l10n\app_localizations_mr.dart ---
// ignore: unused_import
import 'package:intl/intl.dart' as intl;
import 'app_localizations.dart';

// ignore_for_file: type=lint

/// The translations for Marathi (`mr`).
class AppLocalizationsMr extends AppLocalizations {
  AppLocalizationsMr([String locale = 'mr']) : super(locale);

  @override
  String get appTitle => 'निवारण';

  @override
  String get login => 'लॉगिन';

  @override
  String get register => 'नोंदणी';

  @override
  String get submitGrievance => 'तक्रार सबमिट करा';

  @override
  String get authenticationFailed => 'प्रमाणीकरण अयशस्वी';

  @override
  String get error => 'त्रुटी आली';

  @override
  String get name => 'नाव';

  @override
  String get email => 'ईमेल';

  @override
  String get password => 'पासवर्ड';

  @override
  String get registerPrompt => 'खाते नाही? नोंदणी करा';

  @override
  String get loginPrompt => 'आधीपासून खाते आहे? लॉगिन करा';

  @override
  String get googleLogin => 'गूगलसह लॉगिन';

  @override
  String get googleLoginFailed => 'गूगल लॉगिन अयशस्वी';

  @override
  String get settings => 'सेटिंग्ज';

  @override
  String get darkMode => 'डार्क मोड';

  @override
  String get language => 'भाषा';

  @override
  String get comments => 'टिप्पण्या';

  @override
  String get noComments => 'अजून टिप्पण्या नाहीत';

  @override
  String get noCommentsMessage => 'पहिली टिप्पणी करण्याची संधी घ्या!';

  @override
  String get addComment => 'टिप्पणी जोडा';

  @override
  String get yourComment => 'आपली टिप्पणी';

  @override
  String get commentCannotBeEmpty => 'टिप्पणी रिकामी असू शकत नाही';

  @override
  String get cancel => 'रद्द करा';

  @override
  String get submit => 'सबमिट करा';

  @override
  String get commentAddedSuccess => 'टिप्पणी यशस्वीरीत्या जोडली गेली';

  @override
  String get failedToAddComment => 'टिप्पणी जोडण्यात अयशस्वी';

  @override
  String get grievanceDetails => 'तक्रार तपशील';

  @override
  String get status => 'स्थिती';

  @override
  String get submitFeedback => 'प्रतिसाद सबमिट करा';

  @override
  String get selectRating => 'रेटिंग निवडा';

  @override
  String get feedback => 'प्रतिसाद';

  @override
  String get pleaseProvideRating => 'कृपया रेटिंग द्या';

  @override
  String get feedbackSubmitted => 'आपला प्रतिसाद सबमिट केला गेला आहे';

  @override
  String get failedToLoadGrievance => 'तक्रार लोड करण्यात अयशस्वी';

  @override
  String get userHistory => 'वापरकर्ता इतिहास';

  @override
  String get userNotFound => 'वापरकर्ता सापडला नाही';

  @override
  String get noGrievancesFound => 'कोणतीही तक्रार आढळली नाही';

  @override
  String get noGrievances => 'कोणतीही तक्रार नाही';

  @override
  String get noGrievancesMessage =>
      'प्रदर्शित करण्यासाठी कोणत्याही तक्रारी नाहीत.';

  @override
  String get retry => 'पुन्हा प्रयत्न करा';

  @override
  String get filterByStatus => 'स्थितीनुसार फिल्टर करा';

  @override
  String get filterByPriority => 'प्राधान्यानुसार फिल्टर करा';

  @override
  String get filterByArea => 'क्षेत्रानुसार फिल्टर करा';

  @override
  String get filterBySubject => 'विषयानुसार फिल्टर करा';

  @override
  String get reassign => 'पुन्हा नेमून द्या';

  @override
  String get escalate => 'एस्केलेट करा';

  @override
  String get updateStatus => 'स्थिती अद्यतनित करा';

  @override
  String get viewDetails => 'तपशील पहा';

  @override
  String get reassignGrievance => 'तक्रार पुन्हा नेमून द्या';

  @override
  String get selectAssignee => 'नेमणूकधारक निवडा';

  @override
  String get selectStatus => 'स्थिती निवडा';

  @override
  String get update => 'अद्यतनित करा';

  @override
  String get noComplaints => 'तक्रारी नाहीत';

  @override
  String get noComplaintsMessage => 'दाखवण्यासाठी कोणत्याही तक्रारी नाहीत.';

  @override
  String get tryAgain => 'पुन्हा प्रयत्न करा';

  @override
  String get reassignComplaint => 'तक्रार नियुक्त करा';

  @override
  String get escalateComplaint => 'तक्रार वाढवा';

  @override
  String get userIdRequired => 'वापरकर्ता आयडी आवश्यक आहे';

  @override
  String get noConfigs => 'कॉन्फिगरेशन नाहीत';

  @override
  String get noConfigsMessage =>
      'प्रदर्शित करण्यासाठी कोणतेही कॉन्फिगरेशन नाहीत. खाली एक जोडा.';

  @override
  String get addConfig => 'कॉन्फिगरेशन जोडा';

  @override
  String get editConfig => 'कॉन्फिगरेशन संपादित करा';

  @override
  String get configKey => 'कॉन्फिगरेशन की';

  @override
  String get configValue => 'कॉन्फिगरेशन व्हॅल्यू';

  @override
  String get configCannotBeEmpty => 'की आणि व्हॅल्यू रिक्त असू शकत नाहीत';

  @override
  String get configValueCannotBeEmpty => 'व्हॅल्यू रिक्त असू शकत नाही';

  @override
  String get configAddedSuccess => 'कॉन्फिगरेशन यशस्वीरित्या जोडले';

  @override
  String get configUpdatedSuccess => 'कॉन्फिगरेशन यशस्वीरित्या अपडेट केले';

  @override
  String get track_grievances => 'आपल्या तक्रारी ट्रॅक करा';

  @override
  String get no_grievances => 'अजून कोणतीही तक्रार नाही';

  @override
  String get no_grievances_message =>
      'सुरुवात करण्यासाठी आपली पहिली तक्रार नोंदवा';

  @override
  String get submit_grievance => 'तक्रार नोंदवा';

  @override
  String get your_grievances => 'आपल्या तक्रारी';

  @override
  String get please_login => 'कृपया लॉगिन करा';

  @override
  String get addUser => 'वापरकर्ता जोडा';

  @override
  String get role => 'भूमिका';

  @override
  String get add => 'जोडा';

  @override
  String get userAddedSuccess => 'वापरकर्ता यशस्वीरित्या जोडला गेला';

  @override
  String get failedToAddUser => 'वापरकर्ता जोडण्यात अयशस्वी';

  @override
  String get editUser => 'वापरकर्ता संपादित करा';

  @override
  String get deleteUser => 'वापरकर्ता हटवा';

  @override
  String get userUpdatedSuccess => 'वापरकर्ता यशस्वीरित्या अद्यतनित केला गेला';

  @override
  String get failedToUpdateUser => 'वापरकर्ता अद्यतनित करण्यात अयशस्वी';

  @override
  String get deleteUserConfirmation => 'आपण खरोखर हा वापरकर्ता हटवू इच्छिता?';

  @override
  String get userDeletedSuccess => 'वापरकर्ता यशस्वीरित्या हटविला गेला';

  @override
  String get delete => 'हटवा';

  @override
  String get failedToDeleteUser => 'वापरकर्ता हटविण्यात अयशस्वी';

  @override
  String get manageUsers => 'वापरकर्त्यांचे व्यवस्थापन करा';

  @override
  String get noUsers => 'कोणतेही वापरकर्ते नाहीत';

  @override
  String get noUsersMessage => 'दाखविण्यासाठी कोणतेही वापरकर्ते नाहीत.';

  @override
  String get noEmail => 'ईमेल नाही';

  @override
  String get loading => 'लॉगिन प्रक्रिया सुरू आहे...';

  @override
  String get viewgrievanceetails => 'View Grievances';

  @override
  String get assignGrievance => 'तक्रार सोपवा';

  @override
  String get rejectGrievance => 'तक्रार नाकारावी';

  @override
  String get rejectionReason => 'नकाराचे कारण';

  @override
  String get reject => 'नाकारावे';

  @override
  String get assignedGrievances => 'सोपवलेल्या तक्रारी';

  @override
  String get noAssigned => 'कोणत्याही तक्रारी सोपवलेल्या नाहीत';

  @override
  String get noAssignedMessage =>
      'आपल्याला कोणत्याही तक्रारी सोपवलेल्या नाहीत.';

  @override
  String get upload => 'अपलोड करा';

  @override
  String get uploadWorkproof => 'कामाचा पुरावा अपलोड करा';

  @override
  String get guest => 'पाहुणा';

  @override
  String get invalidRole => 'अवैध भूमिका';

  @override
  String get profile => 'प्रोफाइल';

  @override
  String get logout => 'लॉगआउट';

  @override
  String get logoutFailed => 'लॉगआउट अयशस्वी';

  @override
  String get notifications => 'सूचना';

  @override
  String get save => 'जतन करा';

  @override
  String get appVersion => 'अ‍ॅप आवृत्ती';

  @override
  String get about => 'बद्दल';

  @override
  String get contactSupport => 'समर्थनाशी संपर्क करा';

  @override
  String get faqs => 'वारंवार विचारले जाणारे प्रश्न';

  @override
  String get helpSupport => 'मदत व समर्थन';

  @override
  String get viewPrivacyPolicyprivacySecurity =>
      'गोपनीयता धोरण / गोपनीयता आणि सुरक्षा पहा';

  @override
  String get enableNotifications => 'सूचना सक्षम करा';

  @override
  String get account => 'खाते';

  @override
  String get privacySecurity => 'गोपनीयता आणि सुरक्षा';

  @override
  String get viewPrivacyPolicy => 'गोपनीयता धोरण पहा';

  @override
  String get invalidEmail => 'अवैध ईमेल';

  @override
  String get nameRequired => 'नाव आवश्यक आहे';

  @override
  String get emailRequired => 'ईमेल आवश्यक आहे';

  @override
  String get passwordRequired => 'पासवर्ड आवश्यक आहे';

  @override
  String get recentComplaints => 'अलीकडील तक्रारी';

  @override
  String get filterByPeriod => 'कालावधीप्रमाणे फिल्टर करा';

  @override
  String get totalComplaints => 'एकूण तक्रारी';

  @override
  String get day => 'दिवस';

  @override
  String get week => 'आठवडा';

  @override
  String get month => 'महिना';

  @override
  String get year => 'वर्ष';

  @override
  String get allTime => 'संपूर्ण वेळ';

  @override
  String get complaintStatusOverview => 'तक्रार स्थितीचा आढावा';

  @override
  String get grievanceTrend => 'तक्रारींचा कल';

  @override
  String get numberOfGrievances => 'तक्रारींची संख्या';

  @override
  String get timePeriod => 'कालावधी';

  @override
  String get deptWiseDistribution => 'विभागनिहाय वितरण';

  @override
  String get department => 'विभाग';

  @override
  String get slaMetrics => 'SLA मेट्रिक्स';

  @override
  String get slaDays => 'SLA दिवस';

  @override
  String get complianceRate => 'अनुपालन दर';

  @override
  String get avgResolutionTime => 'सरासरी निराकरण वेळ';

  @override
  String get exportPDF => 'PDF निर्यात करा';

  @override
  String get exportCSV => 'CSV निर्यात करा';

  @override
  String get exportExcel => 'Excel निर्यात करा';

  @override
  String get reportExported => 'रिपोर्ट निर्यात झाला';

  @override
  String get errorExportingReport => 'रिपोर्ट निर्यात करताना त्रुटी';

  @override
  String get viewAuditLogs => 'ऑडिट लॉग पाहा';

  @override
  String get complaintManagement => 'तक्रार व्यवस्थापन';

  @override
  String get manageConfigs => 'कॉन्फिगरेशन व्यवस्थापित करा';

  @override
  String get manageSubjects => 'विषय व्यवस्थापन';

  @override
  String get manageAreas => 'क्षेत्र व्यवस्थापित करा';

  @override
  String get reports => 'अहवाल';

  @override
  String get assignedList => 'निर्धारित तक्रारी';

  @override
  String get announcements => 'जाहिराती';

  @override
  String get privacyPolicy => 'गोपनीयता धोरण';

  @override
  String get clearFilters => 'फिल्टर साफ करा';

  @override
  String get addAnnouncement => 'Add Announcement';

  @override
  String get noAnnouncements => 'No announcements available';

  @override
  String get title => 'Title';

  @override
  String get message => 'Message';

  @override
  String get type => 'Type';

  @override
  String get targetRole => 'Target Role';

  @override
  String get selectExpiration => 'Select Expiration';

  @override
  String get announcementAdded => 'Announcement added successfully';

  @override
  String get takeAction => 'कारवाई करा';

  @override
  String get refresh => 'रिफ्रेश करा';

  @override
  String get exportReports => 'अहवाल निर्यात करा';

  @override
  String get filters => 'फिल्टर्स';

  @override
  String get apply => 'लागू करा';

  @override
  String get locationPermissionDenied => 'स्थान परवानगी नाकारली';

  @override
  String get pleaseFillAllFields => 'कृपया सर्व फील्ड भरा';

  @override
  String get grievanceSubmitted => 'तक्रार सबमिट केली';

  @override
  String get titleRequired => 'शीर्षक आवश्यक आहे';

  @override
  String get description => 'वर्णन';

  @override
  String get descriptionRequired => 'वर्णन आवश्यक आहे';

  @override
  String get categorization => 'वर्गीकरण';

  @override
  String get subjectRequired => 'विषय आवश्यक आहे';

  @override
  String get areaRequired => 'क्षेत्र आवश्यक आहे';

  @override
  String get locationDetails => 'स्थानाची माहिती';

  @override
  String get searchByName => 'नावाने शोधा';

  @override
  String get noResultsFound => 'कोणतेही निकाल सापडले नाहीत';

  @override
  String get noMatchingGrievances =>
      'कोणत्याही जुळणाऱ्या तक्रारी सापडल्या नाहीत';

  @override
  String get allUsersHistory => 'सर्व वापरकर्त्यांचा इतिहास';

  @override
  String get edit => 'संपादित करा';

  @override
  String get areYouSureDeleteGrievance => 'आपण नक्कीच तक्रार हटवू इच्छिता?';

  @override
  String get confirmDelete => 'हटवण्याची पुष्टी करा';

  @override
  String get failedToDeleteGrievance => 'तक्रार हटवण्यात अयशस्वी';

  @override
  String get grievanceDeletedSuccessfully => 'तक्रार यशस्वीपणे हटवली गेली';

  @override
  String get editGrievance => 'तक्रार संपादित करा';

  @override
  String get statusNew => 'नवीन';

  @override
  String get statusInProgress => 'प्रगतीपथावर';

  @override
  String get statusResolved => 'निकाली';

  @override
  String get statusRejected => 'नाकारले';

  @override
  String get statusOnHold => 'होल्डवर';

  @override
  String get statusClosed => 'बंद';

  @override
  String get statusUnknown => 'अज्ञात';

  @override
  String get submitGrievanceSubtitle => 'काही टॅपमध्ये समस्या नोंदवा';

  @override
  String get trackGrievancesSubtitle => 'तुमच्या तक्रारींवर रिअल-टाइम अपडेट्स';

  @override
  String get quickResolutionsTitle => 'जलद निराकरण';

  @override
  String get quickResolutionsSubtitle => 'तुमच्या समस्यांचे जलद निराकरण करा';

  @override
  String get track => 'ट्रॅक';

  @override
  String get stageReviewedBySupervisor => 'पर्यवेक्षकाद्वारे पुनरावलोकन केले';

  @override
  String get stageAssignedToFieldStaff => 'क्षेत्र कर्मचाऱ्याला नियुक्त केले';

  @override
  String get stageResolved => 'निकाली';

  @override
  String get submittedOn => 'सादर केले';

  @override
  String get userLabel => 'वापरकर्ता';

  @override
  String get grievanceProgressTitle => 'तक्रार प्रगती';

  @override
  String get stageSubmitted => 'सादर केले';

  @override
  String get assignedToLabel => 'यांना नियुक्त केले';

  @override
  String get fieldStaffLabel => 'क्षेत्र कर्मचारी';

  @override
  String get resolvedOn => 'निकाली केले';

  @override
  String timeAgoDays(num days) {
    String _temp0 = intl.Intl.pluralLogic(
      days,
      locale: localeName,
      other: '$days दिवसांपूर्वी',
      one: '1 दिवसापूर्वी',
    );
    return '$_temp0';
  }

  @override
  String timeAgoHours(num hours) {
    String _temp0 = intl.Intl.pluralLogic(
      hours,
      locale: localeName,
      other: '$hours तासांपूर्वी',
      one: '1 तासापूर्वी',
    );
    return '$_temp0';
  }

  @override
  String timeAgoMinutes(num minutes) {
    String _temp0 = intl.Intl.pluralLogic(
      minutes,
      locale: localeName,
      other: '$minutes मिनिटांपूर्वी',
      one: '1 मिनिटापूर्वी',
    );
    return '$_temp0';
  }

  @override
  String get timeAgoJustNow => 'आत्ताच';

  @override
  String get notApplicable => 'लागू नाही';

  @override
  String couldNotLaunchUrl(Object url) {
    return '$url उघडू शकलो नाही';
  }

  @override
  String get details => 'तपशील';

  @override
  String get created => 'तयार केले';

  @override
  String get lastUpdated => 'शेवटचे अद्यतनित';

  @override
  String get attachments => 'जोडण्या';

  @override
  String get address => 'पत्ता';

  @override
  String get unknownRole => 'अज्ञात भूमिका';

  @override
  String get profilePictureUpdateMessage =>
      'प्रोफाइल चित्र निवडले. अपलोड करण्यासाठी जतन करा.';

  @override
  String get lastLogin => 'शेवटचे लॉगिन';

  @override
  String get accountStatus => 'खात्याची स्थिती';

  @override
  String get statusActive => 'सक्रिय';

  @override
  String get statusInactive => 'निष्क्रिय';

  @override
  String get editProfile => 'प्रोफाइल संपादित करा';

  @override
  String get loadingData => 'लोड होत आहे...';

  @override
  String get appNameFallback => 'पीसीएमसी ॲप';

  @override
  String get packageNameFallback => 'com.example.pcmcapp';

  @override
  String get currentVersion => 'सध्याची आवृत्ती';

  @override
  String get minimumOS => 'किमान ओएस';

  @override
  String get checkForUpdates => 'अपडेटसाठी तपासा';

  @override
  String get versionInformation => 'आवृत्ती माहिती';

  @override
  String get upToDate => 'अद्ययावत';

  @override
  String get releaseType => 'रिलीज प्रकार';

  @override
  String get size => 'आकार';

  @override
  String get thankYouMessage => 'आमचे ॲप वापरल्याबद्दल धन्यवाद!';

  @override
  String get needHelp => 'मदत हवी आहे?';

  @override
  String get supportTeamMessage =>
      'आमची समर्थन टीम आपल्याला कोणत्याही प्रश्नांसाठी किंवा समस्यांसाठी मदत करण्यास येथे आहे';

  @override
  String get contactOptions => 'संपर्क पर्याय';

  @override
  String get emailSupport => 'ईमेल समर्थन';

  @override
  String get emailSupportResponseTime => '२४ तासांच्या आत प्रतिसाद मिळवा';

  @override
  String get callSupport => 'कॉल समर्थन';

  @override
  String get callSupportAvailability =>
      'सकाळी ९ ते संध्याकाळी ६ (सोम-शनि) उपलब्ध';

  @override
  String get faqsHelpCenter => 'वारंवार विचारले जाणारे प्रश्न आणि मदत केंद्र';

  @override
  String get faqsHelpCenterSubtitle => 'सामान्य प्रश्नांची उत्तरे शोधा';

  @override
  String get weAreHereToHelp => 'आम्ही आपल्याला मदत करण्यासाठी येथे आहोत!';

  @override
  String get couldNotLaunchPhone => 'फोन लावू शकलो नाही';

  @override
  String get privacyPolicyCommitmentTitle => 'आमची वचनबद्धता';

  @override
  String get privacyPolicyCommitmentBody =>
      'आम्ही तुमच्या गोपनीयतेचा आदर करतो आणि तुमच्या वैयक्तिक डेटाचे संरक्षण करण्यास वचनबद्ध आहोत. हे धोरण आम्ही तुमची माहिती सुरक्षितपणे कशी हाताळतो हे स्पष्ट करते.';

  @override
  String get privacyPolicyDataCollectionTitle => '१. डेटा संकलन';

  @override
  String get privacyPolicyDataCollectionBody =>
      'आम्ही तक्रारींवर प्रक्रिया करण्यासाठी फक्त तुमचे नाव, ईमेल आणि तक्रारीचे तपशील गोळा करतो.';

  @override
  String get privacyPolicyDataUsageTitle => '२. डेटा वापर';

  @override
  String get privacyPolicyDataUsageBody =>
      'तुमचा डेटा केवळ तक्रार निवारण आणि प्रणाली सुधारण्यासाठी वापरला जातो.';

  @override
  String get privacyPolicySecurityTitle => '३. सुरक्षा';

  @override
  String get privacyPolicySecurityBody =>
      'तुमची माहिती सुरक्षित ठेवण्यासाठी आम्ही एन्क्रिप्शन आणि कठोर प्रवेश धोरणे लागू करतो.';

  @override
  String get faqsHeaderSubtitle =>
      'आमचे ॲप वापरण्याबद्दल सामान्य प्रश्नांची उत्तरे शोधा';

  @override
  String get faqsCommonQuestions => 'सामान्य प्रश्न';

  @override
  String get faqsStillNeedHelp => 'अजूनही मदतीची गरज आहे?';

  @override
  String get faqsContactSupportMessage =>
      'तुम्ही शोधत असलेले उत्तर सापडत नाहीये? मदतीसाठी आमच्या समर्थन टीमशी संपर्क साधा.';

  @override
  String get faq1_q => 'तक्रार कशी नोंदवायची?';

  @override
  String get faq1_a => 'होम स्क्रीनवरून \'तक्रार नोंदवा\' वर जा आणि तपशील भरा.';

  @override
  String get faq2_q => 'मी माझ्या तक्रारीचा मागोवा कसा घेऊ शकेन?';

  @override
  String get faq2_a =>
      '\'तक्रार मागोवा\' वर नेव्हिगेट करा आणि तुमचा तक्रार आयडी प्रविष्ट करा.';

  @override
  String get faq3_q => 'मी कागदपत्रे अपलोड करू शकेन का?';

  @override
  String get faq3_a =>
      'होय, तक्रार नोंदवताना तुम्ही पुरावा म्हणून फोटो किंवा पीडीएफ अपलोड करू शकता.';

  @override
  String get faq4_q => 'निराकरण होण्यासाठी किती वेळ लागतो?';

  @override
  String get faq4_a => 'प्राधान्यानुसार, साधारणपणे ७ कामकाजाचे दिवस लागतात.';

  @override
  String get faq5_q => 'मी कोणत्या प्रकारच्या तक्रारी नोंदवू शकेन?';

  @override
  String get faq5_a =>
      'तुम्ही स्वच्छता, रस्ते, पाणीपुरवठा, वीज आणि इतर नागरी समस्यांशी संबंधित तक्रारी नोंदवू शकता.';

  @override
  String get faq6_q =>
      'मी नोंदवलेली तक्रार संपादित करण्याचा काही मार्ग आहे का?';

  @override
  String get faq6_a =>
      'तुम्ही \'माझ्या तक्रारी\' विभागातून तक्रार नोंदवल्याच्या २४ तासांच्या आत तुमची तक्रार संपादित करू शकता.';

  @override
  String get faq7_q => 'मला अपडेट्सबद्दल कसे सूचित केले जाईल?';

  @override
  String get faq7_a =>
      'तुमच्या तक्रारीवर प्रगती झाल्यावर तुम्हाला पुश सूचना आणि ईमेल अपडेट्स मिळतील.';

  @override
  String get phoneNumber => 'फोन नंबर';

  @override
  String get phoneNumberRequired => 'फोन नंबर आवश्यक आहे';

  @override
  String get invalidPhoneNumber => 'अवैध फोन नंबर';

  @override
  String get passwordTooShort => 'पासवर्ड किमान ६ अक्षरांचा असावा';

  @override
  String get departmentIdOptional => 'विभाग आयडी (पर्यायी)';

  @override
  String get roleCitizen => 'नागरिक';

  @override
  String get roleSupervisor => 'पर्यवेक्षक';

  @override
  String get roleFieldStaff => 'क्षेत्र कर्मचारी';

  @override
  String get roleAdmin => 'प्रशासक';

  @override
  String get noMatchingUsers =>
      'तुमच्या शोधाशी जुळणारे कोणतेही वापरकर्ते आढळले नाहीत';

  @override
  String get searchByNameOrEmail => 'नाव किंवा ईमेलद्वारे शोधा...';

  @override
  String get welcomeBack => 'परत स्वागत आहे! कृपया पुढे जाण्यासाठी साइन इन करा';

  @override
  String get createAccountPrompt => 'सुरुवात करण्यासाठी एक खाते तयार करा';

  @override
  String get voterId => 'मतदार ओळखपत्र';

  @override
  String get invalidMobileNumber => 'एक वैध मोबाइल नंबर प्रविष्ट करा';

  @override
  String get citizenName => 'नागरिकाचे नाव';

  @override
  String get citizenId => 'नागरिक आयडी';

  @override
  String get submittedFeedback => 'सादर केलेला अभिप्राय';

  @override
  String get rating => 'रेटिंग';

  @override
  String get feedbackComments => 'अभिप्राय टिप्पण्या';
}


=== Folder: models ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\models\announcement_model.dart ---
// D:\Company_Data\PCMCApp\main_ui\lib\models\announcement_model.dart
class Announcement {
  final int id;
  final String title;
  final String message;
  final String type;
  final DateTime createdAt;
  final DateTime? expiresAt;
  final String? targetRole;
  final bool isActive;

  Announcement({
    required this.id,
    required this.title,
    required this.message,
    required this.type,
    required this.createdAt,
    this.expiresAt,
    this.targetRole,
    required this.isActive,
  });

  factory Announcement.fromJson(Map<String, dynamic> json) {
    return Announcement(
      id: json['id'] as int,
      title: json['title'] as String,
      message: json['message'] as String,
      type: json['type'] as String,
      createdAt: DateTime.parse(json['created_at'] as String),
      expiresAt: json['expires_at'] != null ? DateTime.parse(json['expires_at'] as String) : null,
      targetRole: json['target_role'] as String?,
      isActive: json['is_active'] as bool,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'title': title,
      'message': message,
      'type': type,
      'created_at': createdAt.toIso8601String(),
      'expires_at': expiresAt?.toIso8601String(),
      'target_role': targetRole,
      'is_active': isActive,
    };
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\models\comment_model.dart ---
// lib/models/comment_model.dart
class CommentAttachment {
  final int id;
  final String filePath;
  final String fileType;

  CommentAttachment({
    required this.id,
    required this.filePath,
    required this.fileType,
  });

  factory CommentAttachment.fromJson(Map<String, dynamic> json) {
    return CommentAttachment(
      id: json['id'] as int,
      filePath: json['file_path'] as String,
      fileType: json['file_type'] as String,
    );
  }
}
class Comment {
  final int id;
  final int grievanceId;
  final int userId;
  final String? userName;
  final String? commentText;
  final DateTime createdAt;
  final List<CommentAttachment>? attachments;

  Comment({
    required this.id,
    required this.grievanceId,
    required this.userId,
    this.userName,
    this.commentText,
    required this.createdAt,
    this.attachments,
  });

  factory Comment.fromJson(Map<String, dynamic> json) {
    return Comment(
      id: json['id'] as int,
      grievanceId: json['grievance_id'] ,
      userId: json['user_id'],
      userName: json['user']?['name'] as String?,
      commentText: json['comment_text'] ?? '',
      createdAt: DateTime.parse(json['created_at']),
      attachments: json['attachments'] != null
          ? (json['attachments'] as List).map((item) => CommentAttachment.fromJson(item)).toList()
          : null,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'grievance_id': grievanceId,
      'user_id': userId,
      'comment_text': commentText,
      'created_at': createdAt.toIso8601String(),
    };
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\models\grievance_model.dart ---
import 'package:main_ui/models/comment_model.dart';
import 'package:main_ui/models/user_model.dart';
import 'package:main_ui/models/master_data_model.dart';
import 'package:main_ui/models/workproof_model.dart';
class Assignee {
  final String? name;

  Assignee({this.name});

  factory Assignee.fromJson(Map<String, dynamic> json) {
    return Assignee(
      name: json['name'] as String?,
    );
  }
}

class Grievance {
  final int id;
  final String complaintId;
  final int? citizenId;
  final int? subjectId;
  final int? areaId;
  final String title;
  final String description;
  final String? wardNumber;
  final String? status;
  final String? priority;
  final int? assignedTo;
  final int? assignedBy;
  final String? rejectionReason;
  final DateTime? resolvedAt;
  final DateTime createdAt;
  final DateTime updatedAt;
  final double? latitude;
  final double? longitude;
  final String? address;
  final int escalationLevel;
  final int? feedbackRating;
  final String? feedbackText;
  final User? citizen;
  final User? assignee;
  final MasterSubject? subject;
  final MasterArea? area;
  final List<GrievanceAttachment>? attachments; // From old version
  final List<Comment>? comments; // From old version
  final List<Workproof>? workproofs;

  Grievance({
    required this.id,
    required this.complaintId,
    this.citizenId,
    this.subjectId,
    this.areaId,
    required this.title,
    required this.description,
    this.wardNumber,
    this.status,
    this.priority,
    this.assignedTo,
    this.assignedBy,
    this.rejectionReason,
    this.resolvedAt,
    required this.createdAt,
    required this.updatedAt,
    this.latitude,
    this.longitude,
    this.address,
    required this.escalationLevel,
    this.feedbackRating,
    this.feedbackText,
    this.citizen,
    this.assignee,
    this.subject,
    this.area,
    this.attachments,
    this.comments,
    this.workproofs,
  });

  factory Grievance.fromJson(Map<String, dynamic> json) {
  
  return Grievance(
    id: json['id'] as int,
    complaintId: json['complaint_id'] as String,
    citizenId: json['citizen'] != null ? json['citizen']['id'] as int? : null,
    subjectId: json['subject'] != null ? json['subject']['id'] as int? : null,
    areaId: json['area'] != null ? json['area']['id'] as int? : null,
    title: json['title'] as String? ?? 'Untitled', // Provide default if null
    description: json['description'] as String? ?? '', // Provide default if null
    wardNumber: json['ward_number'] as String?,
    status: json['status'] as String?,
    priority: json['priority'] as String?,
    assignedTo: json['assignee'] != null ? json['assignee']['id'] as int? : null,
    assignedBy: json['assigner'] != null ? json['assigner']['id'] as int? : null,
    rejectionReason: json['rejection_reason'] as String?,
    resolvedAt: json['resolved_at'] != null
        ? DateTime.parse(json['resolved_at'] as String)
        : null,
    createdAt: DateTime.parse(json['created_at'] as String),
    updatedAt: DateTime.parse(json['updated_at'] as String),
    latitude: json['latitude'] is double ? json['latitude'] : null,
    longitude: json['longitude'] is double ? json['longitude'] : null,
    address: json['address'] as String?,
    escalationLevel: json['escalation_level'] as int? ?? 0,
    feedbackRating: json['feedback_rating'] as int?,
    feedbackText: json['feedback_text'] as String?,
    citizen: json['citizen'] != null
        ? User.fromJson(json['citizen'] as Map<String, dynamic>)
        : null,
    assignee: json['assignee'] != null
        ? User.fromJson(json['assignee'] as Map<String, dynamic>)
        : null,
    subject: json['subject'] != null
        ? MasterSubject.fromJson(json['subject'] as Map<String, dynamic>)
        : null,
    area: json['area'] != null
        ? MasterArea.fromJson(json['area'] as Map<String, dynamic>)
        : null,
    attachments: json['attachments'] != null
        ? (json['attachments'] as List).map((a) => GrievanceAttachment.fromJson(a)).toList()
        : null,
    comments: json['comments'] != null
        ? (json['comments'] as List).map((c) => Comment.fromJson(c)).toList()
        : null,
      workproofs: json['workproofs'] != null
        ? (json['workproofs'] as List).map((wp) => Workproof.fromJson(wp)).toList()
        : null,
  );
}

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'complaint_id': complaintId,
      'citizen_id': citizenId,
      'subject_id': subjectId,
      'area_id': areaId,
      'title': title,
      'description': description,
      'ward_number': wardNumber,
      'status': status,
      'priority': priority,
      'assigned_to': assignedTo,
      'assigned_by': assignedBy,
      'rejection_reason': rejectionReason,
      'resolved_at': resolvedAt?.toIso8601String(),
      'created_at': createdAt.toIso8601String(),
      'updated_at': updatedAt.toIso8601String(),
      'latitude': latitude,
      'longitude': longitude,
      'address': address,
      'escalation_level': escalationLevel,
      'feedback_rating': feedbackRating,
      'feedback_text': feedbackText,
      'citizen': citizen?.toJson(),
      'assignee': assignee?.toJson(),
      'subject': subject?.toJson(),
      'area': area?.toJson(),
      'attachments': attachments?.map((a) => a.toJson()).toList(),
      'comments': comments?.map((c) => c.toJson()).toList(),
      'workproofs': workproofs?.map((wp) => wp.toJson()).toList(),
    };
  }
}

class GrievanceAttachment {
  final int id;
  final int grievanceId;
  final String filePath;
  final String fileType;
  final DateTime uploadedAt;

  GrievanceAttachment({
    required this.id,
    required this.grievanceId,
    required this.filePath,
    required this.fileType,
    required this.uploadedAt,
  });

  factory GrievanceAttachment.fromJson(Map<String, dynamic> json) {
    return GrievanceAttachment(
      id: json['id'] ?? 0,
      grievanceId: json['grievance_id'] ?? 0,
      filePath: json['file_path'] ?? '',
      fileType: json['file_type'] ?? '',
      uploadedAt: DateTime.parse(json['uploaded_at'] ?? DateTime.now().toIso8601String()),
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'grievance_id': grievanceId,
      'file_path': filePath,
      'file_type': fileType,
      'uploaded_at': uploadedAt.toIso8601String(),
    };
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\models\kpi_model.dart ---
class KpiData {
  final Map<String, int> totalComplaints;
  final Map<String, int> statusOverview;
  final Map<String, int> deptWise;
  final Map<String, dynamic> slaMetrics;
  final Map<String, int> staffPerformance;

  KpiData({
    required this.totalComplaints,
    required this.statusOverview,
    required this.deptWise,
    required this.slaMetrics,
    required this.staffPerformance,
  });

  factory KpiData.fromJson(Map<String, dynamic> json) {
    return KpiData(
      totalComplaints: Map<String, int>.from(json['total_complaints'] ?? {}),
      statusOverview: Map<String, int>.from(json['status_overview'] ?? {}),
      deptWise: Map<String, int>.from(json['dept_wise'] ?? {}),
      slaMetrics: Map<String, dynamic>.from(json['sla_metrics'] ?? {}),
      staffPerformance: Map<String, int>.from(json['staff_performance'] ?? {}),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\models\master_data_model.dart ---
class MasterSubject {
  final int id;
  final String name;
  final String? description;

  MasterSubject({
    required this.id,
    required this.name,
    this.description,
  });

  factory MasterSubject.fromJson(Map<String, dynamic> json) {
    return MasterSubject(
      id: json['id'] is String ? int.parse(json['id']) : json['id'] as int,
      name: json['name'] as String,
      description: json['description'] as String?,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'name': name,
      'description': description,
    };
  }
}

class MasterArea {
  final int id;
  final String name;
  final String? description;

  MasterArea({
    required this.id,
    required this.name,
    this.description,
  });

  factory MasterArea.fromJson(Map<String, dynamic> json) {
    return MasterArea(
      id: json['id'] is String ? int.parse(json['id']) : json['id'] as int,
      name: json['name'] as String,
      description: json['description'] as String?,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'name': name,
      'description': description,
    };
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\models\report_model.dart ---
class ReportData {
  final Map<String, int> totalComplaints;
  final Map<String, int> statusOverview;
  final Map<String, int> deptWise;
  final Map<String, dynamic> slaMetrics;
  final Map<String, int> staffPerformance;
  final double resolutionRate;
  final Map<String, dynamic> pendingAging;
  final double slaCompliance;

  ReportData({
    required this.totalComplaints,
    required this.statusOverview,
    required this.deptWise,
    required this.slaMetrics,
    required this.staffPerformance,
    required this.resolutionRate,
    required this.pendingAging,
    required this.slaCompliance,
  });

  factory ReportData.fromJson(Map<String, dynamic> json) {
    return ReportData(
      totalComplaints: Map<String, int>.from(json['total_complaints'] ?? {}),
      statusOverview: Map<String, int>.from(json['status_overview'] ?? {}),
      deptWise: Map<String, int>.from(json['dept_wise'] ?? {}),
      slaMetrics: Map<String, dynamic>.from(json['sla_metrics'] ?? {}),
      staffPerformance: Map<String, int>.from(json['staff_performance'] ?? {}),
      resolutionRate: json['resolution_rate']?.toDouble() ?? 0.0,
      pendingAging: Map<String, dynamic>.from(json['pending_aging'] ?? {}),
      slaCompliance: json['sla_compliance']?.toDouble() ?? 0.0,
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\models\user_model.dart ---
class User {
  final int id;
  final String? name;
  final String? email;
  final String? phoneNumber;
  final String? role;
  final int? departmentId;
  final String? address;
  final String? profilePicture;
  final DateTime? createdAt;
  final DateTime? updatedAt;
  final DateTime? lastLogin;
  final bool twoFactorEnabled;
  final bool isActive;

  User({
    required this.id,
    this.name,
    this.email,
    this.phoneNumber,
    this.role,
    this.departmentId,
    this.address,
    this.profilePicture,
    this.createdAt,
    this.updatedAt,
    this.lastLogin,
    this.twoFactorEnabled = false,
    this.isActive = true,
  });

  factory User.fromJson(Map<String, dynamic> json) {
    return User(
      id: json['id'],
      name: json['name'] ?? 'Unknown User',
      email: json['email'],
      phoneNumber: json['phone_number'],
      role: json['role'] ?? 'Unknown',
      departmentId: json['department_id'],
      address: json['address'],
      profilePicture: json['profile_picture'],
      createdAt: json['created_at'] != null ? DateTime.parse(json['created_at']) : null,
      updatedAt: json['updated_at'] != null ? DateTime.parse(json['updated_at']) : null,
      lastLogin: json['last_login'] != null ? DateTime.parse(json['last_login']) : null,
      twoFactorEnabled: json['two_factor_enabled'] ?? false,
      isActive: json['is_active'] ?? true,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'name': name,
      'email': email,
      'phone_number': phoneNumber,
      'role': role,
      'department_id': departmentId,
      'address': address,
      'profile_picture': profilePicture,
      'created_at': createdAt?.toIso8601String(),
      'updated_at': updatedAt?.toIso8601String(),
      'last_login': lastLogin?.toIso8601String(),
      'two_factor_enabled': twoFactorEnabled,
      'is_active': isActive,
    };
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\models\workproof_model.dart ---
// lib/models/workproof_model.dart
import 'package:main_ui/models/user_model.dart';

class Workproof {
  final int id;
  final int grievanceId;
  final int uploadedBy;
  final String filePath;
  final String? notes;
  final DateTime uploadedAt;
  final User? uploader;

  Workproof({
    required this.id,
    required this.grievanceId,
    required this.uploadedBy,
    required this.filePath,
    this.notes,
    required this.uploadedAt,
    this.uploader,
  });

  factory Workproof.fromJson(Map<String, dynamic> json) {
    return Workproof(
      id: json['id'],
      grievanceId: json['grievance_id'],
      uploadedBy: json['uploaded_by'],
      filePath: json['file_path'],
      notes: json['notes'],
      uploadedAt: DateTime.parse(json['uploaded_at']),
      uploader: json['uploader'] != null ? User.fromJson(json['uploader']) : null,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'notes': notes,
      // Add other fields if needed for sending data to the server
    };
  }
}

=== Folder: providers ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\providers\admin_provider.dart ---
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:dio/dio.dart';
import '../models/grievance_model.dart';
import '../models/kpi_model.dart';
import '../services/api_service.dart';

// Define the apiServiceProvider for dependency injection
final apiServiceProvider = Provider<ApiService>((ref) => ApiService());

// Define a Config model
class Config {
  final String key;
  final String value;

  Config({required this.key, required this.value});

  factory Config.fromJson(Map<String, dynamic> json) {
    return Config(
      key: json['key'] ?? '',
      value: json['value'] ?? '',
    );
  }
}

class AdminState {
  final KpiData? kpiData;
  final List<Grievance> grievances;
  final List<Config> configs; // Added for config management
  final String? error;

  AdminState({
    this.kpiData,
    this.grievances = const [],
    this.configs = const [], // Initialize empty configs list
    this.error,
  });

  AdminState copyWith({
    KpiData? kpiData,
    List<Grievance>? grievances,
    List<Config>? configs,
    String? error,
  }) {
    return AdminState(
      kpiData: kpiData ?? this.kpiData,
      grievances: grievances ?? this.grievances,
      configs: configs ?? this.configs,
      error: error ?? this.error,
    );
  }
}

class AdminNotifier extends StateNotifier<AdminState> {
  // ignore: unused_field
  final ApiService _apiService;

  AdminNotifier(this._apiService) : super(AdminState()) {
    getConfigs(); // Fetch configs on initialization
  }

  Future<void> fetchAdvancedKPIs({String timePeriod = 'all'}) async {
    try {
      final response = await ApiService.get('/admins/reports/kpis/advanced?time_period=$timePeriod');
      final kpiData = KpiData.fromJson(response.data);
      state = state.copyWith(kpiData: kpiData, error: null);
     
    } catch (e) {
      state = state.copyWith(error: e.toString());
    }
  }

  Future<List<Grievance>> getAllGrievances({
    String? status ,
    String? priority,
    int? areaId,
    int? subjectId,}) async {
    try {
      final response = await ApiService.get('/admins/grievances/all' );
      final grievances =
          (response.data as List).map((g) => Grievance.fromJson(g)).toList();
      state = state.copyWith(grievances: grievances, error: null);
      

      return grievances;
    } catch (e) {
      state = state.copyWith(grievances: [], error: e.toString());
      return [];
    }
  }

  Future<void> escalateGrievance(int grievanceId, int newAssigneeId, int userId ) async {
  try {
    
    await ApiService.post(
      '/admins/grievances/$grievanceId/escalate', 
      {'escalated_by': userId,
      'assignee_id': newAssigneeId},
    );
    state = state.copyWith(error: null);
    await getAllGrievances();
  } catch (e) {
    state = state.copyWith(error: e.toString());
    
  }
}

  Future<void> reassignGrievance(int grievanceId, int assigneeId) async {
    try {
      await ApiService
          .post('/admins/reassign/$grievanceId', {'assigned_to': assigneeId});
      state = state.copyWith(error: null);
      
       
      await getAllGrievances();
    } catch (e) {
      state = state.copyWith(error: e.toString());
      
      
    }
  }

  Future<void> updateGrievanceStatus(int grievanceId, String status) async {
    try {
      
      await ApiService.post('/grievances/$grievanceId/status', {'status': status});
      state = state.copyWith(error: null);
      
      await getAllGrievances();
    } catch (e) {
      state = state.copyWith(error: e.toString());
     
    }
  }

  Future<List<Grievance>> getCitizenHistory(int userId) async {
    try {
      final response = await ApiService.get('/admins/users/$userId/history');
      final grievances =
          (response.data as List).map((g) => Grievance.fromJson(g)).toList();
      state = state.copyWith(grievances: grievances, error: null);
      return grievances;
    } catch (e) {
      state = state.copyWith(grievances: [], error: e.toString());
      return [];
    }
  }

  Future<List<int>> generateReport(String filter, String format) async {
    try {
      // Note: For web, handle ResponseType.bytes (e.g., base64 or blob for downloads)
      final response = await ApiService.get('/admins/reports?filter_type=$filter&format=$format', responseType: ResponseType.bytes);
      state = state.copyWith(error: null);
      return response.data;
    } catch (e) {
      state = state.copyWith(error: e.toString());
      return [];
    }
  }

  // New methods for config management
  Future<void> getConfigs() async {
    try {
      state = state.copyWith(error: null); // Clear previous errors
      final response = await ApiService.get('/admins/configs');
      final configs =
          (response.data as List).map((json) => Config.fromJson(json)).toList();
      state = state.copyWith(configs: configs, error: null);
    } catch (e) {
      state = state.copyWith(error: 'Failed to fetch configs: $e');
    }
  }

  Future<void> addConfig(String key, String value) async {
    try {
      state = state.copyWith(error: null); // Clear previous errors
      await ApiService.post('/admins/configs', {'key': key, 'value': value});
      await getConfigs(); // Refresh configs after adding
    } catch (e) {
      state = state.copyWith(error: 'Failed to add config: $e');
    }
  }
}

final adminProvider = StateNotifierProvider<AdminNotifier, AdminState>((ref) {
  final apiService = ref.watch(apiServiceProvider);
  return AdminNotifier(apiService);
});
--- File: D:\Company_Data\PCMCApp\main_ui\lib\providers\api_provider.dart ---
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../services/api_service.dart';

final apiServiceProvider = Provider<ApiService>((ref) {
  return ApiService();
});
--- File: D:\Company_Data\PCMCApp\main_ui\lib\providers\auth_provider.dart ---
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../models/user_model.dart';
import '../services/auth_service.dart';

class AuthNotifier extends StateNotifier<User?> {
  AuthNotifier() : super(null);

  Future<void> loginWithGoogle() async {
    try {
      await AuthService.googleLogin();
      await _fetchUserAndUpdateState();
    } catch (e) {
      
      rethrow;
    }
  }

  Future<void> register(
    String name,
    String email,
    String password, {
    String? address,
    String? phoneNumber,
    String? voterId,
  }) async {
    try {
      await AuthService.register(name, email, password,
          address: address, phoneNumber: phoneNumber, voterId: voterId);
      await _fetchUserAndUpdateState();
    } catch (e) {
      
      rethrow;
    }
  }

  Future<void> loginWithEmail(String email, String password) async {
    try {
      await AuthService.passwordLogin(email, password);
      await _fetchUserAndUpdateState();
    } catch (e) {
      
      rethrow;
    }
  }

  Future<void> loginWithOtp(String phoneNumber, String otp) async {
    try {
      await AuthService.verifyOtp(phoneNumber, otp);
      await _fetchUserAndUpdateState();
    } catch (e) {
      
      rethrow;
    }
  }

  Future<void> requestOtp(String phoneNumber) async {
    try {
      await AuthService.requestOtp(phoneNumber);
    } catch (e) {
     
      rethrow;
    }
  }

  Future<void> logout() async {
    
    await AuthService.logout();
    state = null;
  }

  Future<void> checkAuth() async {
    final user = await AuthService.getCurrentUser();
    if (user != null) {
      
      state = user;
    } else {
      
      state = null;
    }
  }

  Future<void> processNewToken(String token) async {
    try {
      await AuthService.storeToken(token);
      await _fetchUserAndUpdateState();
    } catch (e) {
      
      rethrow;
    }
  }

  Future<void> _fetchUserAndUpdateState() async {
    try {
      final userData = await AuthService.getCurrentUser();
      
      state = userData;
    } catch (e) {
      
      await logout();
    }
  }
}

final authProvider = StateNotifierProvider<AuthNotifier, User?>((ref) => AuthNotifier());
--- File: D:\Company_Data\PCMCApp\main_ui\lib\providers\citizen_history_provider.dart ---
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/models/grievance_model.dart';
import 'package:main_ui/services/grievance_service.dart';

final citizenHistoryProvider = FutureProvider.family<List<Grievance>, int>((ref, userId) async {
  return await GrievanceService().getGrievancesByUserId(userId);
});
--- File: D:\Company_Data\PCMCApp\main_ui\lib\providers\comment_provider.dart ---
import 'package:flutter_riverpod/flutter_riverpod.dart';

import 'package:main_ui/services/grievance_service.dart';
import 'package:main_ui/models/comment_model.dart';
class CommentNotifier extends StateNotifier<List<Comment>> {
  final int _grievanceId;
  final GrievanceService _service;

  CommentNotifier(this._grievanceId, this._service) : super([]);

  Future<void> fetchComments() async {
    try {
      final grievance = await _service.getGrievanceDetails(_grievanceId);
      state = grievance.comments ?? [];
    } catch (e) {
      
      state = [];
    }
  }

  Future<void> addComment(String content) async {
    try {
      await _service.addComment(_grievanceId, content);
      await fetchComments();
    } catch (e) {
      rethrow;
    }
  }
}

final commentProvider =
    StateNotifierProvider.family<CommentNotifier, List<Comment>, int>(
  (ref, grievanceId) => CommentNotifier(grievanceId, GrievanceService()),
);
--- File: D:\Company_Data\PCMCApp\main_ui\lib\providers\grievance_provider.dart ---
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../models/grievance_model.dart';
import '../services/grievance_service.dart';

// Provider for fetching citizen grievance history by user ID
final citizenHistoryProvider = FutureProvider.family<List<Grievance>, int>((ref, userId) async {
  final grievanceService = GrievanceService();
  return await grievanceService.getGrievancesByUserId(userId);
});

// StateNotifier for managing grievance lists (e.g., my grievances, new grievances, assigned grievances)
class GrievanceNotifier extends StateNotifier<List<Grievance>> {
  GrievanceNotifier() : super([]);
  bool _isFetching = false;

  final GrievanceService _service = GrievanceService();

  Future<void> fetchMyGrievances() async {
    if (_isFetching) return; // Skip if already fetching
    _isFetching = true;
    try {
      state = await _service.getMyGrievances();
      
    } catch (e) {
      
      state = [];
      rethrow;
    } finally {
      _isFetching = false;
    }
  }

  Future<void> fetchNewGrievances() async {
    try {
      state = await _service.getNewGrievances();
      
    } catch (e) {
      
      state = [];
      rethrow;
    }
  }

  Future<void> fetchAssignedGrievances() async {
    try {
      state = await _service.getAssignedGrievances();
      
    } catch (e) {
      
      state = [];
      rethrow;
    }
  }
}

// Provider for the GrievanceNotifier
final grievanceProvider = StateNotifierProvider<GrievanceNotifier, List<Grievance>>((ref) {
  return GrievanceNotifier();
});
--- File: D:\Company_Data\PCMCApp\main_ui\lib\providers\locale_provider.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../services/storage_service.dart';

// Define a StateNotifier to manage locale state
class LocaleNotifier extends StateNotifier<Locale> {
  LocaleNotifier() : super(const Locale('en')) {
    _loadLocale();
  }

  Future<void> _loadLocale() async {
    final savedLocale = await StorageService.getLocale();
    if (savedLocale != null) {
      state = Locale(savedLocale);
    }
  }

  void setLocale(Locale locale) {
    state = locale;
    StorageService.saveLocale(locale.languageCode);
  }
}

// Define the locale provider
final localeNotifierProvider = StateNotifierProvider<LocaleNotifier, Locale>((ref) => LocaleNotifier());
--- File: D:\Company_Data\PCMCApp\main_ui\lib\providers\master_data_provider.dart ---
// lib/providers/master_data_provider.dart
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../models/master_data_model.dart';
import '../services/master_data_service.dart';

final subjectsProvider = FutureProvider<List<MasterSubject>>((ref) async {
  return MasterDataService.getSubjects();
});

final areasProvider = FutureProvider<List<MasterArea>>((ref) async {
  return MasterDataService.getAreas();
});
--- File: D:\Company_Data\PCMCApp\main_ui\lib\providers\user_provider.dart ---
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/models/user_model.dart';
import 'package:main_ui/services/auth_service.dart';
import 'package:main_ui/services/api_service.dart';

// Notifier for the current authenticated user
class UserNotifier extends StateNotifier<User?> {
  UserNotifier(this.ref) : super(null) {
    fetchCurrentUser();
  }

  final Ref ref;

  Future<void> fetchCurrentUser() async {
    try {
      final user = await AuthService.getCurrentUser();
      state = user;
    } catch (e) {
      
      state = null;
    }
  }

  Future<void> refreshUser() async {
    await fetchCurrentUser();
  }

  Future<void> updateUser() async {
    try {
      final response = await ApiService.get('/settings/user'); // Fetch updated user data
      if (response.data != null) {
        state = User.fromJson(response.data); // Update state with new user data
      }
    } catch (e) {
      
      rethrow; 
    }
  }

  void setUser(User? user) {
    state = user;
  }
}

// Define the user provider
final userNotifierProvider = StateNotifierProvider<UserNotifier, User?>((ref) {
  return UserNotifier(ref);
});

// Provider for managing a list of users (for admin)
final usersProvider = StateNotifierProvider<UsersNotifier, List<User>>((ref) {
  return UsersNotifier(ref);
});

// Notifier for managing a list of users
class UsersNotifier extends StateNotifier<List<User>> {
  UsersNotifier(this.ref) : super([]) {
    fetchUsers(); // Initialize by fetching users
  }

  final Ref ref;

  // Fetch all users from the backend
  Future<void> fetchUsers() async {
    try {
      final users = await ApiService.getUsers(); // Assume ApiService method
      state = users;
    } catch (e) {
    
      state = [];
    }
  }

  // Add or update a user
  Future<void> addUser(Map<String, dynamic> userData) async {
  try {
    final userDataToSend = <String, dynamic>{};
    for (final entry in userData.entries) {
      var value = entry.value;  // Can be null
      if (entry.key == 'role' && value != null) {
        value = value.toString().toLowerCase();
      }
      userDataToSend[entry.key] = value;
    }
    await ApiService.addUpdateUser(userDataToSend);
    await fetchUsers(); // Refresh the user list
  } catch (e) {
    rethrow; // Let UI handle errors
  }
}

  // Update an existing user
  Future<void> updateUser(int userId, Map<String, dynamic> userData) async {
    try {
      // The userData map already contains the id. We just need to ensure the role is lowercase.
      final dataToSend = Map<String, dynamic>.from(userData);
      if (dataToSend['role'] != null) {
        dataToSend['role'] = dataToSend['role'].toString().toLowerCase();
      }

      // The 'id' from the URL is the source of truth, but we send the body as is.
      await ApiService.addUpdateUser(dataToSend);
      await fetchUsers();
    } catch (e) {
      rethrow;
    }
  }


  // Delete a user
  Future<void> deleteUser(int userId) async {
    try {
      await ApiService.deleteUser(userId);
      await fetchUsers(); // Refresh the user list
      // If the deleted user is the current user, clear userNotifierProvider
      if (ref.read(userNotifierProvider)?.id == userId) {
        ref.read(userNotifierProvider.notifier).setUser(null);
      }
    } catch (e) {
      
      rethrow ;
    }
  }
}

=== Folder: screens ===


=== Folder: screens\admin ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\admin\all_users_history.dart ---
import 'dart:async';
import 'package:flutter/material.dart';
import 'package:main_ui/services/api_service.dart';
import 'package:main_ui/models/user_model.dart';
import 'package:main_ui/models/grievance_model.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import '../../widgets/empty_state.dart';

class AllUsersHistoryScreen extends StatefulWidget {
  const AllUsersHistoryScreen({super.key});

  @override
  State<AllUsersHistoryScreen> createState() => _AllUsersHistoryScreenState();
}

class _AllUsersHistoryScreenState extends State<AllUsersHistoryScreen> {
  List<dynamic> usersHistory = [];
  bool isLoading = true;
  String? error;
  String _searchText = '';
  final TextEditingController _searchController = TextEditingController();
  Timer? _debounce;

  @override
  void initState() {
    super.initState();
    _searchController.addListener(_onSearchChanged);
    fetchAllHistories();
  }

  void _onSearchChanged() {
    if (_debounce?.isActive ?? false) _debounce?.cancel();
    _debounce = Timer(const Duration(milliseconds: 300), () {
      setState(() {
        _searchText = _searchController.text;
      });
    });
  }

  Future<void> fetchAllHistories() async {
    try {
      final response = await ApiService.dio.get('/admins/users/history');
      setState(() {
        usersHistory = response.data;
        isLoading = false;
      });
    } catch (e) {
      setState(() {
        error = 'Failed to load histories: $e';
        isLoading = false;
      });
    }
  }

  @override
  void dispose() {
    _searchController.removeListener(_onSearchChanged);
    _searchController.dispose();
    _debounce?.cancel();
    super.dispose();
  }

  // Helper method to get status color
  Color _getStatusColor(String status) {
    switch (status.toLowerCase()) {
      case 'resolved':
        return Colors.green;
      case 'pending':
        return Colors.orange;
      case 'rejected':
        return Colors.red;
      default:
        return Colors.grey;
    }
  }

  // Helper method to get status icon
  IconData _getStatusIcon(String status) {
    switch (status.toLowerCase()) {
      case 'resolved':
        return Icons.check_circle;
      case 'pending':
        return Icons.access_time;
      case 'rejected':
        return Icons.cancel;
      default:
        return Icons.help_outline;
    }
  }

  @override
  Widget build(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);

    // Filter users based on search text
    final filteredUsersHistory = usersHistory.where((userData) {
      final user = User.fromJson(userData['user']);
      final name = user.name?.toLowerCase() ?? '';
      final email = user.email?.toLowerCase() ?? '';
      final searchText = _searchText.toLowerCase();
      return name.contains(searchText) || email.contains(searchText);
    }).toList();

    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: Text(l10n.allUsersHistory),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
      ),
      body: Container(
        color: const Color(0xFFf8fbff),
        child: Column(
          children: [
            // Search Field
            Padding(
              padding: const EdgeInsets.all(16.0),
              child: Container(
                decoration: BoxDecoration(
                  borderRadius: BorderRadius.circular(12),
                  boxShadow: [
                    BoxShadow(
                      color: Colors.black.withOpacity(0.05),
                      blurRadius: 6,
                      offset: const Offset(0, 2),
                    ),
                  ],
                ),
                child: TextField(
                  controller: _searchController,
                  decoration: InputDecoration(
                    hintText: l10n.searchByName ?? 'Search by name or email',
                    prefixIcon: const Icon(Icons.search, color: Colors.blueGrey),
                    suffixIcon: _searchText.isNotEmpty
                        ? IconButton(
                            icon: const Icon(Icons.clear, color: Colors.blueGrey),
                            onPressed: () {
                              _searchController.clear();
                              setState(() {
                                _searchText = '';
                              });
                            },
                          )
                        : null,
                    border: OutlineInputBorder(
                      borderRadius: BorderRadius.circular(12),
                      borderSide: BorderSide.none,
                    ),
                    filled: true,
                    fillColor: Colors.white,
                    contentPadding: const EdgeInsets.symmetric(vertical: 0, horizontal: 16),
                  ),
                ),
              ),
            ),
            Expanded(
              child: isLoading
                  ? const Center(
                      child: CircularProgressIndicator(
                        valueColor: AlwaysStoppedAnimation<Color>(Colors.blue),
                      ),
                    )
                  : error != null
                      ? Center(
                          child: Padding(
                            padding: const EdgeInsets.all(20.0),
                            child: Column(
                              mainAxisAlignment: MainAxisAlignment.center,
                              children: [
                                const Icon(Icons.error_outline, size: 64, color: Colors.red),
                                const SizedBox(height: 16),
                                Text(
                                  error!,
                                  textAlign: TextAlign.center,
                                  style: const TextStyle(color: Colors.red),
                                ),
                                const SizedBox(height: 16),
                                ElevatedButton(
                                  onPressed: fetchAllHistories,
                                  child: const Text('Retry'),
                                ),
                              ],
                            ),
                          ),
                        )
                      : filteredUsersHistory.isEmpty
                          ? Padding(
                              padding: const EdgeInsets.all(20.0),
                              child: EmptyState(
                                icon: _searchText.isEmpty ? Icons.history_toggle_off : Icons.search_off,
                                title: _searchText.isEmpty
                                    ? l10n.noGrievancesFound ?? 'No Histories Found'
                                    : l10n.noResultsFound ?? 'No Results Found',
                                message: _searchText.isEmpty
                                    ? l10n.noGrievancesMessage ?? 'No user histories available'
                                    : l10n.noMatchingGrievances ?? 'No matching users found',
                              ),
                            )
                          : ListView.builder(
                              padding: const EdgeInsets.symmetric(horizontal: 16),
                              itemCount: filteredUsersHistory.length,
                              itemBuilder: (context, index) {
                                final userData = filteredUsersHistory[index];
                                final user = User.fromJson(userData['user']);
                                final grievances = (userData['grievances'] as List)
                                    .map((g) => Grievance.fromJson(g))
                                    .toList();

                                return Container(
                                  margin: const EdgeInsets.only(bottom: 16),
                                  decoration: BoxDecoration(
                                    borderRadius: BorderRadius.circular(16),
                                    boxShadow: [
                                      BoxShadow(
                                        color: Colors.black.withOpacity(0.08),
                                        blurRadius: 10,
                                        offset: const Offset(0, 4),
                                      ),
                                    ],
                                  ),
                                  child: ClipRRect(
                                    borderRadius: BorderRadius.circular(16),
                                    child: ExpansionTile(
                                      backgroundColor: const Color(0xFFecf2fe),
                                      collapsedBackgroundColor: const Color(0xFFecf2fe),
                                      tilePadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
                                      title: Row(
                                        children: [
                                          CircleAvatar(
                                            backgroundColor: theme.primaryColor.withOpacity(0.2),
                                            child: Icon(
                                              Icons.person,
                                              color: theme.primaryColor,
                                            ),
                                          ),
                                          const SizedBox(width: 12),
                                          Expanded(
                                            child: Column(
                                              crossAxisAlignment: CrossAxisAlignment.start,
                                              children: [
                                                Text(
                                                  user.name ?? 'Unknown',
                                                  style: const TextStyle(
                                                    fontWeight: FontWeight.w600,
                                                    fontSize: 16,
                                                  ),
                                                ),
                                                const SizedBox(height: 4),
                                                Text(
                                                  user.email ?? 'No email',
                                                  style: TextStyle(
                                                    fontSize: 14,
                                                    color: Colors.grey[700],
                                                  ),
                                                ),
                                              ],
                                            ),
                                          ),
                                          Chip(
                                            label: Text(
                                              '${grievances.length}',
                                              style: const TextStyle(
                                                color: Colors.white,
                                                fontWeight: FontWeight.bold,
                                              ),
                                            ),
                                            backgroundColor: theme.primaryColor,
                                          ),
                                        ],
                                      ),
                                      children: [
                                        Container(
                                          color: Colors.white,
                                          padding: const EdgeInsets.all(16),
                                          child: Column(
                                            crossAxisAlignment: CrossAxisAlignment.start,
                                            children: [
                                              const Text(
                                                'Grievance History:',
                                                style: TextStyle(
                                                  fontWeight: FontWeight.bold,
                                                  fontSize: 16,
                                                ),
                                              ),
                                              const SizedBox(height: 12),
                                              ...grievances.map((g) => Container(
                                                margin: const EdgeInsets.only(bottom: 12),
                                                padding: const EdgeInsets.all(12),
                                                decoration: BoxDecoration(
                                                  color: Colors.grey[50],
                                                  borderRadius: BorderRadius.circular(12),
                                                  border: Border.all(
                                                    color: Colors.grey[200]!,
                                                    width: 1,
                                                  ),
                                                ),
                                                child: Row(
                                                  crossAxisAlignment: CrossAxisAlignment.start,
                                                  children: [
                                                    Icon(
                                                      _getStatusIcon(g.status ?? 'Unknown'),
                                                      color: _getStatusColor(g.status ?? 'Unknown'),
                                                      size: 20,
                                                    ),
                                                    const SizedBox(width: 12),
                                                    Expanded(
                                                      child: Column(
                                                        crossAxisAlignment: CrossAxisAlignment.start,
                                                        children: [
                                                          Text(
                                                            g.title,
                                                            style: const TextStyle(
                                                              fontWeight: FontWeight.w600,
                                                            ),
                                                          ),
                                                          const SizedBox(height: 4),
                                                          Text(
                                                            g.description ?? 'No description',
                                                            maxLines: 2,
                                                            overflow: TextOverflow.ellipsis,
                                                            style: TextStyle(
                                                              fontSize: 14,
                                                              color: Colors.grey[600],
                                                            ),
                                                          ),
                                                          const SizedBox(height: 8),
                                                          Row(
                                                            children: [
                                                              Container(
                                                                padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 4),
                                                                decoration: BoxDecoration(
                                                                  color: _getStatusColor(g.status ?? 'Unknown').withOpacity(0.1),
                                                                  borderRadius: BorderRadius.circular(8),
                                                                ),
                                                                child: Text(
                                                                  g.status ?? 'Unknown',
                                                                  style: TextStyle(
                                                                    color: _getStatusColor(g.status ?? 'Unknown'),
                                                                    fontSize: 12,
                                                                    fontWeight: FontWeight.w500,
                                                                  ),
                                                                ),
                                                              ),
                                                              const Spacer(),
                                                              Text(
                                                                '${g.createdAt!.day}/${g.createdAt!.month}/${g.createdAt!.year}',
                                                                style: TextStyle(
                                                                  fontSize: 12,
                                                                  color: Colors.grey[500],
                                                                ),
                                                              ),
                                                            ],
                                                          ),
                                                        ],
                                                      ),
                                                    ),
                                                  ],
                                                ),
                                              )),
                                            ],
                                          ),
                                        ),
                                      ],
                                    ),
                                  ),
                                );
                              },
                            ),
            ),
          ],
        ),
      ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\admin\audit_logs.dart ---
// lib/screens/admin/audit_logs.dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../../services/api_service.dart';
import '../../widgets/custom_button.dart';
import '../../widgets/empty_state.dart';

class AuditLogs extends ConsumerStatefulWidget {
  const AuditLogs({super.key});

  @override
  ConsumerState<AuditLogs> createState() => _AuditLogsState();
}

class _AuditLogsState extends ConsumerState<AuditLogs> {
  late Future<List<dynamic>> _logsFuture;

  @override
  void initState() {
    super.initState();
    _logsFuture = _fetchLogs();
  }

  Future<List<dynamic>> _fetchLogs() async {
    final response = await ApiService.get('/admins/audit-logs');
    return response.data as List<dynamic>;
  }

  void _refreshLogs() {
    setState(() {
      _logsFuture = _fetchLogs();
    });
  }

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);

    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: const Text(
          'Audit Logs',
          style: TextStyle(
            fontWeight: FontWeight.bold,
            color: Colors.black,
          ),
        ),
        centerTitle: true,
        backgroundColor: Colors.white,
        elevation: 2,
        shape: RoundedRectangleBorder(
          borderRadius: BorderRadius.circular(12),
        ),
        iconTheme: IconThemeData(color: Colors.blue.shade800),
        actions: [
          IconButton(
            icon: Icon(Icons.refresh, color: Colors.blue.shade600),
            tooltip: "Refresh Logs",
            onPressed: _refreshLogs,
          ),
        ],
      ),
      body: FutureBuilder<List<dynamic>>(
        future: _logsFuture,
        builder: (context, snapshot) {
          if (snapshot.connectionState == ConnectionState.waiting) {
            return Center(
              child: CircularProgressIndicator(
                color: Colors.blue.shade600,
                strokeWidth: 3,
              ),
            );
          }
          if (snapshot.hasError) {
            return EmptyState(
              icon: Icons.error_outline,
              title: 'Error Loading Logs',
              message: 'Failed to load audit logs. Please try again.',
              actionButton: CustomButton(
                text: 'Retry',
                onPressed: _refreshLogs,
                backgroundColor: Colors.blue.shade600,
                
              ),
            );
          }
          final logs = snapshot.data ?? [];
          if (logs.isEmpty) {
            return const EmptyState(
              icon: Icons.history_toggle_off,
              title: 'No Audit Logs',
              message: 'There are no audit logs to display at this time.',
            );
          }

          return Padding(
            padding: const EdgeInsets.all(16.0),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Row(
                  mainAxisAlignment: MainAxisAlignment.spaceBetween,
                  children: [
                    Text(
                      'Recent Activities',
                      style: theme.textTheme.titleLarge?.copyWith(
                        color: Colors.blue.shade800,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                    Chip(
                      label: Text(
                        '${logs.length} entries',
                        style: const TextStyle(
                          fontSize: 12,
                          fontWeight: FontWeight.bold,
                          color: Colors.white,
                        ),
                      ),
                      backgroundColor: Colors.blue.shade600,
                    ),
                  ],
                ),
                const SizedBox(height: 16),
                Expanded(
                  child: ListView.separated(
                    itemCount: logs.length,
                    separatorBuilder: (_, __) => const SizedBox(height: 12),
                    itemBuilder: (context, index) {
                      final log = logs[index];
                      return _buildLogCard(log, theme);
                    },
                  ),
                ),
              ],
            ),
          );
        },
      ),
    );
  }

  Widget _buildLogCard(Map<String, dynamic> log, ThemeData theme) {
    return Container(
      decoration: BoxDecoration(
        color: const Color(0xFFecf2fe),
        borderRadius: BorderRadius.circular(16),
        boxShadow: [
          BoxShadow(
            color: Colors.blue.shade100,
            blurRadius: 8,
            offset: const Offset(0, 2),
          ),
        ],
      ),
      child: Material(
        color: Colors.transparent,
        child: InkWell(
          borderRadius: BorderRadius.circular(16),
          onTap: () {
            // Handle log item tap if needed
          },
          child: Padding(
            padding: const EdgeInsets.all(16.0),
            child: Row(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Container(
                  width: 40,
                  height: 40,
                  decoration: BoxDecoration(
                    color: Colors.blue.shade100,
                    shape: BoxShape.circle,
                  ),
                  child: Icon(
                    _getActionIcon(log['action']),
                    color: Colors.blue.shade800,
                    size: 20,
                  ),
                ),
                const SizedBox(width: 16),
                Expanded(
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      Text(
                        log['action'] ?? 'Unknown Action',
                        style: theme.textTheme.titleMedium?.copyWith(
                          fontWeight: FontWeight.bold,
                          color: Colors.blue.shade900,
                        ),
                        maxLines: 2,
                        overflow: TextOverflow.ellipsis,
                      ),
                      const SizedBox(height: 8),
                      _buildInfoRow(
                        Icons.person,
                        'Performed by: ${log['performed_by'] ?? 'Unknown'}',
                        theme,
                      ),
                      const SizedBox(height: 4),
                      _buildInfoRow(
                        Icons.access_time,
                        'At: ${_formatTimestamp(log['timestamp'])}',
                        theme,
                      ),
                      if (log['details'] != null) ...[
                        const SizedBox(height: 4),
                        _buildInfoRow(
                          Icons.description,
                          'Details: ${log['details']}',
                          theme,
                        ),
                      ],
                    ],
                  ),
                ),
              ],
            ),
          ),
        ),
      ),
    );
  }

  Widget _buildInfoRow(IconData icon, String text, ThemeData theme) {
    return Row(
      crossAxisAlignment: CrossAxisAlignment.start,
      children: [
        Icon(
          icon,
          size: 14,
          color: Colors.blue.shade600,
        ),
        const SizedBox(width: 6),
        Expanded(
          child: Text(
            text,
            style: theme.textTheme.bodySmall?.copyWith(
              color: Colors.blue.shade700,
            ),
            maxLines: 2,
            overflow: TextOverflow.ellipsis,
          ),
        ),
      ],
    );
  }

  IconData _getActionIcon(String action) {
    final lowerAction = action.toLowerCase();
    if (lowerAction.contains('login')) return Icons.login;
    if (lowerAction.contains('create') || lowerAction.contains('add')) return Icons.add_circle;
    if (lowerAction.contains('update') || lowerAction.contains('edit')) return Icons.edit;
    if (lowerAction.contains('delete') || lowerAction.contains('remove')) return Icons.delete;
    if (lowerAction.contains('view') || lowerAction.contains('read')) return Icons.visibility;
    if (lowerAction.contains('export')) return Icons.download;
    if (lowerAction.contains('import')) return Icons.upload;
    return Icons.info;
  }

  String _formatTimestamp(String timestamp) {
    try {
      final dateTime = DateTime.parse(timestamp);
      return '${dateTime.day}/${dateTime.month}/${dateTime.year} ${dateTime.hour}:${dateTime.minute.toString().padLeft(2, '0')}';
    } catch (e) {
      return timestamp;
    }
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\admin\complaint_management.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/models/grievance_model.dart';
import 'package:main_ui/models/user_model.dart';
import 'package:main_ui/models/master_data_model.dart';
import 'package:main_ui/services/user_service.dart';
import 'package:main_ui/services/master_data_service.dart';
import 'package:main_ui/widgets/custom_button.dart';
import 'package:main_ui/widgets/empty_state.dart';
import 'package:main_ui/widgets/grievance_card.dart';
import 'package:main_ui/providers/admin_provider.dart';
import 'package:main_ui/widgets/custom_button_.dart';

class ComplaintManagement extends ConsumerStatefulWidget {
  const ComplaintManagement({super.key});

  @override
  _ComplaintManagementState createState() => _ComplaintManagementState();
}

class _ComplaintManagementState extends ConsumerState<ComplaintManagement> {
  String? _selectedStatus;
  int? _selectedAreaId;
  int? _selectedSubjectId;
  String? _selectedPriority;
  List<Grievance> _grievances = [];
  List<User> _assignees = [];
  List<MasterArea> _areas = [];
  List<MasterSubject> _subjects = [];
  String? _errorMessage;
  bool _isLoading = true;

  @override
  void initState() {
    super.initState();
    _fetchData();
  }

  Future<void> _fetchData() async {
    setState(() {
      _isLoading = true;
      _errorMessage = null;
    });
    try {
      final grievances = await ref.read(adminProvider.notifier).getAllGrievances(
            status: _selectedStatus,
            priority: _selectedPriority,
            areaId: _selectedAreaId,
            subjectId: _selectedSubjectId,
          );
      final assignees = await UserService.getUsers();
      final areas = await MasterDataService.getAreas();
      final subjects = await MasterDataService.getSubjects();
      setState(() {
        _grievances = grievances;
        _assignees = assignees.where((u) => u.role?.toLowerCase() == 'field_staff').toList();
        _areas = areas;
        _subjects = subjects;
        _isLoading = false;
      });
    } catch (e) {
      setState(() {
        _errorMessage = e.toString();
        _isLoading = false;
      });
    }
  }

  @override
  Widget build(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);

    if (_isLoading) {
      return Scaffold(
        backgroundColor: const Color(0xFFf8fbff),
        appBar: AppBar(
          title: Text(l10n.complaintManagement),
          centerTitle: true,
          backgroundColor: theme.colorScheme.primary,
          foregroundColor: theme.colorScheme.onPrimary,
          elevation: 2,
        ),
        body: const Center(
          child: CircularProgressIndicator(),
        ),
      );
    }

    if (_errorMessage != null) {
      return Scaffold(
        backgroundColor: const Color(0xFFf8fbff),
        appBar: AppBar(
          title: Text(l10n.complaintManagement),
          centerTitle: true,
          backgroundColor: theme.colorScheme.primary,
          foregroundColor: theme.colorScheme.onPrimary,
          elevation: 2,
        ),
        body: EmptyState(
          icon: Icons.error,
          title: l10n.error,
          message: _errorMessage!,
          actionButton: CustomButton(
            text: l10n.retry,
            onPressed: _fetchData,
            icon: Icons.refresh,
          ),
        ),
      );
    }

    if (_grievances.isEmpty) {
      return Scaffold(
        backgroundColor: const Color(0xFFf8fbff),
        appBar: AppBar(
          title: Text(l10n.complaintManagement),
          centerTitle: true,
          backgroundColor: theme.colorScheme.primary,
          foregroundColor: theme.colorScheme.onPrimary,
          elevation: 2,
        ),
        body: EmptyState(
          icon: Icons.inbox,
          title: l10n.noComplaints,
          message: l10n.noComplaintsMessage,
          actionButton: CustomButton(
            text: l10n.retry,
            onPressed: _fetchData,
            icon: Icons.refresh,
          ),
        ),
      );
    }

    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: Text(l10n.complaintManagement),
        centerTitle: true,
        backgroundColor: theme.colorScheme.primary,
        foregroundColor: theme.colorScheme.onPrimary,
        elevation: 2,
      ),
      body: Column(
        children: [
          Card(
            margin: const EdgeInsets.all(16),
            elevation: 2,
            color: const Color(0xFFecf2fe),
            child: Padding(
              padding: const EdgeInsets.all(16.0),
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Text(
                    l10n.filters,
                    style: theme.textTheme.titleMedium?.copyWith(
                      fontWeight: FontWeight.bold,
                      color: theme.colorScheme.primary,
                    ),
                  ),
                  const SizedBox(height: 12),
                  Wrap(
                    spacing: 12.0,
                    runSpacing: 12.0,
                    children: [
                      FilterChip(
                        label: Text(_selectedStatus?.capitalize() ?? l10n.filterByStatus),
                        selected: _selectedStatus != null,
                        onSelected: (selected) {
                          if (!selected) {
                            setState(() => _selectedStatus = null);
                            _fetchData();
                          }
                        },
                        backgroundColor: Colors.white,
                        selectedColor: theme.colorScheme.primary.withOpacity(0.2),
                        labelStyle: TextStyle(
                          color: _selectedStatus != null 
                            ? theme.colorScheme.primary 
                            : theme.colorScheme.onSurface,
                        ),
                      ),
                      FilterChip(
                        label: Text(_selectedPriority?.capitalize() ?? l10n.filterByPriority),
                        selected: _selectedPriority != null,
                        onSelected: (selected) {
                          if (!selected) {
                            setState(() => _selectedPriority = null);
                            _fetchData();
                          }
                        },
                        backgroundColor: Colors.white,
                        selectedColor: theme.colorScheme.primary.withOpacity(0.2),
                        labelStyle: TextStyle(
                          color: _selectedPriority != null 
                            ? theme.colorScheme.primary 
                            : theme.colorScheme.onSurface,
                        ),
                      ),
                      FilterChip(
                        label: Text(
                          _selectedAreaId != null 
                            ? _areas.firstWhere((a) => a.id == _selectedAreaId, orElse: () => MasterArea(id: 0, name: 'Unknown')).name
                            : l10n.filterByArea
                        ),
                        selected: _selectedAreaId != null,
                        onSelected: (selected) {
                          if (!selected) {
                            setState(() => _selectedAreaId = null);
                            _fetchData();
                          }
                        },
                        backgroundColor: Colors.white,
                        selectedColor: theme.colorScheme.primary.withOpacity(0.2),
                        labelStyle: TextStyle(
                          color: _selectedAreaId != null 
                            ? theme.colorScheme.primary 
                            : theme.colorScheme.onSurface,
                        ),
                      ),
                      FilterChip(
                        label: Text(
                          _selectedSubjectId != null 
                            ? _subjects.firstWhere((s) => s.id == _selectedSubjectId, orElse: () => MasterSubject(id: 0, name: 'Unknown')).name
                            : l10n.filterBySubject
                        ),
                        selected: _selectedSubjectId != null,
                        onSelected: (selected) {
                          if (!selected) {
                            setState(() => _selectedSubjectId = null);
                            _fetchData();
                          }
                        },
                        backgroundColor: Colors.white,
                        selectedColor: theme.colorScheme.primary.withOpacity(0.2),
                        labelStyle: TextStyle(
                          color: _selectedSubjectId != null 
                            ? theme.colorScheme.primary 
                            : theme.colorScheme.onSurface,
                        ),
                      ),
                      ActionChip(
                        label: Text(l10n.clearFilters),
                        onPressed: () {
                          setState(() {
                            _selectedStatus = null;
                            _selectedPriority = null;
                            _selectedAreaId = null;
                            _selectedSubjectId = null;
                          });
                          _fetchData();
                        },
                        backgroundColor: theme.colorScheme.primary,
                        labelStyle: TextStyle(color: theme.colorScheme.onPrimary),
                        avatar: Icon(Icons.clear, size: 18, color: theme.colorScheme.onPrimary),
                      ),
                    ],
                  ),
                ],
              ),
            ),
          ),
          Expanded(
            child: RefreshIndicator(
              onRefresh: _fetchData,
              child: ListView.builder(
                padding: const EdgeInsets.symmetric(horizontal: 16.0, vertical: 8.0),
                itemCount: _grievances.length,
                itemBuilder: (ctx, idx) {
                  final grievance = _grievances[idx];
                  return Card(
                    elevation: 1,
                    margin: const EdgeInsets.only(bottom: 16),
                    color: const Color(0xFFecf2fe),
                    child: Padding(
                      padding: const EdgeInsets.all(16.0),
                      child: Column(
                        children: [
                          GrievanceCard(grievance: grievance),
                          const SizedBox(height: 16),
                          Column(
                            children: [
                              Row(
                                mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                                children: [
                                  Expanded(
                                    child: CustomButton2(
                                      text: l10n.reassignComplaint,
                                      onPressed: grievance.assignedTo != null
                                          ? null : () => _showReassignDialog(grievance.id),
                                      icon: Icons.person_add,                                      
                                      size: ButtonSize.small,
                                      backgroundColor: theme.colorScheme.primary,
                                      foregroundColor: Colors.white,
                                    ),
                                  ),
                                  // const SizedBox(width: 8),
                                  // Expanded(
                                  //   child: CustomButton2(
                                  //     text: l10n.escalateComplaint,
                                  //     onPressed: () => _showEscalateDialog(grievance.id),
                                  //     icon: Icons.arrow_upward,
                                  //     variant: ButtonVariant.outlined,
                                  //     size: ButtonSize.small,
                                  //   ),
                                  // ),
                                ],
                              ),
                              const SizedBox(height: 8),
                              Row(
                                mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                                children: [
                                  Expanded(
                                    child: CustomButton2(
                                      text: l10n.updateStatus, // Changed from updateStatus
                                      onPressed: grievance.status == 'resolved'
                                          ? null
                                          : () => _showStatusDialog(grievance.id),
                                      icon: Icons.update,                                      
                                      size: ButtonSize.small,
                                      backgroundColor: theme.colorScheme.primary,
                                      foregroundColor: Colors.white,
                                    ),
                                  ),
                                  const SizedBox(width: 8),
                                  Expanded(
                                    child: CustomButton2(
                                      text: l10n.viewDetails,
                                      onPressed: () { // Changed from viewDetails
                                        if (grievance.id > 0) {
                                          Navigator.pushNamed(
                                            context,
                                            '/citizen/detail',
                                            arguments: grievance.id,
                                          );
                                        } else {
                                          ScaffoldMessenger.of(context).showSnackBar(
                                            SnackBar(
                                              content: const Text("Invalid grievance ID"),
                                              backgroundColor: theme.colorScheme.error,
                                            ),
                                          );
                                        }
                                      },
                                      icon: Icons.info,                                      
                                      size: ButtonSize.small,
                                      backgroundColor: theme.colorScheme.primary,
                                      foregroundColor: Colors.white,
                                    ),
                                  ),
                                ],
                              ),
                            ],
                          ),
                        ],
                      ),
                    ),
                  );
                },
              ),
            ),
          ),
        ],
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: _showFilterDialog,
        backgroundColor: theme.colorScheme.primary,
        foregroundColor: theme.colorScheme.onPrimary,
        child: const Icon(Icons.filter_list),
      ),
    );
  }

  void _showFilterDialog() {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);
    
    String? tempStatus = _selectedStatus;
    String? tempPriority = _selectedPriority;
    int? tempAreaId = _selectedAreaId;
    int? tempSubjectId = _selectedSubjectId;
    
    showDialog(
      context: context,
      builder: (ctx) {
        return StatefulBuilder(
          builder: (context, setState) {
            return AlertDialog(
              title: Text(l10n.filters, style: theme.textTheme.titleLarge),
              content: SingleChildScrollView(
                child: Column(
                  mainAxisSize: MainAxisSize.min,
                  children: [
                    DropdownButtonFormField<String>(
                      decoration: InputDecoration(
                        labelText: l10n.filterByStatus,
                        border: OutlineInputBorder(
                          borderRadius: BorderRadius.circular(8),
                        ),
                      ),
                      value: tempStatus,
                      isExpanded: true,
                      items: [
                        DropdownMenuItem(value: null, child: Text(l10n.filterByStatus)),
                        ...['new', 'in_progress', 'on_hold', 'resolved', 'closed', 'rejected']
                            .map((s) => DropdownMenuItem(value: s, child: Text(s.capitalize())))
                            ,
                      ],
                      onChanged: (value) {
                        setState(() => tempStatus = value);
                      },
                    ),
                    const SizedBox(height: 16),
                    DropdownButtonFormField<String>(
                      decoration: InputDecoration(
                        labelText: l10n.filterByPriority,
                        border: OutlineInputBorder(
                          borderRadius: BorderRadius.circular(8),
                        ),
                      ),
                      value: tempPriority,
                      isExpanded: true,
                      items: [
                        DropdownMenuItem(value: null, child: Text(l10n.filterByPriority)),
                        ...['low', 'medium', 'high', 'urgent']
                            .map((p) => DropdownMenuItem(value: p, child: Text(p.capitalize())))
                            ,
                      ],
                      onChanged: (value) {
                        setState(() => tempPriority = value);
                      },
                    ),
                    const SizedBox(height: 16),
                    DropdownButtonFormField<int>(
                      decoration: InputDecoration(
                        labelText: l10n.filterByArea,
                        border: OutlineInputBorder(
                          borderRadius: BorderRadius.circular(8),
                        ),
                      ),
                      value: tempAreaId,
                      isExpanded: true,
                      items: [
                        DropdownMenuItem(value: null, child: Text(l10n.filterByArea)),
                        ..._areas
                            .map((a) => DropdownMenuItem(value: a.id, child: Text(a.name)))
                            ,
                      ],
                      onChanged: (value) {
                        setState(() => tempAreaId = value);
                      },
                    ),
                    const SizedBox(height: 16),
                    DropdownButtonFormField<int>(
                      decoration: InputDecoration(
                        labelText: l10n.filterBySubject,
                        border: OutlineInputBorder(
                          borderRadius: BorderRadius.circular(8),
                        ),
                      ),
                      value: tempSubjectId,
                      isExpanded: true,
                      items: [
                        DropdownMenuItem(value: null, child: Text(l10n.filterBySubject)),
                        ..._subjects
                            .map((s) => DropdownMenuItem(value: s.id, child: Text(s.name)))
                            ,
                      ],
                      onChanged: (value) {
                        setState(() => tempSubjectId = value);
                      },
                    ),
                  ],
                ),
              ),
              actions: [
                TextButton(
                  onPressed: () => Navigator.pop(ctx),
                  child: Text(l10n.cancel),
                ),
                TextButton(
                  onPressed: () {
                    setState(() {
                      _selectedStatus = tempStatus;
                      _selectedPriority = tempPriority;
                      _selectedAreaId = tempAreaId;
                      _selectedSubjectId = tempSubjectId;
                    });
                    Navigator.pop(ctx);
                    _fetchData();
                  },
                  child: Text(l10n.apply),
                ),
              ],
            );
          },
        );
      },
    );
  }

  // void _showEscalateDialog(int grievanceId) {
  //   final l10n = AppLocalizations.of(context)!;
  //   final theme = Theme.of(context);
  //   int? selectedAssigneeId;

  //   showDialog(
  //     context: context,
  //     builder: (ctx) {
  //       return StatefulBuilder(
  //         builder: (context, setState) {
  //           return AlertDialog(
  //             title: Text(l10n.escalateComplaint, style: theme.textTheme.titleLarge),
  //             content: _assignees.isEmpty
  //                 ? Text('No field staff available for escalation.')
  //                 : DropdownButtonFormField<int>(
  //                     decoration: InputDecoration(
  //                       labelText: l10n.selectAssignee,
  //                       border: OutlineInputBorder(
  //                         borderRadius: BorderRadius.circular(8),
  //                       ),
  //                     ),
  //                     value: selectedAssigneeId,
  //                     isExpanded: true,
  //                     items: _assignees
  //                         .map((u) => DropdownMenuItem(
  //                               value: u.id,
  //                               child: Text(u.name ?? "Unknown User"),
  //                             ))
  //                         .toList(),
  //                     onChanged: (value) {
  //                       setState(() => selectedAssigneeId = value);
  //                     },
  //                   ),
  //             actions: [
  //               TextButton(
  //                 onPressed: () => Navigator.pop(ctx),
  //                 child: Text(l10n.cancel),
  //               ),
  //               ElevatedButton(
  //                 onPressed: () async {
  //                   if (selectedAssigneeId != null) {
  //                     try {
  //                       // Assuming the current user is an admin with a static ID for now.
  //                       // This should be replaced with the actual logged-in admin's ID.
  //                       int adminId = 4;
  //                       await ref.read(adminProvider.notifier).escalateGrievance(grievanceId, selectedAssigneeId!, adminId);
  //                       Navigator.pop(ctx);
  //                       ScaffoldMessenger.of(context).showSnackBar(SnackBar(content: Text('Grievance escalated successfully')));
  //                       _fetchData();
  //                     } catch (e) {
  //                       ScaffoldMessenger.of(context).showSnackBar(SnackBar(content: Text('Escalation failed: $e')));
  //                     }
  //                   }
  //                 },
  //                 child: Text(l10n.escalate),
  //               ),
  //             ],
  //           );
  //         },
  //       );
  //     },
  //   );
  // }

  void _showReassignDialog(int grievanceId) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);
    int? selectedAssigneeId;
    
    showDialog(
      context: context,
      builder: (ctx) {
        return StatefulBuilder(
          builder: (context, setState) {
            return AlertDialog(
              title: Text(l10n.reassignComplaint, style: theme.textTheme.titleLarge),
              content: _assignees.isEmpty
                  ? Text('No field staff available')
                  : DropdownButtonFormField<int>(
                      decoration: InputDecoration(
                        labelText: l10n.selectAssignee,
                        border: OutlineInputBorder(
                          borderRadius: BorderRadius.circular(8),
                        ),
                      ),
                      value: selectedAssigneeId,
                      isExpanded: true,
                      items: _assignees
                          .map((u) => DropdownMenuItem(
                                value: u.id,
                                child: Text(u.name ?? "Unknown User"),
                              ))
                          .toList(),
                      onChanged: (value) {
                        setState(() => selectedAssigneeId = value);
                      },
                    ),
              actions: [
                TextButton(
                  onPressed: () => Navigator.pop(ctx),
                  child: Text(l10n.cancel),
                ),
                ElevatedButton(
                  onPressed: () async {
                    if (selectedAssigneeId != null) {
                      try {
                        await ref.read(adminProvider.notifier).reassignGrievance(grievanceId, selectedAssigneeId!);
                        Navigator.pop(ctx);
                        ScaffoldMessenger.of(context).showSnackBar(
                          SnackBar(
                            content: Text('${l10n.reassignComplaint} Successful'),
                            backgroundColor: theme.colorScheme.primary,
                          ),
                        );
                        _fetchData();
                      } catch (e) {
                        ScaffoldMessenger.of(context).showSnackBar(
                          SnackBar(
                            content: Text(e.toString()),
                            backgroundColor: theme.colorScheme.error,
                          ),
                        );
                      }
                    } else {
                      ScaffoldMessenger.of(context).showSnackBar(
                        SnackBar(
                          content: Text(l10n.selectAssignee),
                          backgroundColor: theme.colorScheme.error,
                        ),
                      );
                    }
                  },
                  child: Text(l10n.reassign),
                ),
              ],
            );
          },
        );
      },
    );
  }

  void _showStatusDialog(int grievanceId) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);
    String? selectedStatus;
    
    showDialog(
      context: context,
      builder: (ctx) {
        return StatefulBuilder(
          builder: (context, setState) {
            return AlertDialog(
              title: Text(l10n.updateStatus, style: theme.textTheme.titleLarge),
              content: DropdownButtonFormField<String>(
                decoration: InputDecoration(
                  labelText: l10n.selectStatus,
                  border: OutlineInputBorder(
                    borderRadius: BorderRadius.circular(8),
                  ),
                ),
                value: selectedStatus,
                isExpanded: true,
                items: [
                  DropdownMenuItem(value: null, child: Text(l10n.selectStatus)),
                  ...['new', 'in_progress', 'on_hold', 'resolved', 'closed', 'rejected']
                      .map((s) => DropdownMenuItem(value: s, child: Text(s.capitalize())))
                      ,
                ],
                onChanged: (value) {
                  setState(() => selectedStatus = value);
                },
              ),
              actions: [
                TextButton(
                  onPressed: () => Navigator.pop(ctx),
                  child: Text(l10n.cancel),
                ),
                ElevatedButton(
                  onPressed: () async {
                    if (selectedStatus != null) {
                      try {
                        await ref.read(adminProvider.notifier).updateGrievanceStatus(grievanceId, selectedStatus!);
                        Navigator.pop(ctx);
                        ScaffoldMessenger.of(context).showSnackBar(
                          SnackBar(
                            content: Text('${l10n.updateStatus} Successful'),
                            backgroundColor: theme.colorScheme.primary,
                          ),
                        );
                        _fetchData();
                      } catch (e) {
                        ScaffoldMessenger.of(context).showSnackBar(
                          SnackBar(
                            content: Text(e.toString()),
                            backgroundColor: theme.colorScheme.error,
                          ),
                        );
                      }
                    } else {
                      ScaffoldMessenger.of(context).showSnackBar(
                        SnackBar(
                          content: Text(l10n.selectStatus),
                          backgroundColor: theme.colorScheme.error,
                        ),
                      );
                    }
                  },
                  child: Text(l10n.update),
                ),
              ],
            );
          },
        );
      },
    );
  }
}

extension StringExtension on String {
  String capitalize() {
    if (isEmpty) return this;
    return "${this[0].toUpperCase()}${substring(1)}";
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\admin\dashboard.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:fl_chart/fl_chart.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/widgets/grievance_card.dart';
import 'package:main_ui/providers/admin_provider.dart';
import 'package:path_provider/path_provider.dart';
import 'package:open_file/open_file.dart';
import 'dart:io' as io;
import 'package:main_ui/models/grievance_model.dart';
import 'package:main_ui/models/kpi_model.dart';
import 'package:main_ui/widgets/empty_state.dart';
import 'package:main_ui/widgets/loading_indicator.dart';
import 'package:main_ui/widgets/navigation_drawer.dart';
import 'package:universal_html/html.dart' as html;
import 'package:flutter/foundation.dart';

class Dashboard extends ConsumerStatefulWidget {
  const Dashboard({super.key});

  @override
  _DashboardState createState() => _DashboardState();
}

class _DashboardState extends ConsumerState<Dashboard> {
  String _selectedPeriod = 'all';
  late Future<List<Grievance>> _grievancesFuture;

  @override
  void initState() {
    super.initState();
    _grievancesFuture = ref.read(adminProvider.notifier).getAllGrievances();
    _fetchData();
  }

  Future<void> _fetchData() async {
    try {
      await ref.read(adminProvider.notifier).fetchAdvancedKPIs(timePeriod: _selectedPeriod);
      setState(() {
        _grievancesFuture = ref.read(adminProvider.notifier).getAllGrievances();
      });
    } catch (e) {
      if (mounted) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('${AppLocalizations.of(context)!.error}: $e')),
        );
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    final adminState = ref.watch(adminProvider);
    final kpiData = adminState.kpiData;
    final theme = Theme.of(context);
    final loc = AppLocalizations.of(context)!;

    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: Text(loc.appTitle),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
      ),
      drawer: const CustomNavigationDrawer(),
      body: RefreshIndicator(
        onRefresh: _fetchData,
        backgroundColor: Colors.white,
        color: Colors.blue.shade600,
        child: SingleChildScrollView(
          padding: const EdgeInsets.all(16.0),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              _buildFilterDropdown(theme, loc),
              const SizedBox(height: 20),
              kpiData != null
                  ? Column(
                      children: [
                        _buildKpiCard(theme, kpiData, loc),
                        const SizedBox(height: 20),
                        _buildPieChartCard(theme, kpiData, loc),
                        const SizedBox(height: 20),
                        _buildLineChartCard(theme, kpiData, loc),
                        const SizedBox(height: 20),
                        _buildBarChartCard(theme, kpiData, loc),
                        const SizedBox(height: 20),
                        _buildSlaCard(theme, kpiData, loc),
                        const SizedBox(height: 20),
                        Padding(
                          padding: const EdgeInsets.symmetric(horizontal: 8.0),
                          child: Text(loc.recentComplaints ?? 'Recent Complaints',
                              style: theme.textTheme.titleLarge?.copyWith(
                                color: Colors.blue.shade800,
                                fontWeight: FontWeight.bold,
                              )),
                        ),
                        const SizedBox(height: 12),
                        _buildRecentComplaints(loc),
                        const SizedBox(height: 24),
                        _buildExportButtons(loc),
                      ],
                    )
                  : EmptyState(
                      icon: Icons.error,
                      title: loc.noGrievances,
                      message: loc.noGrievancesMessage,
                      actionButton: ElevatedButton(
                        onPressed: _fetchData,
                        child: Text(loc.retry),
                      ),
                    ),
            ],
          ),
        ),
      ),
    );
  }

  Widget _buildFilterDropdown(ThemeData theme, AppLocalizations loc) {
    return Container(
      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
      decoration: BoxDecoration(
        color: Colors.white,
        borderRadius: BorderRadius.circular(12),
        boxShadow: [
          BoxShadow(
            color: Colors.black.withOpacity(0.1),
            blurRadius: 4,
            offset: const Offset(0, 2),
          ),
        ],
      ),
      child: Row(
        mainAxisAlignment: MainAxisAlignment.end,
        children: [
          Text(loc.filterByPeriod ?? 'Time Period: ',
              style: theme.textTheme.bodyMedium?.copyWith(
                color: Colors.grey.shade700,
                fontWeight: FontWeight.w500,
              )),
          const SizedBox(width: 12),
          DropdownButton<String>(
            value: _selectedPeriod,
            style: theme.textTheme.bodyMedium?.copyWith(
              color: Colors.blue.shade800,
            ),
            dropdownColor: Colors.white,
            borderRadius: BorderRadius.circular(12),
            icon: Icon(Icons.arrow_drop_down, color: Colors.blue.shade600),
            items: ['day', 'week', 'month', 'year', 'all']
                .map((period) => DropdownMenuItem(
                      value: period,
                      child: Text(period.capitalize()),
                    ))
                .toList(),
            onChanged: (value) {
              if (value != null) {
                setState(() => _selectedPeriod = value);
                _fetchData();
              }
            },
          ),
        ],
      ),
    );
  }

  Widget _buildKpiCard(ThemeData theme, KpiData kpiData, AppLocalizations loc) {
    final totalComplaints = kpiData.totalComplaints ?? {};

    return Card(
      elevation: 2,
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
      color: const Color(0xFFecf2fe),
      child: Padding(
        padding: const EdgeInsets.all(20.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(loc.totalComplaints ?? 'Total Complaints',
                style: theme.textTheme.titleMedium?.copyWith(
                  color: Colors.blue.shade800,
                  fontWeight: FontWeight.bold,
                )),
            const SizedBox(height: 16),
            Wrap(
              spacing: 24,
              runSpacing: 16,
              children: [
                _buildMetricItem(loc.day ?? 'Day', totalComplaints['day'] ?? 0, Colors.blue),
                _buildMetricItem(loc.week ?? 'Week', totalComplaints['week'] ?? 0, Colors.green),
                _buildMetricItem(loc.month ?? 'Month', totalComplaints['month'] ?? 0, Colors.orange),
                _buildMetricItem(loc.year ?? 'Year', totalComplaints['year'] ?? 0, Colors.purple),
                _buildMetricItem(loc.allTime ?? 'All Time', totalComplaints['all'] ?? 0, Colors.red),
              ],
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildMetricItem(String label, int value, Color color) {
    return Container(
      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),
      decoration: BoxDecoration(
        color: Colors.white,
        borderRadius: BorderRadius.circular(12),
        boxShadow: [
          BoxShadow(
            color: color.withOpacity(0.1),
            blurRadius: 8,
            offset: const Offset(0, 2),
          ),
        ],
      ),
      child: Column(
        children: [
          Text(label, 
            style: TextStyle(
              fontSize: 12,
              color: Colors.grey.shade600,
              fontWeight: FontWeight.w500,
            )),
          const SizedBox(height: 4),
          Text(
            '$value',
            style: TextStyle(
              fontSize: 18,
              fontWeight: FontWeight.bold,
              color: color,
            ),
          ),
        ],
      ),
    );
  }

  Widget _buildPieChartCard(ThemeData theme, KpiData kpiData, AppLocalizations loc) {
    final statusOverview = kpiData.statusOverview ?? {};

    return Card(
      elevation: 2,
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
      color: const Color(0xFFecf2fe),
      child: Padding(
        padding: const EdgeInsets.all(20.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(loc.complaintStatusOverview ?? 'Complaint Status Overview',
                style: theme.textTheme.titleMedium?.copyWith(
                  color: Colors.blue.shade800,
                  fontWeight: FontWeight.bold,
                )),
            const SizedBox(height: 16),
            SizedBox(
              height: 240,
              child: statusOverview.isNotEmpty
                  ? PieChart(
                      PieChartData(
                        sections: _buildPieChartSections(statusOverview),
                        centerSpaceRadius: 50,
                        sectionsSpace: 0,
                      ),
                    )
                  : Center(
                      child: CircularProgressIndicator(
                        color: Colors.blue.shade600,
                      ),
                    ),
            ),
          ],
        ),
      ),
    );
  }

  List<PieChartSectionData> _buildPieChartSections(Map<String, dynamic> statusOverview) {
    const colors = [
      Colors.blue,
      Colors.orange,
      Colors.green,
      Colors.red,
      Colors.purple,
      Colors.teal,
      Colors.amber,
      Colors.deepOrange,
    ];
    int index = 0;

    final entries = statusOverview.entries
        .where((entry) =>
            (entry.value is num && (entry.value as num) > 0) ||
            (entry.value is String && int.tryParse(entry.value) != null && int.parse(entry.value) > 0))
        .toList();

    if (entries.isEmpty) {
      return [
        PieChartSectionData(
          value: 1,
          title: 'No Data',
          color: Colors.grey.shade300,
          radius: 60,
          titleStyle: const TextStyle(
            fontSize: 14,
            fontWeight: FontWeight.bold,
            color: Colors.grey,
          ),
        )
      ];
    }

    return entries.map((entry) {
      final color = colors[index % colors.length];
      index++;
      final value = entry.value is num
          ? (entry.value as num).toDouble()
          : double.tryParse(entry.value.toString()) ?? 0.0;

      return PieChartSectionData(
        value: value,
        title: '${value.toInt()}',
        color: color,
        radius: 60,
        titleStyle: const TextStyle(
          fontSize: 14,
          fontWeight: FontWeight.bold,
          color: Colors.white,
        ),
        badgeWidget: Container(
          padding: const EdgeInsets.all(4),
          decoration: BoxDecoration(
            color: Colors.white,
            borderRadius: BorderRadius.circular(6),
            boxShadow: [
              BoxShadow(
                color: Colors.black.withOpacity(0.1),
                blurRadius: 4,
              ),
            ],
          ),
          child: Text(
            entry.key.capitalize(),
            style: TextStyle(
              fontSize: 10,
              fontWeight: FontWeight.bold,
              color: color,
            ),
          ),
        ),
        badgePositionPercentageOffset: 1.2,
      );
    }).toList();
  }

  Widget _buildLineChartCard(ThemeData theme, KpiData kpiData, AppLocalizations loc) {
    final totalComplaints = kpiData.totalComplaints ?? {};

    return Card(
      elevation: 2,
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
      color: const Color(0xFFecf2fe),
      child: Padding(
        padding: const EdgeInsets.all(20.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(loc.grievanceTrend ?? 'Grievance Trend Over Time',
                style: theme.textTheme.titleMedium?.copyWith(
                  color: Colors.blue.shade800,
                  fontWeight: FontWeight.bold,
                )),
            const SizedBox(height: 16),
            SizedBox(
              height: 240,
              child: totalComplaints.isNotEmpty
                  ? LineChart(
                      LineChartData(
                        gridData: FlGridData(
                          show: true,
                          drawVerticalLine: true,
                          horizontalInterval: 1,
                          verticalInterval: 1,
                          getDrawingHorizontalLine: (value) => FlLine(
                            color: Colors.grey.shade300,
                            strokeWidth: 1,
                          ),
                          getDrawingVerticalLine: (value) => FlLine(
                            color: Colors.grey.shade300,
                            strokeWidth: 1,
                          ),
                        ),
                        titlesData: FlTitlesData(
                          leftTitles: AxisTitles(
                            sideTitles: SideTitles(
                              showTitles: true,
                              reservedSize: 40,
                              getTitlesWidget: (value, meta) {
                                return Padding(
                                  padding: const EdgeInsets.only(right: 8.0),
                                  child: Text(
                                    value.toInt().toString(),
                                    style: TextStyle(
                                      fontSize: 12,
                                      color: Colors.grey.shade600,
                                    ),
                                  ),
                                );
                              },
                            ),
                          ),
                          bottomTitles: AxisTitles(
                            sideTitles: SideTitles(
                              showTitles: true,
                              getTitlesWidget: (value, meta) {
                                const labels = ['Day', 'Week', 'Month', 'Year', 'All'];
                                return Padding(
                                  padding: const EdgeInsets.only(top: 8.0),
                                  child: Text(
                                    labels[value.toInt()],
                                    style: TextStyle(
                                      fontSize: 12,
                                      color: Colors.grey.shade600,
                                    ),
                                  ),
                                );
                              },
                            ),
                          ),
                          topTitles: AxisTitles(sideTitles: SideTitles(showTitles: false)),
                          rightTitles: AxisTitles(sideTitles: SideTitles(showTitles: false)),
                        ),
                        borderData: FlBorderData(
                          show: true,
                          border: Border.all(
                            color: Colors.grey.shade300,
                            width: 1,
                          ),
                        ),
                        minX: 0,
                        maxX: 4,
                        minY: 0,
                        lineBarsData: [
                          LineChartBarData(
                            spots: [
                              FlSpot(0, (totalComplaints['day'] ?? 0).toDouble()),
                              FlSpot(1, (totalComplaints['week'] ?? 0).toDouble()),
                              FlSpot(2, (totalComplaints['month'] ?? 0).toDouble()),
                              FlSpot(3, (totalComplaints['year'] ?? 0).toDouble()),
                              FlSpot(4, (totalComplaints['all'] ?? 0).toDouble()),
                            ],
                            isCurved: true,
                            color: Colors.blue.shade600,
                            barWidth: 4,
                            dotData: FlDotData(
                              show: true,
                              getDotPainter: (spot, percent, barData, index) => FlDotCirclePainter(
                                radius: 4,
                                color: Colors.blue.shade600,
                                strokeWidth: 2,
                                strokeColor: Colors.white,
                              ),
                            ),
                            belowBarData: BarAreaData(
                              show: true,
                              gradient: LinearGradient(
                                colors: [
                                  Colors.blue.shade600.withOpacity(0.3),
                                  Colors.blue.shade100.withOpacity(0.1),
                                ],
                                begin: Alignment.topCenter,
                                end: Alignment.bottomCenter,
                              ),
                            ),
                          ),
                        ],
                      ),
                    )
                  : Center(
                      child: CircularProgressIndicator(
                        color: Colors.blue.shade600,
                      ),
                    ),
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildBarChartCard(ThemeData theme, KpiData kpiData, AppLocalizations loc) {
    final deptWise = kpiData.deptWise ?? {};

    return Card(
      elevation: 2,
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
      color: const Color(0xFFecf2fe),
      child: Padding(
        padding: const EdgeInsets.all(20.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(loc.deptWiseDistribution ?? 'Department-Wise Distribution',
                style: theme.textTheme.titleMedium?.copyWith(
                  color: Colors.blue.shade800,
                  fontWeight: FontWeight.bold,
                )),
            const SizedBox(height: 16),
            SizedBox(
              height: 240,
              child: deptWise.isNotEmpty
                  ? BarChart(
                      BarChartData(
                        alignment: BarChartAlignment.spaceAround,
                        barGroups: _buildBarChartGroups(deptWise),
                        titlesData: FlTitlesData(
                          leftTitles: AxisTitles(
                            sideTitles: SideTitles(
                              showTitles: true,
                              reservedSize: 40,
                              getTitlesWidget: (value, meta) {
                                return Padding(
                                  padding: const EdgeInsets.only(right: 8.0),
                                  child: Text(
                                    value.toInt().toString(),
                                    style: TextStyle(
                                      fontSize: 12,
                                      color: Colors.grey.shade600,
                                    ),
                                  ),
                                );
                              },
                            ),
                          ),
                          bottomTitles: AxisTitles(
                            sideTitles: SideTitles(
                              showTitles: true,
                              getTitlesWidget: (value, meta) {
                                final keys = deptWise.keys.toList();
                                return Padding(
                                  padding: const EdgeInsets.only(top: 8.0),
                                  child: Text(
                                    keys[value.toInt()].capitalize(),
                                    style: TextStyle(
                                      fontSize: 10,
                                      color: Colors.grey.shade600,
                                    ),
                                    maxLines: 2,
                                    overflow: TextOverflow.ellipsis,
                                  ),
                                );
                              },
                            ),
                          ),
                          topTitles: AxisTitles(sideTitles: SideTitles(showTitles: false)),
                          rightTitles: AxisTitles(sideTitles: SideTitles(showTitles: false)),
                        ),
                        borderData: FlBorderData(
                          show: true,
                          border: Border.all(
                            color: Colors.grey.shade300,
                            width: 1,
                          ),
                        ),
                        gridData: FlGridData(
                          show: true,
                          drawVerticalLine: false,
                          horizontalInterval: 1,
                          getDrawingHorizontalLine: (value) => FlLine(
                            color: Colors.grey.shade300,
                            strokeWidth: 1,
                          ),
                        ),
                      ),
                    )
                  : Center(
                      child: CircularProgressIndicator(
                        color: Colors.blue.shade600,
                      ),
                    ),
            ),
          ],
        ),
      ),
    );
  }

  List<BarChartGroupData> _buildBarChartGroups(Map<String, dynamic> deptWise) {
    const colors = [
      Colors.blue,
      Colors.orange,
      Colors.green,
      Colors.red,
      Colors.purple,
      Colors.teal,
      Colors.amber,
      Colors.deepOrange,
    ];
    
    return deptWise.entries.toList().asMap().entries.map((entry) {
      final index = entry.key;
      final dept = entry.value.key;
      final value = entry.value.value is num
          ? (entry.value.value as num).toDouble()
          : double.tryParse(entry.value.value.toString()) ?? 0.0;

      return BarChartGroupData(
        x: index,
        barRods: [
          BarChartRodData(
            toY: value,
            color: colors[index % colors.length],
            width: 20,
            borderRadius: BorderRadius.circular(8),
            backDrawRodData: BackgroundBarChartRodData(
              show: true,
              toY: value * 1.1,
              color: Colors.grey.shade200,
            ),
          ),
        ],
      );
    }).toList();
  }

  Widget _buildSlaCard(ThemeData theme, KpiData kpiData, AppLocalizations loc) {
    final slaMetrics = kpiData.slaMetrics ?? {};

    return Card(
      elevation: 2,
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
      color: const Color(0xFFecf2fe),
      child: Padding(
        padding: const EdgeInsets.all(20.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(loc.slaMetrics ?? 'SLA Metrics',
                style: theme.textTheme.titleMedium?.copyWith(
                  color: Colors.blue.shade800,
                  fontWeight: FontWeight.bold,
                )),
            const SizedBox(height: 16),
            _buildSlaMetricItem(
              loc.slaDays ?? 'SLA Days',
              '${slaMetrics['sla_days'] ?? 7}',
              Icons.calendar_today,
              Colors.blue,
            ),
            const SizedBox(height: 12),
            _buildSlaMetricItem(
              loc.complianceRate ?? 'Compliance Rate',
              '${(slaMetrics['sla_compliance_rate'] ?? 0).toStringAsFixed(2)}%',
              Icons.percent,
              Colors.green,
            ),
            const SizedBox(height: 12),
            _buildSlaMetricItem(
              loc.avgResolutionTime ?? 'Avg Resolution Time',
              '${(slaMetrics['avg_resolution_time_days'] ?? 0).toStringAsFixed(2)} days',
              Icons.timer,
              Colors.orange,
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildSlaMetricItem(String label, String value, IconData icon, Color color) {
    return Container(
      padding: const EdgeInsets.all(16),
      decoration: BoxDecoration(
        color: Colors.white,
        borderRadius: BorderRadius.circular(12),
        boxShadow: [
          BoxShadow(
            color: color.withOpacity(0.1),
            blurRadius: 8,
            offset: const Offset(0, 2),
          ),
        ],
      ),
      child: Row(
        children: [
          Container(
            padding: const EdgeInsets.all(8),
            decoration: BoxDecoration(
              color: color.withOpacity(0.1),
              shape: BoxShape.circle,
            ),
            child: Icon(icon, color: color, size: 20),
          ),
          const SizedBox(width: 16),
          Expanded(
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(label,
                    style: TextStyle(
                      fontSize: 14,
                      color: Colors.grey.shade600,
                      fontWeight: FontWeight.w500,
                    )),
                const SizedBox(height: 4),
                Text(value,
                    style: TextStyle(
                      fontSize: 18,
                      fontWeight: FontWeight.bold,
                      color: color,
                    )),
              ],
            ),
          ),
        ],
      ),
    );
  }

  Widget _buildRecentComplaints(AppLocalizations loc) {
    return FutureBuilder<List<Grievance>>(
      future: _grievancesFuture,
      builder: (context, snapshot) {
        if (snapshot.connectionState == ConnectionState.waiting) {
          return const Center(child: LoadingIndicator());
        } else if (snapshot.hasError) {
          return EmptyState(
            icon: Icons.error,
            title: loc.error,
            message: '${loc.noGrievancesMessage}\n${snapshot.error}',
            actionButton: ElevatedButton(
              onPressed: () {
                setState(() {
                  _grievancesFuture = ref.read(adminProvider.notifier).getAllGrievances();
                });
              },
              child: Text(loc.retry),
            ),
          );
        } else if (!snapshot.hasData || snapshot.data!.isEmpty) {
          return EmptyState(
            icon: Icons.inbox,
            title: loc.noGrievances,
            message: loc.noGrievancesMessage,
          );
        }

        final grievances = snapshot.data!.take(5).toList();
        return ListView.builder(
          shrinkWrap: true,
          physics: const NeverScrollableScrollPhysics(),
          itemCount: grievances.length,
          itemBuilder: (ctx, idx) => Container(
            margin: const EdgeInsets.only(bottom: 12),
            child: GrievanceCard(grievance: grievances[idx]),
          ),
        );
      },
    );
  }

  Widget _buildExportButtons(AppLocalizations loc) {
    return Container(
      padding: const EdgeInsets.all(20),
      decoration: BoxDecoration(
        color: Colors.white,
        borderRadius: BorderRadius.circular(16),
        boxShadow: [
          BoxShadow(
            color: Colors.black.withOpacity(0.1),
            blurRadius: 8,
            offset: const Offset(0, 2),
          ),
        ],
      ),
      child: Column(
        children: [
          Text(
            loc.exportReports ?? 'Export Reports',
            style: TextStyle(
              fontSize: 16,
              fontWeight: FontWeight.bold,
              color: Colors.blue.shade800,
            ),
          ),
          const SizedBox(height: 16),
          Row(
            mainAxisAlignment: MainAxisAlignment.spaceEvenly,
            children: [
              _buildExportButton(
                icon: Icons.picture_as_pdf,
                label: loc.exportPDF ?? 'PDF',
                color: Colors.red,
                onPressed: () => _exportReport('pdf'),
              ),
              _buildExportButton(
                icon: Icons.table_chart,
                label: loc.exportCSV ?? 'CSV',
                color: Colors.green,
                onPressed: () => _exportReport('csv'),
              ),
              _buildExportButton(
                icon: Icons.grid_on,
                label: loc.exportExcel ?? 'Excel',
                color: Colors.blue,
                onPressed: () => _exportReport('excel'),
              ),
            ],
          ),
        ],
      ),
    );
  }

  Widget _buildExportButton({
    required IconData icon,
    required String label,
    required Color color,
    required VoidCallback onPressed,
  }) {
    return Column(
      children: [
        Container(
          width: 60,
          height: 60,
          decoration: BoxDecoration(
            color: color.withOpacity(0.1),
            shape: BoxShape.circle,
            border: Border.all(color: color.withOpacity(0.3), width: 2),
          ),
          child: IconButton(
            icon: Icon(icon, color: color),
            onPressed: onPressed,
          ),
        ),
        const SizedBox(height: 8),
        Text(
          label,
          style: TextStyle(
            fontSize: 12,
            fontWeight: FontWeight.w500,
            color: color,
          ),
        ),
      ],
    );
  }

  Future<void> _exportReport(String format) async {
    final loc = AppLocalizations.of(context)!;
    try {
      final data = await ref
          .read(adminProvider.notifier)
          .generateReport(_selectedPeriod, format);
      final fileName =
          'report_${_selectedPeriod}_$format.${format == 'excel' ? 'xlsx' : format}';

      if (kIsWeb) {
        // Web-specific file download
        final blob = html.Blob([data]);
        final url = html.Url.createObjectUrlFromBlob(blob);
        final anchor = html.AnchorElement(href: url)
          ..setAttribute('download', fileName)
          ..click();
        html.Url.revokeObjectUrl(url);
        ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: Text('${loc.reportExported ?? 'Report exported'}: $fileName'),
              backgroundColor: Colors.green,
            ));
      } else {
        // Mobile/desktop file handling
        final dir = await getTemporaryDirectory();
        final filePath = '${dir.path}/$fileName';
        final file = io.File(filePath);
        await file.writeAsBytes(data);
        await OpenFile.open(filePath);
        ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: Text('${loc.reportExported ?? 'Report exported'}: $fileName'),
              backgroundColor: Colors.green,
            ));
      }
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(
            content: Text('${loc.errorExportingReport ?? 'Error exporting report'}: $e'),
            backgroundColor: Colors.red,
          ));
    }
  }
}

extension StringExtension on String {
  String capitalize() {
    if (isEmpty) return this;
    return "${this[0].toUpperCase()}${substring(1)}";
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\admin\ManageAreasScreen.dart ---
import 'package:flutter/material.dart';
import 'package:main_ui/services/master_data_service.dart';
import 'package:dio/dio.dart';
import 'package:main_ui/models/master_data_model.dart';
import 'package:main_ui/widgets/loading_indicator.dart';

class ManageAreasScreen extends StatefulWidget {
  const ManageAreasScreen({super.key});

  @override
  _ManageAreasScreenState createState() => _ManageAreasScreenState();
}

class _ManageAreasScreenState extends State<ManageAreasScreen> {
  late Future<List<MasterArea>> _areasFuture;

  @override
  void initState() {
    super.initState();
    _areasFuture = MasterDataService.getAreas();
  }

  void _refreshAreas() {
    setState(() {
      _areasFuture = MasterDataService.getAreas();
    });
  }

  void _showAreaDialog({MasterArea? area}) {
    showDialog(
      context: context,
      builder: (context) => AreaFormDialog(onSuccess: _refreshAreas, area: area),
    );
  }

  Future<void> _confirmDeleteArea(MasterArea area) async {
    final confirmed = await showDialog<bool>(
      context: context,
      builder: (context) => AlertDialog(
        title: const Text('Delete Area'),
        content: Text(
            'Are you sure you want to delete "${area.name}"? This might fail if it is being used by any grievances.'),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context, false),
            child: const Text('Cancel'),
          ),
          TextButton(
            onPressed: () => Navigator.pop(context, true),
            child: const Text('Delete', style: TextStyle(color: Colors.red)),
          ),
        ],
      ),
    );

    if (confirmed == true) {
      try {
        await MasterDataService.deleteArea(area.id);
        _refreshAreas();
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(content: Text('Area deleted successfully'), backgroundColor: Colors.green),
        );
      } catch (e) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('Error: $e'), backgroundColor: Colors.red),
        );
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: const Color(0xFFF8FBFF), // soft background
      appBar: AppBar(
        title: const Text(
          'Manage Areas',
          style: TextStyle(fontWeight: FontWeight.bold),
        ),
        elevation: 0,
        backgroundColor: Colors.blue.shade600,
      ),
      /* floatingActionButton: FloatingActionButton(
        backgroundColor: Colors.blue.shade600,
        onPressed: () => _showAreaDialog(),
        child: const Icon(Icons.add),
      ), */
      body: FutureBuilder<List<MasterArea>>(
        future: _areasFuture,
        builder: (context, snapshot) {
          if (snapshot.connectionState == ConnectionState.waiting) {
            return const LoadingIndicator();
          }
          if (snapshot.hasError) {
            return Center(child: Text('Error: ${snapshot.error}'));
          }

          final areas = snapshot.data ?? [];
          if (areas.isEmpty) {
            return const Center(
              child: Text(
                "No areas found",
                style: TextStyle(fontSize: 16, color: Colors.black54),
              ),
            );
          }

          return ListView.builder(
            padding: const EdgeInsets.all(12),
            itemCount: areas.length,
            itemBuilder: (context, index) {
              final area = areas[index];
              return Card(
                color: const Color(0xFFECF2FE), // card background
                elevation: 2,
                shape: RoundedRectangleBorder(
                  borderRadius: BorderRadius.circular(16),
                ),
                margin: const EdgeInsets.symmetric(vertical: 8),
                child: ListTile(
                  contentPadding:
                      const EdgeInsets.symmetric(horizontal: 16, vertical: 12),
                  title: Text(
                    area.name,
                    style: const TextStyle(
                      fontSize: 16,
                      fontWeight: FontWeight.bold,
                      color: Colors.black87,
                    ),
                  ),
                  subtitle: Text(
                    area.description ?? 'No description',
                    style: const TextStyle(color: Colors.black54),
                  ),
                  trailing: Row(
                    mainAxisSize: MainAxisSize.min,
                    children: [
                      /* IconButton(
                        icon: Icon(Icons.edit, color: Colors.blue.shade800),
                        onPressed: () => _showAreaDialog(area: area),
                        tooltip: 'Edit Area',
                      ), */
                      /* IconButton(
                        icon: Icon(Icons.delete, color: Colors.red.shade700),
                        onPressed: () => _confirmDeleteArea(area),
                        tooltip: 'Delete Area',
                      ), */
                    ],
                  ),
                  onTap: () => _showAreaDialog(area: area),
                ),
              );
            },
          );
        },
      ),
    );
  }
}

class AreaFormDialog extends StatefulWidget {
  final VoidCallback onSuccess;
  final MasterArea? area;

  const AreaFormDialog({super.key, required this.onSuccess, this.area});

  @override
  _AreaFormDialogState createState() => _AreaFormDialogState();
}

class _AreaFormDialogState extends State<AreaFormDialog> {
  final _formKey = GlobalKey<FormState>();
  late TextEditingController _nameController;
  late TextEditingController _descriptionController;
  bool _isSubmitting = false;

  @override
  void initState() {
    super.initState();
    _nameController = TextEditingController(text: widget.area?.name ?? '');
    _descriptionController = TextEditingController(text: widget.area?.description ?? '');
  }

  Future<void> _submit() async {
    if (!_formKey.currentState!.validate()) return;

    setState(() {
      _isSubmitting = true;
    });

    try {
      final data = {
        'name': _nameController.text,
        'description': _descriptionController.text,
      };
      if (widget.area == null) {
        await MasterDataService.addArea(data);
      } else {
        await MasterDataService.updateArea(widget.area!.id, data);
      }
      widget.onSuccess();
      Navigator.of(context).pop();
    } catch (e) {
      if (!mounted) return;
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('Failed to save area: $e')),
      );
    } finally {
      if (mounted) {
        setState(() {
          _isSubmitting = false;
        });
      }
    }
  }

  @override
  void dispose() {
    _nameController.dispose();
    _descriptionController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    final isEditing = widget.area != null;
    return AlertDialog(
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
      title: Text(
        isEditing ? 'Edit Area' : 'Add Area',
        style: const TextStyle(fontWeight: FontWeight.bold),
      ),
      content: Form(
        key: _formKey,
        child: Column(
          mainAxisSize: MainAxisSize.min,
          children: [
            TextFormField(
              controller: _nameController,
              decoration: const InputDecoration(
                labelText: 'Area Name',
                border: OutlineInputBorder(),
              ),
              validator: (value) {
                if (value == null || value.isEmpty) {
                  return 'Please enter an area name';
                }
                return null;
              },
            ),
            const SizedBox(height: 12),
            TextFormField(
              controller: _descriptionController,
              decoration: const InputDecoration(
                labelText: 'Description (Optional)',
                border: OutlineInputBorder(),
              ),
            ),
          ],
        ),
      ),
      actions: [
        TextButton(
          onPressed: () => Navigator.of(context).pop(),
          child: const Text('Cancel'),
        ),
        ElevatedButton(
          style: ElevatedButton.styleFrom(
            backgroundColor: Colors.blue.shade600,
            shape: RoundedRectangleBorder(
              borderRadius: BorderRadius.circular(8),
            ),
          ),
          onPressed: _isSubmitting ? null : _submit,
          child: _isSubmitting
              ? const SizedBox(
                  width: 20,
                  height: 20,
                  child: CircularProgressIndicator(
                      strokeWidth: 2, color: Colors.white),
                )
              : Text(isEditing ? 'Update' : 'Add'),
        ),
      ],
    );
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\admin\manage_configs.dart ---
import 'package:dio/dio.dart';
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../../services/api_service.dart';

import '../../l10n/app_localizations.dart';
import '../../widgets/empty_state.dart';
import '../../widgets/custom_button.dart';

// Define a Config model
class Config {
  final String key;
  final String value;

  Config({required this.key, required this.value});

  factory Config.fromJson(Map<String, dynamic> json) {
    return Config(
      key: json['key'] ?? '',
      value: json['value'] ?? '',
    );
  }
}

// AdminNotifier for managing configs
class AdminNotifier extends StateNotifier<AsyncValue<List<Config>>> {
  static final Dio _dio = ApiService.dio;
  AdminNotifier() : super(const AsyncValue.loading()) {
    getConfigs();
  }

  Future<void> getConfigs() async {
    try {
      state = const AsyncValue.loading();
      final response = await _dio.get('/admins/configs');
      final configs = (response.data as List).map((json) => Config.fromJson(json)).toList();
      state = AsyncValue.data(configs);
    } catch (e, stack) {
      state = AsyncValue.error(e, stack);
    }
  }

  Future<void> addConfig(String key, String value) async {
    try {
      state = const AsyncValue.loading();
      await ApiService.post('/admins/configs', {'key': key, 'value': value});
      await getConfigs(); // Refresh configs after adding
    } catch (e, stack) {
      state = AsyncValue.error(e, stack);
    }
  }
}

final adminProvider = StateNotifierProvider<AdminNotifier, AsyncValue<List<Config>>>((ref) => AdminNotifier());

class ManageConfigs extends ConsumerStatefulWidget {
  const ManageConfigs({super.key});

  @override
  ConsumerState<ManageConfigs> createState() => _ManageConfigsState();
}

class _ManageConfigsState extends ConsumerState<ManageConfigs> {
  final TextEditingController _keyController = TextEditingController();
  final TextEditingController _valueController = TextEditingController();

  @override
  void dispose() {
    _keyController.dispose();
    _valueController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    final configsAsync = ref.watch(adminProvider);
    final l10n = AppLocalizations.of(context)!;

    return Scaffold(
      appBar: AppBar(
        title: Text(l10n.settings),
      ),
      body: configsAsync.when(
        data: (configs) => configs.isEmpty
            ? EmptyState(
                icon: Icons.settings_outlined,
                title: l10n.noConfigs, // New localization key
                message: l10n.noConfigsMessage, // New localization key
                actionButton: CustomButton(
                  text: l10n.addConfig, // New localization key
                  onPressed: () => _showAddConfigDialog(context),
                ),
              )
            : ListView.builder(
                padding: const EdgeInsets.all(16.0),
                itemCount: configs.length,
                itemBuilder: (context, index) {
                  final config = configs[index];
                  return Card(
                    child: ListTile(
                      title: Text(config.key, style: Theme.of(context).textTheme.titleMedium),
                      subtitle: Text(config.value, style: Theme.of(context).textTheme.bodyMedium),
                      trailing: IconButton(
                        icon: const Icon(Icons.edit),
                        onPressed: () => _showEditConfigDialog(context, config),
                      ),
                    ),
                  );
                },
              ),
        loading: () => const Center(child: CircularProgressIndicator()),
        error: (error, stack) => EmptyState(
          icon: Icons.error,
          title: l10n.error,
          message: error.toString(),
          actionButton: CustomButton(
            text: l10n.retry,
            onPressed: () => ref.read(adminProvider.notifier).getConfigs(),
          ),
        ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () => _showAddConfigDialog(context),
        child: const Icon(Icons.add),
      ),
    );
  }

  void _showAddConfigDialog(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    _keyController.clear();
    _valueController.clear();

    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text(l10n.addConfig), // New localization key
        content: Column(
          mainAxisSize: MainAxisSize.min,
          children: [
            TextField(
              controller: _keyController,
              decoration: InputDecoration(
                labelText: l10n.configKey, // New localization key
                border: const OutlineInputBorder(),
              ),
            ),
            const SizedBox(height: 16),
            TextField(
              controller: _valueController,
              decoration: InputDecoration(
                labelText: l10n.configValue, // New localization key
                border: const OutlineInputBorder(),
              ),
            ),
          ],
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text(l10n.cancel),
          ),
          CustomButton(
            text: l10n.submit,
            onPressed: () async {
              if (_keyController.text.trim().isEmpty || _valueController.text.trim().isEmpty) {
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text(l10n.configCannotBeEmpty)), // New localization key
                );
                return;
              }
              try {
                await ref.read(adminProvider.notifier).addConfig(
                      _keyController.text.trim(),
                      _valueController.text.trim(),
                    );
                Navigator.pop(context);
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text(l10n.configAddedSuccess)), // New localization key
                );
              } catch (e) {
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text('${l10n.error}: $e')),
                );
              }
            },
          ),
        ],
      ),
    );
  }

  void _showEditConfigDialog(BuildContext context, Config config) {
    final l10n = AppLocalizations.of(context)!;
    _keyController.text = config.key;
    _valueController.text = config.value;

    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text(l10n.editConfig), // New localization key
        content: Column(
          mainAxisSize: MainAxisSize.min,
          children: [
            TextField(
              controller: _keyController,
              decoration: InputDecoration(
                labelText: l10n.configKey,
                border: const OutlineInputBorder(),
              ),
              enabled: false, // Key remains non-editable
            ),
            const SizedBox(height: 16),
            TextField(
              controller: _valueController,
              decoration: InputDecoration(
                labelText: l10n.configValue,
                border: const OutlineInputBorder(),
              ),
            ),
          ],
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text(l10n.cancel),
          ),
          CustomButton(
            text: l10n.update,
            onPressed: () async {
              if (_valueController.text.trim().isEmpty) {
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text(l10n.configValueCannotBeEmpty)), // New localization key
                );
                return;
              }
              try {
                await ref.read(adminProvider.notifier).addConfig(
                      _keyController.text.trim(),
                      _valueController.text.trim(),
                    );
                Navigator.pop(context);
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text(l10n.configUpdatedSuccess)), // New localization key
                );
              } catch (e) {
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text('${l10n.error}: $e')),
                );
              }
            },
          ),
        ],
      ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\admin\manage_subjects.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../../models/master_data_model.dart';
import '../../widgets/custom_button.dart';
import '../../widgets/empty_state.dart';
import '../../services/master_data_service.dart';

class ManageSubjects extends ConsumerStatefulWidget {
  const ManageSubjects({super.key});

  @override
  ConsumerState<ManageSubjects> createState() => _ManageSubjectsState();
}

class _ManageSubjectsState extends ConsumerState<ManageSubjects> {
  void _showSubjectDialog({MasterSubject? subject}) {
    final nameController = TextEditingController(text: subject?.name ?? '');
    final descriptionController = TextEditingController(text: subject?.description ?? '');
    final formKey = GlobalKey<FormState>();

    showDialog(
      context: context,
      builder: (context) {
        return Dialog(
          shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
          child: SingleChildScrollView(
            child: Container(
              padding: const EdgeInsets.all(24),
              decoration: BoxDecoration(
                color: const Color(0xFFf8fbff),
                borderRadius: BorderRadius.circular(16),
              ),
              child: Form(
                key: formKey,
                child: Column(
                  mainAxisSize: MainAxisSize.min,
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      subject == null ? 'Add Subject' : 'Edit Subject',
                      style: const TextStyle(
                        fontSize: 20,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                    const SizedBox(height: 20),
                    TextFormField(
                      decoration: InputDecoration(
                        labelText: 'Name',
                        border: OutlineInputBorder(
                          borderRadius: BorderRadius.circular(8),
                        ),
                        filled: true,
                        fillColor: Colors.white,
                      ),
                      controller: nameController,
                      validator: (value) {
                        if (value == null || value.isEmpty) {
                          return 'Please enter a name';
                        }
                        return null;
                      },
                    ),
                    const SizedBox(height: 16),
                    TextFormField(
                      decoration: InputDecoration(
                        labelText: 'Description',
                        border: OutlineInputBorder(
                          borderRadius: BorderRadius.circular(8),
                        ),
                        filled: true,
                        fillColor: Colors.white,
                      ),
                      controller: descriptionController,
                      maxLines: 3,
                    ),
                    const SizedBox(height: 24),
                    Row(
                      mainAxisAlignment: MainAxisAlignment.end,
                      children: [
                        TextButton(
                          onPressed: () => Navigator.pop(context),
                          child: const Text('Cancel'),
                        ),
                        const SizedBox(width: 12),
                        // FIX: Wrap CustomButton with SizedBox to provide constraints
                        SizedBox(
                          width: 100, // Provide explicit width constraint
                          child: CustomButton(
                            text: 'Save',
                            onPressed: () async {
                              if (formKey.currentState!.validate()) {
                                final data = {
                                  "name": nameController.text.trim(),
                                  "description": descriptionController.text.trim(),
                                };

                                try {
                                  if (subject == null) {
                                    await MasterDataService.addSubject(data);
                                  } else {
                                    await MasterDataService.updateSubject(subject.id, data);
                                  }
                                  ref.invalidate(subjectsProvider); // refresh list
                                  Navigator.pop(context);
                                } catch (e) {
                                  
                                  ScaffoldMessenger.of(context).showSnackBar(
                                    SnackBar(
                                      content: Text('Error: $e'),
                                      backgroundColor: Colors.red,
                                    ),
                                  );
                                }
                              }
                            },
                          ),
                        ),
                      ],
                    ),
                  ],
                ),
              ),
            ),
          ),
        );
      },
    );
  }

  Future<void> _confirmDeleteSubject(MasterSubject subject) async {
    final confirmed = await showDialog<bool>(
      context: context,
      builder: (context) => AlertDialog(
        title: const Text('Delete Subject'),
        content: Text(
            'Are you sure you want to delete "${subject.name}"? This might fail if it is being used by any grievances.'),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context, false),
            child: const Text('Cancel'),
          ),
          TextButton(
            onPressed: () => Navigator.pop(context, true),
            child: const Text('Delete', style: TextStyle(color: Colors.red)),
          ),
        ],
      ),
    );

    if (confirmed == true) {
      try {
        await MasterDataService.deleteSubject(subject.id);
        ref.invalidate(subjectsProvider);
        ScaffoldMessenger.of(context).showSnackBar(
          const SnackBar(
            content: Text('Subject deleted successfully'),
            backgroundColor: Colors.green,
          ),
        );
      } catch (e) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('Error: $e'), backgroundColor: Colors.red),
        );
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    final subjectsAsync = ref.watch(subjectsProvider);
    final theme = Theme.of(context);

    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: const Text(
          'Manage Subjects',
          style: TextStyle(fontWeight: FontWeight.bold),
        ),
        centerTitle: true,
        backgroundColor: theme.colorScheme.primary,
        foregroundColor: theme.colorScheme.onPrimary,
        elevation: 2,
        actions: [
          IconButton(
            icon: const Icon(Icons.add),
            onPressed: () => _showSubjectDialog(),
            tooltip: 'Add New Subject',
          ),
        ],
      ),
      body: subjectsAsync.when(
        loading: () => const Center(
          child: CircularProgressIndicator(),
        ),
        error: (error, stack) => Center(
          child: EmptyState(
            icon: Icons.error_outline,
            title: 'Error Loading Subjects',
            message: error.toString(),
            actionButton: CustomButton(
              text: 'Retry',
              onPressed: () => ref.refresh(subjectsProvider),
              icon: Icons.refresh,
            ),
          ),
        ),
        data: (subjects) {
          if (subjects.isEmpty) {
            return Center(
              child: EmptyState(
                icon: Icons.category,
                title: 'No Subjects',
                message: 'There are no subjects to display. Add a new subject to get started.',
                actionButton: CustomButton(
                  text: 'Add Subject',
                  onPressed: () => _showSubjectDialog(),
                  icon: Icons.add,
                ),
              ),
            );
          }
          return Padding(
            padding: const EdgeInsets.all(16.0),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(
                  'Subjects (${subjects.length})',
                  style: const TextStyle(
                    fontSize: 18,
                    fontWeight: FontWeight.bold,
                    color: Colors.black54,
                  ),
                ),
                const SizedBox(height: 16),
                Expanded(
                  child: ListView.separated(
                    itemCount: subjects.length,
                    separatorBuilder: (context, index) => const SizedBox(height: 12),
                    itemBuilder: (context, index) {
                      final subject = subjects[index];
                      return Container(
                        decoration: BoxDecoration(
                          color: const Color(0xFFecf2fe),
                          borderRadius: BorderRadius.circular(12),
                          boxShadow: [
                            BoxShadow(
                              color: Colors.black.withOpacity(0.05),
                              blurRadius: 4,
                              offset: const Offset(0, 2),
                            ),
                          ],
                        ),
                        child: ListTile(
                          contentPadding: const EdgeInsets.symmetric(
                            horizontal: 16,
                            vertical: 8,
                          ),
                          title: Text(
                            subject.name,
                            style: const TextStyle(
                              fontWeight: FontWeight.w600,
                              fontSize: 16,
                            ),
                          ),
                          subtitle: subject.description != null && subject.description!.isNotEmpty
                              ? Text(
                                  subject.description!,
                                  style: const TextStyle(
                                    color: Colors.black54,
                                  ),
                                  maxLines: 2,
                                  overflow: TextOverflow.ellipsis,
                                )
                              : null,
                          trailing: Row(
                            mainAxisSize: MainAxisSize.min,
                            children: [
                              IconButton(
                                icon: Icon(
                                  Icons.edit,
                                  color: theme.colorScheme.primary,
                                ),
                                onPressed: () => _showSubjectDialog(subject: subject),
                                tooltip: 'Edit Subject',
                              ),
                              IconButton(
                                icon: Icon(
                                  Icons.delete,
                                  color: theme.colorScheme.error,
                                ),
                                onPressed: () => _confirmDeleteSubject(subject),
                                tooltip: 'Delete Subject',
                              ),
                            ],
                          ),
                          onTap: () => _showSubjectDialog(subject: subject),
                        ),
                      );
                    },
                  ),
                ),
              ],
            ),
          );
        },
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () => _showSubjectDialog(),
        backgroundColor: theme.colorScheme.primary,
        foregroundColor: theme.colorScheme.onPrimary,
        child: const Icon(Icons.add),
      ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\admin\manage_users.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/models/user_model.dart';
import 'package:main_ui/utils/validators.dart';
import 'package:main_ui/widgets/custom_button.dart';
import 'package:main_ui/widgets/empty_state.dart';
import 'package:main_ui/widgets/loading_indicator.dart';
import '../../providers/user_provider.dart';

class ManageUsers extends ConsumerStatefulWidget {
  const ManageUsers({super.key});

  @override
  ConsumerState<ManageUsers> createState() => _ManageUsersState();
}

class _ManageUsersState extends ConsumerState<ManageUsers> {
  late TextEditingController _searchController;

  @override
  void initState() {
    super.initState();
    _searchController = TextEditingController();
  }

  @override
  void dispose() {
    _searchController.dispose();
    super.dispose();
  }

  Future<void> _showAddUserDialog() async {
    final l10n = AppLocalizations.of(context)!;
    final formKey = GlobalKey<FormState>();
    String name = '';
    String email = '';
    String phoneNumber = '';
    String password = '';
    String role = 'CITIZEN';
    String? departmentId;

    showDialog(
      context: context,
      builder: (context) => Dialog(
        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
        child: Container(
          decoration: BoxDecoration(
            color: Colors.white,
            borderRadius: BorderRadius.circular(16),
          ),
          child: Padding(
            padding: const EdgeInsets.all(20.0),
            child: Column(
              mainAxisSize: MainAxisSize.min,
              children: [
                Text(
                  l10n.addUser,
                  style: TextStyle(
                    fontSize: 20,
                    fontWeight: FontWeight.bold,
                    color: Colors.blue[800],
                  ),
                ),
                const SizedBox(height: 20),
                SingleChildScrollView(
                  child: Form(
                    key: formKey,
                    child: Column(
                      mainAxisSize: MainAxisSize.min,
                      children: [
                        TextFormField(
                          decoration: InputDecoration(
                            labelText: l10n.name,
                            border: OutlineInputBorder(
                              borderRadius: BorderRadius.circular(12),
                            ),
                            filled: true,
                            fillColor: Colors.grey[50],
                          ),
                          validator: validateRequired,
                          onChanged: (value) => name = value,
                        ),
                        const SizedBox(height: 12),
                        TextFormField(
                          decoration: InputDecoration(
                            labelText: l10n.email,
                            border: OutlineInputBorder(
                              borderRadius: BorderRadius.circular(12),
                            ),
                            filled: true,
                            fillColor: Colors.grey[50],
                          ),
                          validator: validateEmail,
                          onChanged: (value) => email = value,
                        ),
                        const SizedBox(height: 12),
                        TextFormField(
                          decoration: InputDecoration(
                            labelText: l10n.phoneNumber,
                            border: OutlineInputBorder(
                              borderRadius: BorderRadius.circular(12),
                            ),
                            filled: true,
                            fillColor: Colors.grey[50],
                          ),
                          validator: (value) {
                            if (value == null || value.isEmpty) {
                              return l10n.phoneNumberRequired;
                            }
                            if (!RegExp(r'^\+?\d{10,15}$').hasMatch(value)) {
                              return l10n.invalidPhoneNumber;
                            }
                            return null;
                          },
                          onChanged: (value) => phoneNumber = value,
                        ),
                        const SizedBox(height: 12),
                        TextFormField(
                          decoration: InputDecoration(
                            labelText: l10n.password,
                            border: OutlineInputBorder(
                              borderRadius: BorderRadius.circular(12),
                            ),
                            filled: true,
                            fillColor: Colors.grey[50],
                          ),
                          obscureText: true,
                          validator: (value) {
                            if (value == null || value.isEmpty) {
                              return l10n.passwordRequired;
                            }
                            if (value.length < 6) {
                              return l10n.passwordTooShort;
                            }
                            return null;
                          },
                          onChanged: (value) => password = value,
                        ),
                        const SizedBox(height: 12),
                        DropdownButtonFormField<String>(
                          initialValue: role,
                          decoration: InputDecoration(
                            labelText: l10n.role,
                            border: OutlineInputBorder(
                              borderRadius: BorderRadius.circular(12),
                            ),
                            filled: true,
                            fillColor: Colors.grey[50],
                          ),
                          items: const [
                            DropdownMenuItem(value: 'CITIZEN', child: Text('CITIZEN')),
                            DropdownMenuItem(value: 'MEMBER_HEAD', child: Text('SUPERVISOR')),
                            DropdownMenuItem(value: 'FIELD_STAFF', child: Text('FIELD_STAFF')),
                            // DropdownMenuItem(value: 'ADMIN', child: Text('ADMIN')),
                          ],
                          onChanged: (value) => role = value ?? 'CITIZEN',
                          validator: validateRequired,
                        ),
                        const SizedBox(height: 12),
                        TextFormField(
                          decoration: InputDecoration(
                            labelText: 'Department ID (Optional)',
                            border: OutlineInputBorder(
                              borderRadius: BorderRadius.circular(12),
                            ),
                            filled: true,
                            fillColor: Colors.grey[50],
                          ),
                          keyboardType: TextInputType.number,
                          onChanged: (value) => departmentId = value.isEmpty ? null : value,
                        ),
                      ],
                    ),
                  ),
                ),
                const SizedBox(height: 20),
                Row(
                  mainAxisAlignment: MainAxisAlignment.end,
                  children: [
                    TextButton(
                      onPressed: () => Navigator.pop(context),
                      child: Text(l10n.cancel, style: TextStyle(color: Colors.grey[700])),
                    ),
                    const SizedBox(width: 10),
                    SizedBox(
                      width: 100, // Fixed width to avoid layout issues
                      child: CustomButton(
                        text: l10n.add,
                        onPressed: () async {
                          if (formKey.currentState?.validate() ?? false) {
                            try {
                              await ref.read(usersProvider.notifier).addUser({
                                'name': name,
                                'email': email,
                                'phone_number': phoneNumber,
                                'password': password,
                                'role': role,
                                'department_id':
                                    departmentId != null ? int.tryParse(departmentId!) : null,
                              });
                              Navigator.pop(context);
                              ScaffoldMessenger.of(context).showSnackBar(
                                SnackBar(
                                  content: Text(l10n.userAddedSuccess),
                                  backgroundColor: Colors.green,
                                ),
                              );
                            } catch (e) {
                              ScaffoldMessenger.of(context).showSnackBar(
                                SnackBar(
                                  content: Text('${l10n.failedToAddUser}: $e'),
                                  backgroundColor: Colors.red,
                                ),
                              );
                            }
                          }
                        },
                      ),
                    ),
                  ],
                ),
              ],
            ),
          ),
        ),
      ),
    );
  }

  Future<void> _showEditUserDialog(User user) async {
    final l10n = AppLocalizations.of(context)!;
    final formKey = GlobalKey<FormState>();
    String name = user.name ?? "";
    String email = user.email ?? '';
    String phoneNumber = user.phoneNumber ?? '';
    // Normalize role to match dropdown items
    String role = ['CITIZEN', 'MEMBER_HEAD', 'FIELD_STAFF', 'ADMIN']
        .contains(user.role?.toUpperCase())
        ? user.role!.toUpperCase()
        : 'CITIZEN'; // Default to 'CITIZEN' if invalid
    String? departmentId = user.departmentId?.toString();

    showDialog(
      context: context,
      builder: (context) {
        return StatefulBuilder(
          builder: (context, setDialogState) {
            return Dialog(
              shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
              child: Container(
                decoration: BoxDecoration(
                  color: Colors.white,
                  borderRadius: BorderRadius.circular(16),
                ),
                child: Padding(
                  padding: const EdgeInsets.all(20.0),
                  child: Column(
                    mainAxisSize: MainAxisSize.min,
                    children: [
                      Text(
                        l10n.editUser ?? 'Edit User',
                        style: TextStyle(
                          fontSize: 20,
                          fontWeight: FontWeight.bold,
                          color: Colors.blue[800],
                        ),
                      ),
                      const SizedBox(height: 20),
                      SingleChildScrollView(
                        child: Form(
                          key: formKey,
                          child: Column(
                            mainAxisSize: MainAxisSize.min,
                            children: [
                              TextFormField(
                                initialValue: name,
                                decoration: InputDecoration(
                                  labelText: l10n.name,
                                  border: OutlineInputBorder(
                                    borderRadius: BorderRadius.circular(12),
                                  ),
                                  filled: true,
                                  fillColor: Colors.grey[50],
                                ),
                                validator: validateRequired,
                                onChanged: (value) => name = value,
                              ),
                              const SizedBox(height: 12),
                              TextFormField(
                                initialValue: email,
                                decoration: InputDecoration(
                                  labelText: l10n.email,
                                  border: OutlineInputBorder(
                                    borderRadius: BorderRadius.circular(12),
                                  ),
                                  filled: true,
                                  fillColor: Colors.grey[50],
                                ),
                                validator: validateEmail,
                                onChanged: (value) => email = value,
                              ),
                              const SizedBox(height: 12),
                              TextFormField(
                                initialValue: phoneNumber,
                                decoration: InputDecoration(
                                  labelText: l10n.phoneNumber,
                                  border: OutlineInputBorder(
                                    borderRadius: BorderRadius.circular(12),
                                  ),
                                  filled: true,
                                  fillColor: Colors.grey[50],
                                ),
                                validator: (value) {
                                  if (value == null || value.isEmpty) {
                                    return l10n.phoneNumberRequired;
                                  }
                                  if (!RegExp(r'^\+?\d{10,15}$').hasMatch(value)) {
                                    return l10n.invalidPhoneNumber;
                                  }
                                  return null;
                                },
                                onChanged: (value) => phoneNumber = value,
                              ),
                              const SizedBox(height: 12),
                              DropdownButtonFormField<String>(
                                value: role,
                                decoration: InputDecoration(
                                  labelText: l10n.role,
                                  border: OutlineInputBorder(
                                    borderRadius: BorderRadius.circular(12),
                                  ),
                                  filled: true,
                                  fillColor: Colors.grey[50],
                                ),
                                items: const [
                                  DropdownMenuItem(value: 'CITIZEN', child: Text('CITIZEN')),
                                  DropdownMenuItem(value: 'MEMBER_HEAD', child: Text('Supervisor')),
                                  DropdownMenuItem(value: 'FIELD_STAFF', child: Text('FIELD_STAFF')),
                                  // DropdownMenuItem(value: 'ADMIN', child: Text('ADMIN')),
                                ],
                                onChanged: (value) => setDialogState(() {
                                  role = value ?? 'CITIZEN';
                                }),
                                validator: validateRequired,
                              ),
                              const SizedBox(height: 12),
                              TextFormField(
                                initialValue: departmentId,
                                decoration: InputDecoration(
                                  labelText: 'Department ID (Optional)',
                                  border: OutlineInputBorder(
                                    borderRadius: BorderRadius.circular(12),
                                  ),
                                  filled: true,
                                  fillColor: Colors.grey[50],
                                ),
                                keyboardType: TextInputType.number,
                                onChanged: (value) => departmentId = value.isEmpty ? null : value,
                              ),
                            ],
                          ),
                        ),
                      ),
                      const SizedBox(height: 20),
                      Row(
                        mainAxisAlignment: MainAxisAlignment.end,
                        children: [
                          TextButton(
                            onPressed: () => Navigator.pop(context),
                            child: Text(l10n.cancel, style: TextStyle(color: Colors.grey[700])),
                          ),
                          const SizedBox(width: 10),
                          SizedBox(
                            width: 100, // Fixed width to avoid layout issues
                            child: CustomButton(
                              text: l10n.update,
                              onPressed: () async {
                                if (formKey.currentState?.validate() ?? false) {
                                  try {
                                    await ref.read(usersProvider.notifier).updateUser(user.id, {
                                      'id': user.id,
                                      'name': name,
                                      'email': email,
                                      'phone_number': phoneNumber,
                                      'role': role,
                                      'department_id':
                                          departmentId != null ? int.tryParse(departmentId!) : null,
                                    });
                                    Navigator.pop(context);
                                    ScaffoldMessenger.of(context).showSnackBar(
                                      SnackBar(
                                        content: Text(l10n.userUpdatedSuccess),
                                        backgroundColor: Colors.green,
                                      ),
                                    );
                                  } catch (e) {
                                    ScaffoldMessenger.of(context).showSnackBar(
                                      SnackBar(
                                        content: Text('${l10n.failedToUpdateUser}: $e'),
                                        backgroundColor: Colors.red,
                                      ),
                                    );
                                  }
                                }
                              },
                            ),
                          ),
                        ],
                      ),
                    ],
                  ),
                ),
              ),
            );
          },
        );
      },
    );
  }

  Future<void> _confirmDeleteUser(int userId) async {
    final l10n = AppLocalizations.of(context)!;
    final confirmed = await showDialog<bool>(
      context: context,
      builder: (context) => Dialog(
        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
        child: Container(
          decoration: BoxDecoration(
            color: Colors.white,
            borderRadius: BorderRadius.circular(16),
          ),
          padding: const EdgeInsets.all(20),
          child: Column(
            mainAxisSize: MainAxisSize.min,
            children: [
              Icon(Icons.warning_amber_rounded, size: 48, color: Colors.orange[700]),
              const SizedBox(height: 16),
              Text(
                l10n.deleteUser,
                style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
              ),
              const SizedBox(height: 12),
              Text(
                l10n.deleteUserConfirmation,
                textAlign: TextAlign.center,
                style: TextStyle(color: Colors.grey[700]),
              ),
              const SizedBox(height: 20),
              Row(
                mainAxisAlignment: MainAxisAlignment.end,
                children: [
                  TextButton(
                    onPressed: () => Navigator.pop(context, false),
                    child: Text(l10n.cancel, style: TextStyle(color: Colors.grey[700])),
                  ),
                  const SizedBox(width: 10),
                  SizedBox(
                    width: 100, // Fixed width to avoid layout issues
                    child: CustomButton(
                      text: l10n.delete,
                      backgroundColor: Colors.red,
                      onPressed: () => Navigator.pop(context, true),
                    ),
                  ),
                ],
              ),
            ],
          ),
        ),
      ),
    );

    if (confirmed == true) {
      try {
        await ref.read(usersProvider.notifier).deleteUser(userId);
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(
            content: Text(l10n.userDeletedSuccess),
            backgroundColor: Colors.green,
          ),
        );
      } catch (e) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(
            content: Text('${l10n.failedToDeleteUser}: $e'),
            backgroundColor: Colors.red,
          ),
        );
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    final users = ref.watch(usersProvider);

    final theme = Theme.of(context);

    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff), // Set background color
      appBar: AppBar(
        title: Text(l10n.manageUsers),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
        actions: [
          IconButton(
            icon: const Icon(Icons.refresh),
            onPressed: () => ref.read(usersProvider.notifier).fetchUsers(),
            tooltip: l10n.retry,
          ),
        ],
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: _showAddUserDialog,
        backgroundColor: theme.colorScheme.primary,
        tooltip: l10n.addUser,
        child: const Icon(Icons.add, color: Colors.white),
      ),
      body: Column(
        children: [
          Padding(
            padding: const EdgeInsets.all(16.0),
            child: TextField(
              controller: _searchController,
              decoration: InputDecoration(
                hintText: l10n.searchByNameOrEmail,
                prefixIcon: Icon(Icons.search),
                border: OutlineInputBorder(borderRadius: BorderRadius.circular(12)),
                filled: true,
                fillColor: Colors.grey[100],
              ),
              onChanged: (value) => setState(() {}),
            ),
          ),
          Expanded(
            child: users.isEmpty
                ? EmptyState(
                    icon: Icons.people_outline,
                    title: l10n.noUsers,
                    message: l10n.noUsersMessage,
                    actionButton: CustomButton(
                      text: l10n.addUser,
                      onPressed: _showAddUserDialog,
                    ),
                  )
                : _buildUserList(users, _searchController.text),
          ),
        ],
      ),
    );
  }

  Widget _buildUserList(List<User> users, String query) {
    final l10n = AppLocalizations.of(context)!;
    final filteredUsers = users.where((user) {
      final lowerQuery = query.toLowerCase();
      return (user.name?.toLowerCase().contains(lowerQuery) ?? false) ||
             (user.email?.toLowerCase().contains(lowerQuery) ?? false);
    }).toList();

    if (filteredUsers.isEmpty) {
      return EmptyState(
        icon: Icons.search_off,
        title: l10n.noResultsFound,
        message: l10n.noMatchingUsers,
        actionButton: CustomButton(
          text: l10n.retry,
          onPressed: () => _searchController.clear(),
        ),
      );
    }

    return ListView.builder(
      padding: const EdgeInsets.all(16),
      itemCount: filteredUsers.length,
      itemBuilder: (context, index) {
        final user = filteredUsers[index];
        return _buildUserCard(user);
      },
    );
  }

  Widget _buildUserCard(User user) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);

    return Container(
      margin: const EdgeInsets.only(bottom: 12),
      child: Card(
        elevation: 1,
        color: const Color(0xFFecf2fe), // Set card background color
        shape: RoundedRectangleBorder(
          borderRadius: BorderRadius.circular(16),
        ),
        child: ListTile(
          contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
          leading: CircleAvatar(
            backgroundColor: theme.colorScheme.primary,
            child: Text(
              (user.name?.isNotEmpty ?? false) ? user.name![0] : '?',
              style: TextStyle(color: theme.colorScheme.onPrimary),
            ),
          ),
          title: Text(user.name ?? "", 
              style: theme.textTheme.titleMedium?.copyWith(
                fontWeight: FontWeight.w600
              )),
          subtitle: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              const SizedBox(height: 4),
              Text(
                user.email ?? l10n.noEmail,
                style: theme.textTheme.bodySmall?.copyWith(
                  color: Colors.grey[700]
                ),
              ),
              const SizedBox(height: 2),
              Container(
                padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 4),
                decoration: BoxDecoration(
                  color: _getRoleColor(user.role),
                  borderRadius: BorderRadius.circular(12),
                ),
                child: Text(
                  _getDisplayRole(user.role),
                  style: TextStyle(
                    color: Colors.white,
                    fontSize: 12,
                    fontWeight: FontWeight.w500
                  ),
                ),
              ),
            ],
          ),
          trailing: Row(
            mainAxisSize: MainAxisSize.min,
            children: [
              IconButton(
                icon: Icon(Icons.edit, color: Colors.blue[700]),
                onPressed: () => _showEditUserDialog(user),
                tooltip: l10n.editUser,
              ),
              IconButton(
                icon: const Icon(Icons.delete, color: Colors.red),
                onPressed: () => _confirmDeleteUser(user.id),
                tooltip: l10n.deleteUser,
              ),
            ],
          ),
        ),
      ),
    );
  }

  Color _getRoleColor(String? role) {
    switch (role?.toUpperCase()) {
      case 'ADMIN':
        return Colors.red;
      case 'MEMBER_HEAD':
        return Colors.orange;
      case 'FIELD_STAFF':
        return Colors.green;
      case 'CITIZEN':
      
      default:
        return Colors.blue;
    }
  }

  String _getDisplayRole(String? role) {
    if (role == null) return '';
    switch (role.toLowerCase()) {
      case 'member_head':
        return AppLocalizations.of(context)!.roleSupervisor;
      default:
        return role.toUpperCase();
    }
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\admin\reports_screen.dart ---
import 'package:flutter/material.dart';

class ReportsScreen extends StatelessWidget {
  const ReportsScreen({super.key});

  @override
  Widget build(BuildContext context) {
    // Later connect with backend: GET /admin/reports
    final kpis = {
      "Resolution Rate": "82%",
      "SLA Compliance": "76%",
      "Pending Aging": "5 days avg"
    };

    return Scaffold(
      appBar: AppBar(title: const Text("Reports & Analytics")),
      body: Padding(
        padding: const EdgeInsets.all(16.0),
        child: Column(
          children: kpis.entries.map((e) => Card(
            margin: const EdgeInsets.symmetric(vertical: 8),
            child: ListTile(
              title: Text(e.key, style: const TextStyle(fontWeight: FontWeight.bold)),
              trailing: Text(e.value, style: const TextStyle(fontSize: 16)),
            ),
          )).toList(),
        ),
      ),
    );
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\admin\user_history.dart ---
import 'dart:async'; // For debouncing
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../../providers/grievance_provider.dart';
import '../../widgets/grievance_card.dart';
import '../../widgets/empty_state.dart';
import '../../l10n/app_localizations.dart';

class UserHistoryScreen extends ConsumerStatefulWidget {
  final int? userId;
  const UserHistoryScreen({super.key, this.userId});

  @override
  _UserHistoryScreenState createState() => _UserHistoryScreenState();
}

class _UserHistoryScreenState extends ConsumerState<UserHistoryScreen> {
  String _searchText = '';
  final TextEditingController _searchController = TextEditingController();
  Timer? _debounce;

  @override
  void initState() {
    super.initState();
    _searchController.addListener(_onSearchChanged);
  }

  void _onSearchChanged() {
    if (_debounce?.isActive ?? false) _debounce?.cancel();
    _debounce = Timer(const Duration(milliseconds: 300), () {
      setState(() {
        _searchText = _searchController.text;
       
      });
    });
  }

  @override
  void dispose() {
    _searchController.removeListener(_onSearchChanged);
    _searchController.dispose();
    _debounce?.cancel();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);

    if (widget.userId == null) {
      return Scaffold(
        backgroundColor: const Color(0xFFf8fbff),
        appBar: AppBar(
          title: Text(l10n.userHistory),
          backgroundColor: Colors.white,
          elevation: 2,
          shadowColor: Colors.black12,
          foregroundColor: theme.primaryColor,
          centerTitle: true,
        ),
        body: EmptyState(
          icon: Icons.error_outline,
          title: l10n.userNotFound,
          message: l10n.userIdRequired,
        ),
      );
    }

    final history = ref.watch(citizenHistoryProvider(widget.userId!));

    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: Text(
          l10n.userHistory,
          style: const TextStyle(
            fontWeight: FontWeight.w600,
            fontSize: 20,
          ),
        ),
        backgroundColor: Colors.white,
        elevation: 2,
        shadowColor: Colors.black12,
        foregroundColor: theme.primaryColor,
        centerTitle: true,
        shape: const RoundedRectangleBorder(
          borderRadius: BorderRadius.vertical(
            bottom: Radius.circular(12),
          ),
        ),
      ),
      body: SingleChildScrollView( // Added to handle potential overflow
        child: Container(
          decoration: const BoxDecoration(
            gradient: LinearGradient(
              begin: Alignment.topCenter,
              end: Alignment.bottomCenter,
              colors: [
                Color(0xFFf8fbff),
                Color(0xFFe8f1ff),
              ],
            ),
          ),
          child: Column(
            children: [
              // Search Field
              Padding(
                padding: const EdgeInsets.symmetric(horizontal: 16.0, vertical: 8.0),
                child: SizedBox(
                  height: 56.0, // Ensure sufficient height
                  child: TextField(
                    controller: _searchController,
                    decoration: InputDecoration(
                      hintText: l10n.searchByName ?? 'Search by name', // Fallback
                      prefixIcon: const Icon(Icons.search),
                      suffixIcon: _searchText.isNotEmpty
                          ? IconButton(
                              icon: const Icon(Icons.clear),
                              onPressed: () {
                                _searchController.clear();
                                setState(() {
                                  _searchText = '';
                                 
                                });
                              },
                            )
                          : null,
                      border: OutlineInputBorder(
                        borderRadius: BorderRadius.circular(8),
                        borderSide: const BorderSide(color: Colors.blue), // Debug border
                      ),
                      filled: true,
                      fillColor: Colors.white,
                    ),
                  ),
                ),
              ),
              Expanded(
                child: history.when(
                  data: (grievances) {
                    // Filter grievances based on search text
                    final filteredGrievances = grievances.where((grievance) {
                      final name = grievance.citizen?.name?.toLowerCase() ?? '';
                      final searchText = _searchText.toLowerCase();
                      // Debugging print to check data
                     
                      return name.contains(searchText);
                    }).toList();

                    if (filteredGrievances.isEmpty) {
                      return Padding(
                        padding: const EdgeInsets.all(20.0),
                        child: EmptyState(
                          icon: _searchText.isEmpty ? Icons.history_toggle_off : Icons.search_off,
                          title: _searchText.isEmpty ? l10n.noGrievancesFound : l10n.noResultsFound,
                          message: _searchText.isEmpty ? l10n.noGrievancesMessage : l10n.noMatchingGrievances,
                        ),
                      );
                    }

                    return RefreshIndicator(
                      backgroundColor: Colors.white,
                      color: theme.primaryColor,
                      onRefresh: () async {
                        ref.refresh(citizenHistoryProvider(widget.userId!));
                      },
                      child: ListView.builder(
                        padding: const EdgeInsets.all(16),
                        itemCount: filteredGrievances.length,
                        itemBuilder: (context, index) => Container(
                          margin: const EdgeInsets.only(bottom: 16),
                          decoration: BoxDecoration(
                            borderRadius: BorderRadius.circular(16),
                            boxShadow: [
                              BoxShadow(
                                color: Colors.black.withOpacity(0.1),
                                blurRadius: 8,
                                offset: const Offset(0, 2),
                              ),
                            ],
                          ),
                          child: GrievanceCard(grievance: filteredGrievances[index]),
                        ),
                      ),
                    );
                  },
                  loading: () => Center(
                    child: Column(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: [
                        const CircularProgressIndicator(
                          strokeWidth: 3,
                          valueColor: AlwaysStoppedAnimation<Color>(Colors.blue),
                        ),
                        const SizedBox(height: 16),
                        Text(
                          l10n.loading,
                          style: const TextStyle(
                            color: Colors.black54,
                            fontSize: 16,
                          ),
                        ),
                      ],
                    ),
                  ),
                  error: (err, stack) => Padding(
                    padding: const EdgeInsets.all(20.0),
                    child: EmptyState(
                      icon: Icons.error_outline_rounded,
                      title: l10n.error,
                      message: '${l10n.error}: $err',
                    ),
                  ),
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}

=== Folder: screens\auth ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\auth\login_callback.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../../providers/auth_provider.dart';
import '../../l10n/app_localizations.dart';

class LoginCallbackScreen extends ConsumerStatefulWidget {
  const LoginCallbackScreen({super.key});

  @override
  ConsumerState<LoginCallbackScreen> createState() => _LoginCallbackScreenState();
}

class _LoginCallbackScreenState extends ConsumerState<LoginCallbackScreen> {
  @override
  void initState() {
    super.initState();
    WidgetsBinding.instance.addPostFrameCallback((_) {
      _handleCallback();
    });
  }

  Future<void> _handleCallback() async {
    try {
      final uri = Uri.base;
      final token = uri.queryParameters['access_token'];

      if (token != null) {
        // Handle storing the token and updating auth state
        await ref.read(authProvider.notifier).processNewToken(token);

        // Read the final user state
        final user = ref.read(authProvider);

        // Check if the widget is still mounted
        if (!mounted) return;

        if (user != null) {
          
          Navigator.pushReplacementNamed(context, '/${user.role != null ? user.role!.toLowerCase() : 'guest'}/home');
        } else {
          
          Navigator.pushReplacementNamed(context, '/login');
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(
              content: Text(AppLocalizations.of(context)?.authenticationFailed ?? 'Login failed: Could not retrieve user details.'),
            ),
          );
        }
      } else {
        if (!mounted) return;
        
        Navigator.pushReplacementNamed(context, '/login');
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(
            content: Text(AppLocalizations.of(context)?.authenticationFailed ?? 'Login failed: No token received'),
          ),
        );
      }
    } catch (e) {
      if (!mounted) return;
      
      Navigator.pushReplacementNamed(context, '/login');
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text(
            AppLocalizations.of(context)?.error ?? 'An unexpected error occurred: $e',
          ),
        ),
      );
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            const CircularProgressIndicator(),
            const SizedBox(height: 16),
            Text(
              AppLocalizations.of(context)?.loading ?? 'Processing login...',
              style: Theme.of(context).textTheme.bodyLarge,
            ),
          ],
        ),
      ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\auth\login_screen.dart ---
// lib/screens/auth/login_screen.dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/providers/auth_provider.dart';
import 'package:main_ui/utils/validators.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/widgets/custom_button.dart';

class LoginScreen extends ConsumerStatefulWidget {
  const LoginScreen({super.key});

  @override
  ConsumerState<LoginScreen> createState() => _LoginScreenState();
}

class _LoginScreenState extends ConsumerState<LoginScreen> {
  final _formKey = GlobalKey<FormState>();
  bool _isLogin = true;
  bool _isLoading = false;
  bool _obscurePassword = true;
  String _name = '';
  String _email = '';
  String _password = '';
  String _address = '';  // New: for address
  String _phone = '';    // New: for mobile number
  String _voterId = '';  // New: for voter ID

  Future<void> _submit() async {
    if (_formKey.currentState!.validate()) {
      _formKey.currentState!.save();
      setState(() => _isLoading = true);
      
      try {
        if (_isLogin) {
          await ref.read(authProvider.notifier).loginWithEmail(_email, _password);
        } else {
          await ref.read(authProvider.notifier).register(
            _name, 
            _email, 
            _password,
            address: _address,    // Pass new fields
            phoneNumber: _phone,
            voterId: _voterId,
          );
        }
        
        final user = ref.read(authProvider);
        if (user != null) {
          Navigator.pushReplacementNamed(context, '/${user.role}/home');
        } else {
          ScaffoldMessenger.of(context).showSnackBar(
            SnackBar(content: Text(AppLocalizations.of(context)!.authenticationFailed)),
          );
        }
      } catch (e) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('${AppLocalizations.of(context)!.error}: $e')),
        );
      } finally {
        setState(() => _isLoading = false);
      }
    }
  }

  String? validatePhone(String? value, AppLocalizations l10n) {
    if (value == null || value.isEmpty) {
      return l10n.phoneNumberRequired;
    }
    if (!RegExp(r'^\+?[1-9]\d{1,14}$').hasMatch(value)) {
      return l10n.invalidMobileNumber;
    }
    return null;
  }

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);
    final l10n = AppLocalizations.of(context)!;
    
    return Scaffold(
      backgroundColor: const Color(0xFFF8FBFF),
      body: SafeArea(
        child: SingleChildScrollView(
          padding: const EdgeInsets.all(24),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              const SizedBox(height: 40),
              Center(
                child: Text(
                  _isLogin ? l10n.login : l10n.register,
                  textAlign: TextAlign.center,
                  style: theme.textTheme.headlineLarge?.copyWith(
                    fontSize: 32, // adjust as needed
                    fontWeight: FontWeight.bold,
                    color: const Color(0xFF0076FD),
                  ),
                ),
              ),

              const SizedBox(height: 8),
              Text(
                _isLogin 
                  ? l10n.welcomeBack
                  : l10n.createAccountPrompt,
                style: theme.textTheme.bodyMedium?.copyWith(color: theme.colorScheme.onSurface.withOpacity(0.6)),
              ),
              const SizedBox(height: 40),
              
              Form(
                key: _formKey,
                child: Column(
                  children: [
                    if (!_isLogin)
                      Column(
                        children: [
                          TextFormField(
                            decoration: InputDecoration(
                              labelText: l10n.name,
                              prefixIcon: const Icon(Icons.person_outline),
                            ),
                            validator: validateRequired,
                            onSaved: (value) => _name = value!,
                          ),
                          const SizedBox(height: 16),
                          TextFormField(  // New: Address field
                            decoration: InputDecoration(
                              labelText: l10n.address,
                              prefixIcon: Icon(Icons.home_outlined),
                            ),
                            validator: validateRequired,
                            onSaved: (value) => _address = value!,
                          ),
                          const SizedBox(height: 16),
                          TextFormField(  // New: Mobile Number field
                            decoration: InputDecoration(
                              labelText: l10n.phoneNumber,
                              prefixIcon: Icon(Icons.phone_outlined),
                            ),
                            keyboardType: TextInputType.phone,
                            validator: (value) => validatePhone(value, l10n),
                            onSaved: (value) => _phone = value!,
                          ),
                          const SizedBox(height: 16),
                          TextFormField(  // New: Voter ID field
                            decoration: InputDecoration(
                              labelText: l10n.voterId,
                              prefixIcon: Icon(Icons.badge_outlined),
                            ),
                            validator: validateRequired,
                            onSaved: (value) => _voterId = value!,
                          ),
                          const SizedBox(height: 16),
                        ],
                      ),
                    
                    TextFormField(
                      decoration: InputDecoration(
                        labelText: l10n.email,
                        prefixIcon: const Icon(Icons.email_outlined),
                      ),
                      keyboardType: TextInputType.emailAddress,
                      validator: validateEmail,
                      onSaved: (value) => _email = value!,
                    ),
                    const SizedBox(height: 16),
                    
                    TextFormField(
                      decoration: InputDecoration(
                        labelText: l10n.password,
                        prefixIcon: const Icon(Icons.lock_outline),
                        suffixIcon: IconButton(
                          icon: Icon(_obscurePassword ? Icons.visibility_outlined : Icons.visibility_off_outlined),
                          onPressed: () => setState(() => _obscurePassword = !_obscurePassword),
                        ),
                      ),
                      obscureText: _obscurePassword,
                      validator: validateRequired,
                      onSaved: (value) => _password = value!,
                    ),
                    const SizedBox(height: 24),
                    
                    CustomButton(
                      text: _isLogin ? l10n.login : l10n.register,
                      onPressed: _isLoading ? null : _submit,
                      isLoading: _isLoading,
                      fullWidth: true,
                      backgroundColor: const Color(0xFF151a2f),
                    ),
                    const SizedBox(height: 16),
                    
                    Row(
                      mainAxisAlignment: MainAxisAlignment.center,
                      children: [
                        Text(
                          _isLogin ? l10n.registerPrompt : l10n.loginPrompt,
                          style: theme.textTheme.bodyMedium,
                        ),
                        const SizedBox(width: 4),
                        TextButton(
                          onPressed: () {
                            setState(() {
                              _isLogin = !_isLogin;
                              _formKey.currentState?.reset();
                            });
                          },
                          style: TextButton.styleFrom(
                            foregroundColor: const Color(0xFF0076FD),
                          ),
                          child: Text(_isLogin ? l10n.register : l10n.login),
                        ),
                      ],
                    ),
                    
                    // Commented out the OR divider line
                    /*
                    const SizedBox(height: 32),
                    Row(
                      children: [
                        Expanded(child: Divider(color: theme.dividerTheme.color)),
                        Padding(
                          padding: const EdgeInsets.symmetric(horizontal: 16),
                          child: Text(
                            'OR',
                            style: theme.textTheme.bodyMedium
                                ?.copyWith(color: theme.colorScheme.onSurface.withOpacity(0.5)),
                          ),
                        ),
                        Expanded(child: Divider(color: theme.dividerTheme.color)),
                      ],
                    ),
                    const SizedBox(height: 24),
                    */
                    
                    // Commented out the Google login button
                    /*
                    SizedBox(
                      width: double.infinity,
                      child: OutlinedButton.icon(
                        icon: Image.asset('assets/images/google_logo.png', height: 24, width: 24),
                        label: Text(l10n.googleLogin),
                        onPressed: _isLoading ? null : () async {
                          setState(() => _isLoading = true);
                          try {
                            await ref.read(authProvider.notifier).loginWithGoogle();
                          } catch (e) {
                            ScaffoldMessenger.of(context).showSnackBar(
                              SnackBar(content: Text('${l10n.googleLoginFailed}: $e')),
                            );
                          } finally {
                            setState(() => _isLoading = false);
                          }
                        },
                        style: OutlinedButton.styleFrom(
                          padding: const EdgeInsets.symmetric(vertical: 16),
                          side: BorderSide(color: theme.dividerTheme.color!),
                          shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(8)),
                        ),
                      ),
                    )
                    */
                  ],
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\auth\otp_verification_screen.dart ---
import 'package:flutter/material.dart';

class OtpVerificationScreen extends StatefulWidget {
  const OtpVerificationScreen({super.key});

  @override
  State<OtpVerificationScreen> createState() => _OtpVerificationScreenState();
}

class _OtpVerificationScreenState extends State<OtpVerificationScreen> {
  final TextEditingController _otpController = TextEditingController();

  void _verifyOtp() {
    final otp = _otpController.text.trim();
    if (otp.isEmpty) {
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(content: Text("Please enter OTP")),
      );
      return;
    }
    // TODO: Call backend /auth/verify-otp
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text("OTP Verified: $otp")),
    );
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text("OTP Verification")),
      body: Padding(
        padding: const EdgeInsets.all(20.0),
        child: Column(
          children: [
            const Text("Enter the OTP sent to your registered mobile number"),
            const SizedBox(height: 20),
            TextField(
              controller: _otpController,
              decoration: const InputDecoration(
                border: OutlineInputBorder(),
                labelText: "OTP",
              ),
              keyboardType: TextInputType.number,
            ),
            const SizedBox(height: 20),
            ElevatedButton(
              onPressed: _verifyOtp,
              child: const Text("Verify"),
            )
          ],
        ),
      ),
    );
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\auth\splash_screen.dart ---
// lib/screens/auth/splash_screen.dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:lottie/lottie.dart';
import 'package:main_ui/providers/auth_provider.dart';

class SplashScreen extends ConsumerStatefulWidget {
  const SplashScreen({super.key});

  @override
  ConsumerState<SplashScreen> createState() => _SplashScreenState();
}

class _SplashScreenState extends ConsumerState<SplashScreen> {
  @override
  void initState() {
    super.initState();
    _initializeApp();
  }

  Future<void> _initializeApp() async {
    try {
      // Check if user is already authenticated
      await ref.read(authProvider.notifier).checkAuth();
      
      // Add a small delay to show the splash screen
      await Future.delayed(const Duration(milliseconds: 1500));
      
      // Navigate based on authentication status
      final user = ref.read(authProvider);
      
      if (mounted) {
        if (user != null) {
          // User is authenticated, navigate to appropriate home screen
          _navigateBasedOnRole(user.role);
        } else {
          // User is not authenticated, navigate to login
          Navigator.pushReplacementNamed(context, '/login');
        }
      }
    } catch (e) {
      if (mounted) {
        // If there's an error, still navigate to login
        Navigator.pushReplacementNamed(context, '/login');
      }
    }
  }

  void _navigateBasedOnRole(String? role) {
    switch (role?.toUpperCase()) {
      case 'ADMIN':
        Navigator.pushReplacementNamed(context, '/admin/home');
        break;
      case 'MEMBER_HEAD':
        Navigator.pushReplacementNamed(context, '/member_head/home');
        break;
      case 'FIELD_STAFF':
        Navigator.pushReplacementNamed(context, '/field_staff/home');
        break;
      case 'CITIZEN':
      default:
        Navigator.pushReplacementNamed(context, '/citizen/home');
        break;
    }
  }

  // Alternative branded splash screen
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Container(
        decoration: BoxDecoration(
          gradient: LinearGradient(
            begin: Alignment.topCenter,
            end: Alignment.bottomCenter,
            colors: [
              Colors.blue.shade800,
              Colors.blue.shade600,
            ],
          ),
        ),
        child: Stack(
          children: [
            // Background pattern
            Positioned(
              right: -50,
              bottom: -50,
              child: Opacity(
                opacity: 0.1,
                child: Icon(
                  Icons.gavel_rounded,
                  size: 200,
                  color: Colors.white,
                ),
              ),
            ),
            
            Center(
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  // Animated logo container replaced with Lottie animation
                  SizedBox(
                    width: 200, // Adjust size as needed
                    height: 200, // Adjust size as needed
                    child: Lottie.asset(
                      'assets/animations/niwaran.json', // Ensure the JSON file is added to assets/animations/niwaran.json in pubspec.yaml
                      fit: BoxFit.contain,
                      repeat: true, // Set to false if you don't want it to loop
                    ),
                  ),
                  const SizedBox(height: 24),
                  
                  // App title with animation
                  TweenAnimationBuilder(
                    duration: const Duration(milliseconds: 800),
                    tween: Tween<double>(begin: 0, end: 1),
                    builder: (context, double value, child) {
                      return Transform.translate(
                        offset: Offset(0, 20 * (1 - value)),
                        child: Opacity(
                          opacity: value,
                          child: child,
                        ),
                      );
                    },
                    child: Text(
                      'NIVARAN',
                      style: TextStyle(
                        fontSize: 28,
                        fontWeight: FontWeight.bold,
                        color: Colors.white,
                        letterSpacing: 1.2,
                      ),
                    ),
                  ),
                  
                  const SizedBox(height: 8),
                  
                  // Tagline
                  Text(
                    'Easy Solutions for smart punawale',
                    style: TextStyle(
                      fontSize: 16,
                      color: Colors.white.withOpacity(0.9),
                    ),
                  ),
                  
                  const SizedBox(height: 40),
                  
                  // Loading indicator with delayed appearance
                  TweenAnimationBuilder(
                    duration: const Duration(milliseconds: 500),
                    tween: Tween<double>(begin: 0, end: 1),
                    builder: (context, double value, child) {
                      return Opacity(
                        opacity: value,
                        child: child,
                      );
                    },
                    child: CircularProgressIndicator(
                      valueColor: AlwaysStoppedAnimation<Color>(Colors.white),
                      strokeWidth: 3,
                    ),
                  ),
                ],
              ),
            ),
          ],
        ),
      ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\auth\splash_screen2.dart ---
// File: main_ui/lib/screens/auth/splash_screen2.dart
import 'package:webview_flutter/webview_flutter.dart';
import 'package:flutter/material.dart';
import 'dart:io' show Platform;

class Niwaran extends StatefulWidget {
  final double? width;
  final double? height;

  const Niwaran({
    super.key,
    this.width,
    this.height,
  });

  @override
  NiwaranState createState() => NiwaranState();
}

class NiwaranState extends State<Niwaran> {
  final _key = UniqueKey();
  late final WebViewController _svgatorController;

  @override
  void initState() {
    super.initState();
    // Initialize WebViewController
    _svgatorController = WebViewController()
      ..setJavaScriptMode(JavaScriptMode.unrestricted)
      ..setBackgroundColor(Colors.transparent)
      ..loadRequest(Uri.parse('about:blank'));

    // Load HTML after the widget is built
    WidgetsBinding.instance.addPostFrameCallback((_) {
      _loadHtmlFromAssets(_svgatorController);
    });
  }

  Future<void> _loadHtmlFromAssets(WebViewController controller) async {
    try {
      // SVG content (replace with full SVG if truncated)
      String svgContent = '''
<svg id="eI13lcKwgeY1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 300 300" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" project-id="72b0ba56ca7d43f3b12d798b2f76873c" export-id="0bf18e892d9d478eb3ec06150c7b0d78" cached="false">
  <defs>
    <image id="eI13lcKwgeY2" width="91" height="91" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFsAAABbCAYAAAAcNvmZAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAHLUlEQVR4nOWd4ZaiOhCEy9Gdff/Hvauj98dMrUXRHWAlkGCdwwERMX62ne5OwBPW0anw3GOl9+heJUhzX3cK9gFDyNn2W+my8HgFq4s+p3rI+oEx6LcCPxe2Q/5I1q4HgDueoHVbv4i30BzYhKhgz7bmwuMV6H1ioQ4PfQq2ugrCPf+87iKPCVutW0F/yfpmj2ntwMGBl2ArZIK+APhlawJX/w08LZtACfkmy0meP7yVZ7AdNOFy+cQQ9pRlq1VfZf2BIXgeS1d0KEWw3XUQ9KctvzB0I5ll000Q9gXfoP1LuslrDwm8ZNnqNj4B/P5ZIqv2MBAY+uE7hv4+8vUezRwOuMP2zpCwf8tCV1ICTRHUB77hRRFMBjuKy7uWwo46xMh9MBJxSBFsWqae+47h+0Suh9t32e5ekWW7VWegNa4uyVP70i8BGIeBhwGeWTatWpdS5DFHenz2RWmHGmWbXYuw1RUwAuGyBmiVZqTaBg0VH8ECdA7dLTtLYBT0GnLgQJ7e634e16UiN3IOllLU8K9S4I+ftkSJkEPvNhxUN+LRSBSerS238JJlU5rWdyWPRqLK3lR496r4fsDTfdGq1bIdfHfWfcEYZFanrgFapZ1z5k669t9RNJItNeX+m6FnVP/uNhyMOsitALsU+BlPC/7C0KV0Gw5mVT/d3gO6hp+fyC28K3cyNXiwtaJw8I6xS4kSnuYV1UZ0vYcy4FGEovWT5qEvncqwpZhgAdPZ5UmOa1atwvailZYPMuv+QuPZZauwgTw6KYWCTWeXLcMGxsDVf5di7yatu3XYVJRdZul8s+FgD7DnZpfNh4M9wAbm+++mi1W9wKY8u8xi7ybdSU+wo9p3V4MNS2FrArGHptzJF8Z+u5lwMIMdDbi6H8zmidRWFg5m0Ukz2aXOPtXG65Tg0iSaUke0xy/A5xfuDlilsHV+XzQNeCqZyD5czbHLaN4JFrRtU7llR/PvvOLmxXyfVANsAz0DnbnAZmAD8SgNAd6CJQI/58PVci+Ru3Mj2FUsYUYj6D6v+orhRHaHXpp+QK1dL48Gqz0SacbCz8l+rz9Elh1ZdxTnUg54beCu5lyJWjbXnixEQHVx6HNGwWuNCPnnABoCrpYdNTCrP3i2VtoHOa/3D7rvFfkgNeWQ3Qg2DU9LbmRO765fSPTlRNYUdcRrAo/OlVn2plaewaamwqgoLS5FJaXIZ20Ld+1epJqCPVdzY1z96dYCrtJUfffsci3YkUqdks8lXBP4EneyaadZG3b0WAtJ0eTN2u5kt+ikJmwqC/20TBBBr92eyMVV1RawgfEHykBzm8e8otKvJQNeVVvBdpUs2334q+8TbVNvDdsvKVkLeAn6Zq5kS9jZyI6C9i8he92abck68tW1t2UDuWXXcCdrnnOx9oKtcmuOLgOskc7POfeUz1+kPWBn7kQhbw0821c6x2LtbdkOs3Z0wvfx95+bxZYsPTvXX+0NWzUFG1gXeFajmXoOM14btnlP2CXLKN38pSbwKCLK9kcde/GGNa1YdmQpnlXWiCQyi8wARpCza/2bdyNcbxGdZO8bwT0jh3vBeGJTBPvRysRKjuKf8LwFXXZHiBrJDs8VuYsznndt0/FWHYTgZ8DPPt46j/sQBuzWDVjc+CRZa3tSqjSL4sWXJpBwO0bngZx1/O2ABsYNvgL340tWTiQ+MUXpedT33z/acPU1Du2HbL91zhagQ0Mf5b8GbpVa+N9MGJNqZVzKI+XmejQGmwfbwSpboTHNAWbYsN1JpZbt0OvCZzbClcn5EPaSzcyAo2GOkjKG59FB+q3P1BXkZVrW6PybDjs1hpsYAycHU4Wy9Z0J67M2oGhOwk70RZhU+oHPwD8QWzhwPOSjy2AZ3LQPrO3Wdhq3Sc8gbv/9jBtDynkbM4j0KDPVmXuZMqHb2Xd6ja0jTrDtwvLVqk70XAwsvCaQ2mltvnU6hFooK3ayJSmSp9bWrh3hjd89yl/MLxoYOBKeoKtKhWr9PkacvehoBU4rfuveoFdqn1nJdjawAmalvwfnqBp1YOR+l5gZ8rq0bWAe4d4xTdgB929z6YiK+c6245et0QaGdGi6T4ImouWYA9l2cA8+Nmxc+RzuxW0w9ZOcaQeYXttYs6x0eMSeK93uOugj1b3ccUw+hi1r0fYU5o7fSw7zkunGkMTqlv0FcPMMTz3UWG7ZS2p0HknqKAJ2UGH0Yerhwwyk/7E+diBERTvB6g3QIiyzQw4/TSBX5EnLynwnmEDY+A3xIUhDthGf5ThsO8Yf1kKW9elK5pH6h02MASeWab/raJmnX6uzKp9O7vFdKo9679rS0O+qQk0c/58TuvS2R0oFl1PeSTYVJTGZ/9npn7bfyHRZeLqZqLOdrJhR1Q2BySrEFIK0K8IdncxG7I36qiKUnavn0SKBmz/GbI35h0U1Ugyyy5tv9yAd9ScdH1V/Q+UFvNO0ENh2gAAAABJRU5ErkJggg=="/>
    <image id="eI13lcKwgeY7" width="204" height="38" xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMwAAAAmCAYAAACI/XQWAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAgAElEQVR4nLV9eZwcVbX/9y5V1Xv3dM90z0wmmUAChF1A0IAsskMSEBEkCChu8HwPCYvAk01AdkERfQr6BEFkEQSVHUGQAE82gRAJJCwJSSDLZGZ6r6q7/P6oqu6anp6Zjvq7n8/59Cz3njrn3LPdc2/dJvAa8aH1Zx361KHfO2kE4/G24tIt/Vufj5Yx7fC3tn+G1la8/078rfjCOP8V+bbDHf5bu9aKv/X5/642FV0T6cDm4N8c3eoUX+vPrbg0B0CeuCG3XyJG9mHU66wBoiRgu9pe9KPiDa8tdx0ACoDskBDy1591L4qYSAGgAT5XaqzdqJ447sLhF31cygfy4A+yc7qS9DDGNIUmRGkQqTTqNuRBpw/9NOh/z/e78oUsXWgZIAChAIjSgJAaG0bU60f/9/DTLbRuluAeui47K5OgR3IGohSoBqC0huMAH66XT3/5spHXQrRPhZs8cn32k11JejhjIFp7stUa0ApwhMYjL9g/ver28vBmyjegdadMgh7AGahSoJN11gCUgnBctaFq4+Pholp71o3F99YPq+CZAT//qvGQ+6/KFnqz9JuceXMf8AwNuELjvbXyj1++bGQJxupAR+3u72fyA938VIODgvi4lTf/y1fL+07+/sgybN78kyduyB2QjJG9aKD/GkRIjWJFrznszE2/9nFJAOAASDJGDizk6HdjFgH1xa4UULM1fvDtJDnwtE03AnD8B3QyqaQrSc7Opmi/wQFCAKmASk2jUtM1AK/7+Fz41pyMkV3zWXpdIkrAfBpcAYyUlQvgV0H//3vTHf3KvOj5mSTJWgYBIYDWgCuBVFwtAbCv39fpkNYxdBe66Le6M/SMiEVAyRg68Oo77lwApo877J0nxNeXY/+dy9CjLMOTQ9CUAqq2xt47m+uvuh23hXB2YogAgFSMzi1k6XXxkMymakozKF/BFv+8+8OhorrvH++Lu752xcgSAAJNBe5YiVtbX44eX8jRS8L6BHjzVHc0OCOzAPwnmvPUqZGSdIzmu7voJak4AWdNvI4AknE6b3qBHfLhOlmDp1uiA7wkFSOH5HP07IBerQHbBdZvUq8CuCdEp6AACGegMYsgESNIxiiSMYpUnKIrRTGrn3/3v09KbAcgAs/AKCYP+wQAjZgE8WiAjyEZo4hHKVwBC0AUgAGA+f0JJYTGI8GzGVJxb0zEpAAQB2AB4NffVZaOxH2WQZFo9KVIxSiyKbrjd7+c3CFE60RpVVu6d9naoOkEOyadYEjHPdyJKEXEJBACb559Y3E1PIMJ6J4U36/Oz3RlkvTwVJyG5MAa8kjFKPq62RcBxAL+NodezkHjUW+uAplNBek4RVeSIpdm6M2x6bMH+KIDd7deWHxTz7X772Z1hfibap4najSdoAvT/vy18pxOMPRk2YKdZhvZEM8dmjsgNSFRK8DLkYxxpOIcmQRDvovv+ovzMqdhvH5NKkdmUBqzGBI+zkSUIRFl4JwweHPTmHMKABqUMEbBKAOjFJx5YBkMqTiLHrN/7DrLJMGkdkQEpRSsAQSMUlBC4LgwfTxGCA/RIIRS4vf1gXmfvgAaRK9ep++WmoIQCsYoOGcwTYZohGGvna2j4RlM0L/jdu1pmbnxGBuwTA8nYxSEUkhNsXy1etjH2YnTAACy7Uzz89EIs0zDw8c5DQGDZTF0d/E9jzswNojNV1SiNfXkzJgvBw8Ymxg8OhhMgyFiMSTjHNk0J1tNN77147Myf/2vLyRmYKzxbo7RkIeu79k6GeeftCwGw+CN53nAYRoM8ShPLvpi8jA09aBjnl1BKGMUHt9Nfk3DU/g5M61zzjw+NQedOXj/75QwzsAYB2MenZQygDDq42nQSAEQDUpAGAj1IPiZMYZIhKOvx5x7+8W5EzFWESePMpSRAF+AE4RBKMpaGCEAoDUlhDAQysf0B2FAi7f4yvc3/a1cwyohGbRmIISBEgaTc8zoNeeFJqIT427QnE3zYy3DExwhDACD0gx1h6pf/KH6uE9zpwtLkk6aCy2Tg1IDhHCfbQ8o5eCMI2Ia9JgDEp/DWOWZklYAkIpSDy9r4NcwoGDAlRyO5LBFExzJ4UoOqb1+hBpgzIBlmkjGTRRyka2/dmT611tNN9LY/IgHACSfNRdaluHJkHKANIFQDsoMRCyObbeMtPLc0XOkZgTEox3EgCYGQD3ghoFE3IyccGjyWssggZOdigcCGCSMJ/hZa0bQ1KOGwUCDQ/sPDwOoAc5NxKImdp0TP/+kw5Nh7zMpk+Nxer8rMIIWYwFAJMJ9zRAY8PsHiqRHSkpuGKH32JJDgkPBo5UZBjJJa/ai4zLbtjI6xTyQz+4W46lE5PPctABqQlMTkpiwpYG1m+hLj/2ttgFeTtzJgp/cfUXftHjc3JebFgjz8LUCYRYMy8Ss6dH52Lzo5QmCGj4uqwESJuou1xuKbNPaITq0ZqMHa4fo0LphVttUZhitclQdDld5sibMBOMWolELhe7oHj85p/c8ND1rp06HbDNoslQycpxhWCA0Ak0sHyINIDQCbkTR2x3f5zM7x3Itz5jyORqBfni44QOhFhiLIBKJoLcn/unbLx04oVMeNDUAYgLUCoEn11a6OADPsogJUIbGSjeQAgFMSyOdUolvHdNz+W0Pl05GU3Em9rLUAij38BF4KymqoCHaU00NgEYASr0xGl59jY7rrwHIJe+pu2f0m2dHozxI28C4hhVROPBTet6P7hpZgqYCyomEFbQLvta7VzQa6eecgVCCoDpmuxKvLrMf8XkOFpJTFRPIzP7EsRHLpEFaB18EjQ5+jc8wNHJZucOpR3fP+vl9GwOag8Xq5AtWGvXl7MlMa0BqjdGqKA4uWDq/lV7OCdn7E/HMEfukdzroU8nTervNbWIRCk4JKAcMCsRjCjMHzBO23SJy41vv14PqUFB1mrTd8J0Zu8Zj0a0Mk4Mwb95beYYmYFwjGpXmKUcXDl38+vu3+Ty76KTQQCyf76Zu6VA1hVMgBoVdt4ucf+L86pO3Pzj0HsZW48bJVJOo73AotD/3mipoUh9nxF6EoVFoGoemsRaIAywOyhOIRJMY6E8fdOslW3YWSkM4xkKkbXeP6Jb+JAbQ+LiuANSpV659q1iLvObIKBTx6CQsAcNMYHAgfZjBSeCxgygz6TRks8ljzEgC1IwDPA7NEhAkjqobq99w99CT8CY0UMApI0wqlfyiYSVBeAqaJaCoh89FHJLGoWgCmiVAjQRMK4HD9s4f4cu040WwJhFomoCmyQYokoAj4/BprQMoAygCGBVCj/zl5fLKM65f89BeX19x5KoNxvM1GYekCWiWBHgSzEwhkUhnzjl5cAE2by1D8t2ZhWYkBWJ4uBRNQdIkXCQhqfc7eBLESMKMpLDNrOwCn+eOI5mmMWiWhGapBoA2gbAUTCuNVCqT+NaxW1yOTpYRLA6wJMBSPiQ9oIlxXb2Joa0DxgLhKXArhXg8g7m79F0yf5+ePkyVmrEkwNItkPSiSLtG474A0mOBJtvKDYD4eMS829ZJSJqComnAyIBHMshkcjMXnbjF9ugs3JOjD+o1Esmuo4xIBmAZaJaBpCnYKomV69kzb39QK6JpMFNGlz/euMdW8WT2k9zqAngGimYgSBp1mcI7a4w/2yoFSdPQLAPCMzAiXdhyRn6+wWkg006MHGBJT0Y80wDF
      </svg>
      ''';

      // Placeholder for the SVGator player JavaScript (replace with actual player code)
      String playerJs = '''
      // Replace with actual SVGator player JavaScript from _PLAYERS["91c80d77"]
      // Example placeholder (simplified):
      (function() {
        window.__SVGATOR_PLAYER__ = window.__SVGATOR_PLAYER__ || {};
        window.__SVGATOR_PLAYER__["91c80d77"] = {
          play: function() { console.log("Playing SVG animation"); },
          // Add actual animation logic here
        };
      })();
      ''';

      // Combine SVG and JavaScript
      String bodyContent = '$svgContent<script type="text/javascript">${shortenCode(playerJs)}</script>';

      // Wrap in HTML
      String html = wrapPage(bodyContent);

      // Load the HTML string into WebView
      await controller.loadHtmlString(html);
    } catch (e) {
      debugPrint('Error loading SVG animation: $e');
      // Fallback to a static image or placeholder if animation fails
      if (mounted) {
        setState(() {
          // Optionally trigger a rebuild or show a fallback UI
        });
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    return SizedBox(
      width: widget.width,
      height: widget.height,
      child: WebViewWidget(
        key: _key,
        controller: _svgatorController,
      ),
    );
  }

  static String shortenCode(String str) {
    return str
        .replaceAll(RegExp(r'\s{2,}'), '')
        .replaceAllMapped(
          RegExp(r'[\n\r\t\s]*([,{}=;:()?|&])[\n\r\t\s]*'),
          (Match m) => m[1]!,
        )
        .replaceAll(RegExp(r';}'), '}');
  }

  static String wrapPage(String svg) {
    const String header = '''<!doctype html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
      html, body {
        height: 100%;
        overflow: hidden;
        width: 100%;
      }
      body {
        margin: 0;
        padding: 0;
        background: transparent;
      }
      svg {
        height: 100%;
        left: 0;
        position: fixed;
        top: 0;
        width: 100%;
      }
    </style>
  </head>
  <body>
''';
    const String footer = '''
  </body>
</html>''';
    return shortenCode(header) + svg + shortenCode(footer);
  }
}

=== Folder: screens\citizen ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\citizen\edit_grievance.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/models/grievance_model.dart';
import 'package:main_ui/providers/master_data_provider.dart';
import 'package:main_ui/services/grievance_service.dart';
import 'package:main_ui/widgets/custom_button.dart';
import 'package:main_ui/widgets/loading_indicator.dart';

// Provider to fetch a single grievance
final editGrievanceProvider = FutureProvider.family<Grievance, int>((ref, id) {
  return GrievanceService().getGrievanceDetails(id);
});

class EditGrievance extends ConsumerStatefulWidget {
  final int id;
  const EditGrievance({super.key, required this.id});

  @override
  ConsumerState<EditGrievance> createState() => _EditGrievanceState();
}

class _EditGrievanceState extends ConsumerState<EditGrievance> {
  final _formKey = GlobalKey<FormState>();
  final _titleController = TextEditingController();
  final _descriptionController = TextEditingController();
  final _addressController = TextEditingController();

  int? _selectedAreaId;
  int? _selectedSubjectId;

  bool _isSubmitting = false;
  bool _initialDataLoaded = false;

  @override
  void dispose() {
    _titleController.dispose();
    _descriptionController.dispose();
    _addressController.dispose();
    super.dispose();
  }

  void _loadGrievanceData(Grievance grievance) {
    if (!_initialDataLoaded) {
      _titleController.text = grievance.title ?? '';
      _descriptionController.text = grievance.description ?? '';
      _addressController.text = grievance.address ?? '';
      _selectedAreaId = grievance.areaId;
      _selectedSubjectId = grievance.subjectId;
      _initialDataLoaded = true;
    }
  }

  Future<void> _submitUpdate() async {
  if (!_formKey.currentState!.validate() ||
      _selectedAreaId == null ||
      _selectedSubjectId == null) {
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text(AppLocalizations.of(context)!.pleaseFillAllFields ?? 'Please fill all required fields')),
    );
    return;
  }

  setState(() => _isSubmitting = true);

  try {
    // Construct the data map with snake_case keys to match backend
    final Map<String, dynamic> data = {
      'title': _titleController.text.trim(),
      'description': _descriptionController.text.trim(),
      'area_id': _selectedAreaId,
      'subject_id': _selectedSubjectId,
      'address': _addressController.text.trim(),
    };

    // Create an instance of GrievanceService
    final grievanceService = GrievanceService();
    await grievanceService.updateGrievance(widget.id, data);

    if (!mounted) return;
    ScaffoldMessenger.of(context).showSnackBar(
      const SnackBar(
          content: Text('Grievance updated successfully'),
          backgroundColor: Colors.green),
    );
    Navigator.of(context).pop(true); // Pop with a result to indicate success
  } catch (e) {
    if (!mounted) return;
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(
          content: Text('Failed to update: $e'), backgroundColor: Colors.red),
    );
  } finally {
    if (mounted) {
      setState(() => _isSubmitting = false);
    }
  }
}

  @override
  Widget build(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);
    final grievanceAsync = ref.watch(editGrievanceProvider(widget.id));

    return Scaffold(
      appBar: AppBar(title: Text(l10n.editGrievance ?? 'Edit Grievance')),
      body: grievanceAsync.when(
        loading: () => const Center(child: LoadingIndicator()),
        error: (err, stack) =>
            Center(child: Text('Error loading grievance: $err')),
        data: (grievance) {
          _loadGrievanceData(grievance);

          final areasAsync = ref.watch(areasProvider);
          final subjectsAsync = ref.watch(subjectsProvider);

          return SingleChildScrollView(
            padding: const EdgeInsets.all(16),
            child: Form(
              key: _formKey,
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  TextFormField(
                    controller: _titleController,
                    decoration: InputDecoration(
                      labelText: l10n.title ?? 'Title',
                      border: const OutlineInputBorder(),
                    ),
                    validator: (value) =>
                        value?.isEmpty ?? true ? (l10n.titleRequired ?? 'Title is required') : null,
                  ),
                  const SizedBox(height: 16),
                  TextFormField(
                    controller: _descriptionController,
                    decoration: InputDecoration(
                      labelText: l10n.description ?? 'Description',
                      border: const OutlineInputBorder(),
                    ),
                    maxLines: 4,
                    validator: (value) =>
                        value?.isEmpty ?? true ? (l10n.descriptionRequired ?? 'Description is required') : null,
                  ),
                  const SizedBox(height: 16),
                  areasAsync.when(
                    data: (areas) => DropdownButtonFormField<int>(
                      value: _selectedAreaId,
                      decoration: InputDecoration(
                        labelText: l10n.filterByArea ?? 'Area',
                        border: const OutlineInputBorder(),
                      ),
                      items: areas
                          .map((area) => DropdownMenuItem(
                                value: area.id,
                                child: Text(area.name),
                              ))
                          .toList(),
                      onChanged: (value) => setState(() => _selectedAreaId = value),
                      validator: (value) =>
                          value == null ? (l10n.areaRequired ?? 'Area is required') : null,
                    ),
                    loading: () => const LoadingIndicator(),
                    error: (e, s) => Text('Error: $e'),
                  ),
                  const SizedBox(height: 16),
                  subjectsAsync.when(
                    data: (subjects) => DropdownButtonFormField<int>(
                      value: _selectedSubjectId,
                      decoration: InputDecoration(
                        labelText: l10n.filterBySubject ?? 'Subject',
                        border: const OutlineInputBorder(),
                      ),
                      items: subjects
                          .map((subject) => DropdownMenuItem(
                                value: subject.id,
                                child: Text(subject.name),
                              ))
                          .toList(),
                      onChanged: (value) =>
                          setState(() => _selectedSubjectId = value),
                      validator: (value) =>
                          value == null ? (l10n.subjectRequired ?? 'Subject is required') : null,
                    ),
                    loading: () => const LoadingIndicator(),
                    error: (e, s) => Text('Error: $e'),
                  ),
                  const SizedBox(height: 16),
                  TextFormField(
                    controller: _addressController,
                    decoration: const InputDecoration(
                      labelText: 'Address (optional)',
                      border: OutlineInputBorder(),
                    ),
                    maxLines: 2,
                  ),
                  const SizedBox(height: 24),
                  CustomButton(
                    text: l10n.submit ?? 'Submit',
                    isLoading: _isSubmitting,
                    onPressed: _submitUpdate,
                    fullWidth: true,
                  ),
                ],
              ),
            ),
          );
        },
      ),
    );
  } 
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\citizen\grievance_detail.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:intl/intl.dart';
import 'package:main_ui/models/workproof_model.dart';
import 'package:file_picker/file_picker.dart';
import 'package:url_launcher/url_launcher.dart';
import '../../models/grievance_model.dart';
import '../../models/user_model.dart';
import '../../models/comment_model.dart';
import '../../services/grievance_service.dart';
import '../../widgets/status_badge.dart';
import '../../widgets/comment_tile.dart';
import '../../l10n/app_localizations.dart';
import '../../widgets/empty_state.dart';
import '../../widgets/custom_button.dart';
import '../../services/api_service.dart'; // Import ApiService for baseUrl
import '../../providers/user_provider.dart';
import 'package:main_ui/utils/constants.dart';
// Provider for grievance details
final grievanceProvider = FutureProvider.family<Grievance, int>((ref, id) async {
  return await GrievanceService().getGrievanceDetails(id);
});

class GrievanceDetail extends ConsumerStatefulWidget {
  final int id;

  const GrievanceDetail({super.key, required this.id});

  @override
  ConsumerState<GrievanceDetail> createState() => _GrievanceDetailState();
}

class _GrievanceDetailState extends ConsumerState<GrievanceDetail> {
  final TextEditingController _feedbackController = TextEditingController();
  final TextEditingController _commentController = TextEditingController();
  int? _rating;
  List<PlatformFile> _selectedFiles = [];

  @override
  void dispose() {
    _feedbackController.dispose();
    _commentController.dispose();
    super.dispose();
  }

  Future<void> _launchURL(String path) async {
    final String url = '${Constants.baseUrl}/uploads/$path';
    final Uri uri = Uri.parse(url);
    if (!await launchUrl(uri, mode: LaunchMode.externalApplication)) {
      if (mounted) {
        final l10n = AppLocalizations.of(context)!;
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text(l10n.couldNotLaunchUrl(url))),
        );
      }
    }
  }

  Future<void> _addComment() async {
    if (_commentController.text.isEmpty) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text(AppLocalizations.of(context)!.commentCannotBeEmpty),
        ),
      );
      return;
    }
    
    try {
      await GrievanceService().addComment(widget.id, _commentController.text, attachments: _selectedFiles);
      _commentController.clear();
      setState(() {
        _selectedFiles = [];
      });
      ref.refresh(grievanceProvider(widget.id));
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text(AppLocalizations.of(context)!.commentAddedSuccess),
        ),
      );
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('${AppLocalizations.of(context)!.failedToAddComment}: $e'),
        ),
      );
    }
  }

  Future<void> _deleteGrievance() async {
    final l10n = AppLocalizations.of(context)!;
    try {
      await GrievanceService().deleteGrievance(widget.id);
      if (!mounted) return;
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text(l10n.grievanceDeletedSuccessfully ?? 'Grievance deleted successfully'),
          backgroundColor: Colors.green,
        ),
      );
      Navigator.of(context).pop(true); // Pop with a result to indicate success
    } catch (e) {
      if (!mounted) return;
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('${l10n.failedToDeleteGrievance}: $e')),
      );
    }
  }

  void _onMenuSelected(String value) {
    final l10n = AppLocalizations.of(context)!;
    if (value == 'edit') {
      // The route '/citizen/edit' is not defined in your routes.dart.
      // Assuming you have an EditGrievance screen.
      // Navigator.push(context, MaterialPageRoute(builder: (context) => EditGrievance(id: widget.id))).then((_) {
      Navigator.pushNamed(context, '/citizen/edit', arguments: widget.id).then((result) {
        // Refresh data after returning from the edit screen
        ref.refresh(grievanceProvider(widget.id));
      });
    } else if (value == 'delete') {
      showDialog(
        context: context,
        builder: (dialogContext) => AlertDialog(
          title: Text(l10n.confirmDelete),
          content: Text(l10n.areYouSureDeleteGrievance),
          actions: [
            TextButton(
              onPressed: () => Navigator.of(dialogContext).pop(),
              child: Text(l10n.cancel),
            ),
            ElevatedButton(
              onPressed: () {
                Navigator.of(dialogContext).pop();
                _deleteGrievance();
              },
              style: ElevatedButton.styleFrom(backgroundColor: Colors.red),
              child: Text(l10n.delete),
            ),
          ],
        ),
      );
    }
  }

  @override
  Widget build(BuildContext context) {
    final grievanceAsync = ref.watch(grievanceProvider(widget.id));
    final theme = Theme.of(context);
    final l10n = AppLocalizations.of(context)!;
    final currentUser = ref.watch(userNotifierProvider);

    return Scaffold(
      appBar: AppBar(
        title: Text(l10n.grievanceDetails),
        actions: [
          // Show menu only if user is the owner (citizen) or admin
          if (currentUser != null &&
              (grievanceAsync.value?.citizenId == currentUser.id ||
                  currentUser.role?.toLowerCase() == 'admin'))
            PopupMenuButton<String>( // Already localized
              onSelected: _onMenuSelected,
              itemBuilder: (context) => [
                PopupMenuItem(value: 'edit', child: Text(l10n.edit)),
                PopupMenuItem(value: 'delete', child: Text(l10n.delete)),
              ],
            )
        ],
      ),
      body: grievanceAsync.when(
        data: (grievance) => _buildGrievanceDetail(theme, l10n, grievance, currentUser),
        loading: () => const Center(child: CircularProgressIndicator()),
        error: (error, stack) => EmptyState(
          icon: Icons.error,
          title: l10n.error,
          message: l10n.failedToLoadGrievance,
        ),
      ),
    );
  }

  Widget _buildGrievanceDetail(
    ThemeData theme,
    AppLocalizations l10n,
    Grievance grievance,
    User? currentUser,
  ) {
    return Column(
      children: [
        // Grievance details section
        Expanded(
          child: SingleChildScrollView(
            padding: const EdgeInsets.all(16.0),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                // Header section with title and status
                Card(
                  color: const Color(0xFFecf2fe), 
                  elevation: 2,
                  shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
                  child: Padding(
                    padding: const EdgeInsets.all(16.0),
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        Text(
                          grievance.title,
                          style: theme.textTheme.headlineSmall?.copyWith(
                            fontWeight: FontWeight.bold,
                          ),
                        ),
                        const SizedBox(height: 12),
                        Row(
                          children: [
                            StatusBadge(status: grievance.status ?? 'Unknown'),
                            const Spacer(),
                            IconButton(
                              icon: const Icon(Icons.refresh),
                              onPressed: () {
                                ref.invalidate(grievanceProvider(widget.id));
                              },
                              tooltip: l10n.refresh,
                            ),
                          ],
                        ),
                      ],
                    ),
                  ),
                ),
                
                const SizedBox(height: 16),
                
                // Details section
                Card(
                  color: const Color(0xFFecf2fe), 
                  elevation: 2,
                  shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
                  child: Padding(
                    padding: const EdgeInsets.all(16.0),
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        Text(
                          l10n.details,
                          style: theme.textTheme.titleLarge?.copyWith(
                            fontWeight: FontWeight.w600,
                          ),
                        ),
                        const SizedBox(height: 12),
                        
                        _buildDetailRow(theme, l10n.description, grievance.description),

                        if (grievance.citizen != null)
                          _buildDetailRow(theme, l10n.citizenName, grievance.citizen!.name ?? 'N/A'),

                        if (grievance.citizenId != null)
                          _buildDetailRow(theme, l10n.citizenId, grievance.citizenId.toString()),
                        
                        if (grievance.subject != null)
                          _buildDetailRow(theme, l10n.filterBySubject, grievance.subject!.name),
                        
                        if (grievance.area != null)
                          _buildDetailRow(theme, l10n.filterByArea, grievance.area!.name),
                        
                        if (grievance.priority != null)
                          _buildDetailRow(theme, l10n.filterByPriority, grievance.priority?.toString() ?? 'medium'),
                        
                        _buildDetailRow(
                          theme, 
                          l10n.created,
                          DateFormat('MMM dd, yyyy - HH:mm').format(grievance.createdAt)
                        ),
                        
                        if (grievance.updatedAt != grievance.createdAt)
                          _buildDetailRow(
                            theme, 
                            l10n.lastUpdated,
                            DateFormat('MMM dd, yyyy - HH:mm').format(grievance.updatedAt)
                          ),
                        
                        if (grievance.assignee != null)
                          _buildDetailRow(theme, l10n.assignedToLabel, grievance.assignee!.name ?? ""),
                      ],
                    ),
                  ),
                ),
                
                // Attachments section
                if (grievance.attachments != null && grievance.attachments!.isNotEmpty) ...[
                  const SizedBox(height: 16),
                  Card(
                    color: const Color(0xFFecf2fe), 
                    elevation: 2,
                    shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
                    child: Padding(
                      padding: const EdgeInsets.all(16.0),
                      child: Column(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          Text(
                            l10n.attachments,
                            style: theme.textTheme.titleLarge?.copyWith(
                              fontWeight: FontWeight.w600,
                            ),
                          ),
                          const SizedBox(height: 8),

                          // Show file previews
                          Column(
                            children: grievance.attachments!.map((attachment) {
                              final fileName = attachment.filePath.split('/').last;
                              final isImage = fileName.endsWith('.jpg') ||
                                              fileName.endsWith('.jpeg') ||
                                              fileName.endsWith('.png');

                              return GestureDetector(
                                onTap: () {
                                  _launchURL(attachment.filePath);
                                },
                                child: Card(
                                  margin: const EdgeInsets.symmetric(vertical: 6),
                                  child: Padding(
                                    padding: const EdgeInsets.all(8.0),
                                    child: Row(
                                      children: [
                                        isImage
                                            ? Image.network(
                                                '${Constants.baseUrl}/uploads/${attachment.filePath}', // Prepend base URL and /uploads/
                                                width: 60,
                                                height: 60,
                                                fit: BoxFit.cover,
                                                errorBuilder: (context, error, stackTrace) =>
                                                    const Icon(Icons.broken_image, size: 40),
                                              )
                                            : const Icon(Icons.insert_drive_file, size: 40),
                                        const SizedBox(width: 12),
                                        Expanded(
                                          child: Text(fileName,
                                              style: theme.textTheme.bodyMedium),
                                        ),
                                        const Icon(Icons.open_in_new, size: 20),
                                      ],
                                    ),
                                  ),
                                ),
                              );
                            }).toList(),
                          ),
                        ],
                      ),
                    ),
                  ),
                ],
                
                // Workproofs section
                if (grievance.workproofs != null && grievance.workproofs!.isNotEmpty) ...[
                  const SizedBox(height: 16),
                  Card(
                    color: const Color(0xFFecf2fe),
                    elevation: 2,
                    shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
                    child: Padding(
                      padding: const EdgeInsets.all(16.0),
                      child: Column(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          Text(
                            'Work Proofs',
                            style: theme.textTheme.titleLarge?.copyWith(
                              fontWeight: FontWeight.w600,
                            ),
                          ),
                          const SizedBox(height: 12),
                          ...grievance.workproofs!.map((workproof) {
                            return _buildWorkproofCard(theme, workproof);
                          }),
                        ],
                      ),
                    ),
                  ),
                ],

                // Comments section
                const SizedBox(height: 16),
                Card(
                  color: const Color(0xFFecf2fe), 
                  elevation: 2,
                  shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
                  child: Padding(
                    padding: const EdgeInsets.all(16.0),
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        Text(
                          l10n.comments,
                          style: theme.textTheme.titleLarge?.copyWith(
                            fontWeight: FontWeight.w600,
                          ),
                        ),
                        const SizedBox(height: 12),
                        
                        if (grievance.comments != null && grievance.comments!.isNotEmpty)
                          ...grievance.comments!.map((comment) {
                            return CommentTile(comment: comment);
                          })
                        else
                          EmptyState(
                            icon: Icons.comment,
                            title: l10n.noComments,
                            message: l10n.noCommentsMessage,
                          ),
                      ],
                    ),
                  ),
                ),
                
                // --- Conditional Feedback Section ---

                // Show feedback form to the CITIZEN OWNER if the grievance is resolved and feedback is NOT yet given.
                if (grievance.status?.toLowerCase() == 'resolved' &&
                    grievance.feedbackRating == null &&
                    currentUser?.role == 'citizen' &&
                    grievance.citizenId == currentUser?.id) ...[
                  const SizedBox(height: 16),
                  Card(
                    color: const Color(0xFFecf2fe), 
                    elevation: 2,
                    shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
                    child: Padding(
                      padding: const EdgeInsets.all(16.0),
                      child: Column(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          Text(
                            l10n.submitFeedback,
                            style: theme.textTheme.titleLarge?.copyWith(
                              fontWeight: FontWeight.w600,
                            ),
                          ),
                          const SizedBox(height: 12),
                          
                          Text(
                            l10n.selectRating,
                            style: theme.textTheme.bodyMedium,
                          ),
                          const SizedBox(height: 8),
                          
                          Wrap(
                            spacing: 8,
                            children: List.generate(5, (index) {
                              final rating = index + 1;
                              return ChoiceChip(
                                label: Text('$rating'),
                                selected: _rating == rating,
                                onSelected: (selected) {
                                  setState(() {
                                    _rating = selected ? rating : null;
                                  });
                                },
                              );
                            }),
                          ),
                          
                          const SizedBox(height: 16),
                          
                          TextField(
                            controller: _feedbackController,
                            decoration: InputDecoration(
                              labelText: l10n.feedback,
                              border: const OutlineInputBorder(),
                              filled: true,
                            ),
                            maxLines: 3,
                          ),
                          
                          const SizedBox(height: 16),
                          
                          CustomButton(
                            text: l10n.submit,
                            onPressed: () async {
                              if (_rating == null) {
                                ScaffoldMessenger.of(context).showSnackBar(
                                  SnackBar(
                                    content: Text(l10n.pleaseProvideRating),
                                  ),
                                );
                                return;
                              }
                              
                              try {
                                await GrievanceService().submitFeedback(
                                  widget.id,
                                  _rating!,
                                  _feedbackController.text,
                                );
                                
                                ScaffoldMessenger.of(context).showSnackBar(
                                  SnackBar(
                                    content: Text(l10n.feedbackSubmitted),
                                    backgroundColor: Colors.green,
                                  ),
                                );
                                
                                _feedbackController.clear();
                                setState(() {
                                  _rating = null;
                                });
                              } catch (e) {
                                ScaffoldMessenger.of(context).showSnackBar(
                                  SnackBar(
                                    content: Text('${l10n.error}: $e'),
                                    backgroundColor: Colors.red,
                                  ),
                                );
                              }
                            },
                            icon: Icons.send,
                            fullWidth: true,
                          ),
                        ],
                      ),
                    ),
                  ),
                ],

                // Show submitted feedback info to ADMINS, SUPERVISORS, or the original CITIZEN if feedback has been given.
                if (grievance.feedbackRating != null && grievance.feedbackRating! > 0 &&
                    (currentUser?.role == 'admin' ||
                     currentUser?.role == 'member_head' ||
                     (currentUser?.role == 'citizen' && grievance.citizenId == currentUser?.id))) ...[
                  const SizedBox(height: 16),
                  Card(
                    color: const Color(0xFFecf2fe),
                    elevation: 2,
                    shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
                    child: Padding(
                      padding: const EdgeInsets.all(16.0),
                      child: Column(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          Text(
                            l10n.submittedFeedback,
                            style: theme.textTheme.titleLarge?.copyWith(
                              fontWeight: FontWeight.w600,
                            ),
                          ),
                          const SizedBox(height: 12),
                          _buildDetailRow(
                            theme,
                            l10n.rating,
                            '${'⭐' * grievance.feedbackRating!} (${grievance.feedbackRating}/5)',
                          ),
                          if (grievance.feedbackText != null && grievance.feedbackText!.isNotEmpty)
                            _buildDetailRow(theme, l10n.feedbackComments, grievance.feedbackText!),
                        ],
                      ),
                    ),
                  ),
                ],
              ],
            ),
          ),
        ),
        
        // Add comment section
        Container(
          padding: const EdgeInsets.all(16.0),
          decoration: BoxDecoration(
            color: Theme.of(context).cardColor,
            border: Border(top: BorderSide(color: Theme.of(context).dividerColor)),
          ),
          child: Column(
            mainAxisSize: MainAxisSize.min,
            children: [
              if (_selectedFiles.isNotEmpty)
                SizedBox(
                  height: 50,
                  child: ListView(
                    scrollDirection: Axis.horizontal,
                    children: _selectedFiles.map((file) => Padding(
                      padding: const EdgeInsets.symmetric(horizontal: 4.0),
                      child: Chip(
                        label: Text(file.name, overflow: TextOverflow.ellipsis),
                        onDeleted: () {
                          setState(() {
                            _selectedFiles.remove(file);
                          });
                        },
                      ),
                    )).toList(),
                  ),
                ),
              Row(
                children: [
                  Expanded(
                    child: TextField(
                      controller: _commentController,
                      decoration: InputDecoration(
                        hintText: l10n.addComment,
                        border: const OutlineInputBorder(),
                      ),
                    ),
                  ),
                  const SizedBox(width: 8),
                  IconButton(
                    icon: const Icon(Icons.attach_file),
                    onPressed: () async {
                      final result = await FilePicker.platform.pickFiles(allowMultiple: true);
                      if (result != null) {
                        setState(() => _selectedFiles.addAll(result.files));
                      }
                    },
                  ),
                  IconButton(
                    icon: const Icon(Icons.send),
                    onPressed: _addComment,
                  ),
                ],
              ),
            ],
          ),
        ),
      ],
    );
  }

  Widget _buildDetailRow(ThemeData theme, String label, String value) {
    return Padding(
      padding: const EdgeInsets.symmetric(vertical: 8.0),
      child: Row(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          SizedBox(
            width: 100,
            child: Text(
              '$label:',
              style: theme.textTheme.bodyMedium?.copyWith(
                fontWeight: FontWeight.w600,
              ),
            ),
          ),
          const SizedBox(width: 8),
          Expanded(
            child: Text(
              value,
              style: theme.textTheme.bodyMedium,
            ),
          ),
        ],
      ),
    );
  }

  Widget _buildWorkproofCard(ThemeData theme, Workproof workproof) {
    final fileName = workproof.filePath.split('/').last;
    final isImage = fileName.endsWith('.jpg') || fileName.endsWith('.jpeg') || fileName.endsWith('.png');

    return Card(
      margin: const EdgeInsets.symmetric(vertical: 8),
      elevation: 1,
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(10)),
      child: Padding(
        padding: const EdgeInsets.all(12.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            GestureDetector(
              onTap: () => _launchURL(workproof.filePath),
              child: Row(
                children: [
                  isImage
                      ? ClipRRect(
                          borderRadius: BorderRadius.circular(8),
                          child: Image.network(
                            '${Constants.baseUrl}/uploads/${workproof.filePath}',
                            width: 60,
                            height: 60,
                            fit: BoxFit.cover,
                            errorBuilder: (context, error, stackTrace) =>
                                const Icon(Icons.broken_image, size: 40),
                          ),
                        )
                      : const Icon(Icons.insert_drive_file, size: 40),
                  const SizedBox(width: 12),
                  Expanded(
                    child: Text(fileName, style: theme.textTheme.bodyMedium),
                  ),
                  const Icon(Icons.open_in_new, size: 20),
                ],
              ),
            ),
            const Divider(height: 20),
            if (workproof.notes != null && workproof.notes!.isNotEmpty) ...[
              Text(
                'Notes:',
                style: theme.textTheme.bodyMedium?.copyWith(fontWeight: FontWeight.bold),
              ),
              const SizedBox(height: 4),
              Text(workproof.notes!, style: theme.textTheme.bodyMedium),
              const SizedBox(height: 8),
            ],
            Text(
              'Uploaded by: ${workproof.uploader?.name ?? 'Unknown'} on ${DateFormat('MMM dd, yyyy').format(workproof.uploadedAt)}',
              style: theme.textTheme.bodySmall?.copyWith(color: Colors.grey[600]),
            ),
          ],
        ),
      ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\citizen\submit_grievance.dart ---
// lib/screens/citizen/submit_grievance.dart
import 'dart:io';
import 'package:file_picker/file_picker.dart';
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:geolocator/geolocator.dart';
import 'package:image_picker/image_picker.dart';
import 'package:main_ui/models/grievance_model.dart';
import 'package:main_ui/providers/master_data_provider.dart';
import 'package:main_ui/services/grievance_service.dart';
import 'package:main_ui/widgets/custom_button.dart';
import 'package:main_ui/widgets/file_upload_widget.dart';
import 'package:main_ui/widgets/loading_indicator.dart';
import 'package:permission_handler/permission_handler.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:flutter/foundation.dart' show kIsWeb;

class SubmitGrievance extends ConsumerStatefulWidget {
  const SubmitGrievance({super.key});

  @override
  ConsumerState<SubmitGrievance> createState() => _SubmitGrievanceState();
}

class _SubmitGrievanceState extends ConsumerState<SubmitGrievance> {
  final _formKey = GlobalKey<FormState>();
  final _titleController = TextEditingController();
  final _descriptionController = TextEditingController();
  final _addressController = TextEditingController();

  int? _selectedSubjectId;
  int? _selectedAreaId;
  final List<PlatformFile> _attachments = [];
  Position? _currentPosition;
  bool _isSubmitting = false;

  @override
  void dispose() {
    _titleController.dispose();
    _descriptionController.dispose();
    _addressController.dispose();
    super.dispose();
  }

  Future<void> _getCurrentLocation() async {
    final hasPermission = await _handleLocationPermission();
    if (!hasPermission) return;

    try {
      setState(() => _isSubmitting = true);
      final position = await Geolocator.getCurrentPosition(
        desiredAccuracy: LocationAccuracy.high,
      );
      setState(() {
        _currentPosition = position;
        _isSubmitting = false;
      });
    } catch (e) {
      setState(() => _isSubmitting = false);
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('${AppLocalizations.of(context)!.error}: $e')),
      );
    }
  }

  Future<bool> _handleLocationPermission() async {
    final status = await Permission.location.request();
    if (status.isGranted) {
      return true;
    } else if (status.isPermanentlyDenied) {
      await openAppSettings();
      return false;
    } else {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text(AppLocalizations.of(context)!.locationPermissionDenied)),
      );
      return false;
    }
  }

  Future<void> _pickImage() async {
    final picker = ImagePicker();
    final pickedFile = await picker.pickImage(source: ImageSource.gallery);

    if (pickedFile != null) {
      // Prepare values outside setState
      final fileBytes = kIsWeb ? await pickedFile.readAsBytes() : null;
      final filePath = kIsWeb ? null : pickedFile.path;
      final fileName = pickedFile.name;
      // Compute size: Use bytes length for web, file length for non-web
      final fileSize = kIsWeb
          ? fileBytes?.length ?? 0
          : await File(pickedFile.path).length();

      // Now call setState with already computed values
      setState(() {
        _attachments.add(PlatformFile(
          name: fileName,
          size: fileSize, // Size in bytes, required
          path: filePath, // Path for non-web
          bytes: fileBytes, // Bytes for web
        ));
      });
    }
  }

  void _removeAttachment(int index) {
    setState(() {
      _attachments.removeAt(index);
    });
  }

  Future<void> _submitGrievance() async {
    if (!_formKey.currentState!.validate() ||
        _selectedSubjectId == null ||
        _selectedAreaId == null) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text(AppLocalizations.of(context)!.pleaseFillAllFields),
          backgroundColor: Colors.red,
        ),
      );
      return;
    }

    setState(() => _isSubmitting = true);

    try {
      // Log before send
      // Log count
     
      for (var i = 0; i < _attachments.length; i++) {
        // Log each file added
       
        // Log details like name size
      
      }
      final grievanceService = GrievanceService();
      await grievanceService.createGrievance(
        title: _titleController.text,
        description: _descriptionController.text,
        subjectId: _selectedSubjectId!,
        areaId: _selectedAreaId!,
        latitude: _currentPosition?.latitude,
        longitude: _currentPosition?.longitude,
        address: _addressController.text.isNotEmpty ? _addressController.text : null,
        attachments: _attachments,
      );

      if (!mounted) return;
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text(AppLocalizations.of(context)!.grievanceSubmitted),
          backgroundColor: Colors.green,
        ),
      );
      Navigator.pop(context, true);
    } catch (e) {
      if (!mounted) return;
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text('${AppLocalizations.of(context)!.error}: $e'),
          backgroundColor: Colors.red,
        ),
      );
    } finally {
      if (mounted) {
        setState(() => _isSubmitting = false);
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    final localizations = AppLocalizations.of(context)!;
    final theme = Theme.of(context);

    return Scaffold(
      backgroundColor: const Color(0xffecf2fe),
      appBar: AppBar(
        title: Text(localizations.submitGrievance),
        elevation: 0,
      ),
      body: _isSubmitting && _currentPosition == null
          ? const Center(child: LoadingIndicator())
          : SingleChildScrollView(
              padding: const EdgeInsets.all(16.0),
              child: Form(
                key: _formKey,
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      localizations.grievanceDetails,
                      style: theme.textTheme.titleMedium?.copyWith(
                        fontWeight: FontWeight.bold,
                        color: theme.primaryColor,
                      ),
                    ),
                    const SizedBox(height: 16),
                    TextFormField(
                      controller: _titleController,
                      decoration: InputDecoration(
                        labelText: localizations.title,
                        border: const OutlineInputBorder(),
                        filled: true,
                        fillColor: Colors.white,
                      ),
                      validator: (value) => value!.isEmpty ? localizations.titleRequired : null,
                    ),
                    const SizedBox(height: 16),
                    TextFormField(
                      controller: _descriptionController,
                      decoration: InputDecoration(
                        labelText: localizations.description,
                        border: const OutlineInputBorder(),
                        filled: true,
                        fillColor: Colors.white,
                        alignLabelWithHint: true,
                      ),
                      maxLines: 4,
                      validator: (value) => value!.isEmpty ? localizations.descriptionRequired : null,
                    ),
                    const SizedBox(height: 24),
                    Text(
                      localizations.categorization,
                      style: theme.textTheme.titleMedium?.copyWith(
                        fontWeight: FontWeight.bold,
                        color: theme.primaryColor,
                      ),
                    ),
                    const SizedBox(height: 16),
                    ref.watch(subjectsProvider).when(
                          data: (subjects) => DropdownButtonFormField<int>(
                            decoration: InputDecoration(
                              labelText: localizations.filterBySubject,
                              border: const OutlineInputBorder(),
                              filled: true,
                              fillColor: Colors.white,
                            ),
                            initialValue: _selectedSubjectId,
                            items: subjects
                                .map((subject) => DropdownMenuItem<int>(
                                      value: subject.id,
                                      child: Text(subject.name),
                                    ))
                                .toList(),
                            onChanged: (value) => setState(() => _selectedSubjectId = value),
                            validator: (value) => value == null ? localizations.subjectRequired : null,
                          ),
                          loading: () => const LoadingIndicator(),
                          error: (error, stack) => Text('${localizations.error}: $error'),
                        ),
                    const SizedBox(height: 16),
                    ref.watch(areasProvider).when(
                          data: (areas) => DropdownButtonFormField<int>(
                            decoration: InputDecoration(
                              labelText: localizations.filterByArea,
                              border: const OutlineInputBorder(),
                              filled: true,
                              fillColor: Colors.white,
                            ),
                            initialValue: _selectedAreaId,
                            items: areas
                                .map((area) => DropdownMenuItem<int>(
                                      value: area.id,
                                      child: Text(area.name),
                                    ))
                                .toList(),
                            onChanged: (value) => setState(() => _selectedAreaId = value),
                            validator: (value) => value == null ? localizations.areaRequired : null,
                          ),
                          loading: () => const LoadingIndicator(),
                          error: (error, stack) => Text('${localizations.error}: $error'),
                        ),
                    const SizedBox(height: 24),
                    Text(
                      localizations.locationDetails,
                      style: theme.textTheme.titleMedium?.copyWith(
                        fontWeight: FontWeight.bold,
                        color: theme.primaryColor,
                      ),
                    ),
                    const SizedBox(height: 16),
                    TextFormField(
                      controller: _addressController,
                      decoration: const InputDecoration(
                        labelText: 'Address (optional)',
                        border: OutlineInputBorder(),
                        filled: true,
                        fillColor: Colors.white,
                      ),
                    ),
                    const SizedBox(height: 16),
                    Row(
                      children: [
                        Expanded(
                          child: CustomButton(
                            text: _isSubmitting ? 'Getting Location...' : 'Get Location',
                            onPressed: _isSubmitting ? null : _getCurrentLocation,
                            icon: Icons.location_on,
                            fullWidth: true,
                          ),
                        ),
                        const SizedBox(width: 8),
                        Expanded(
                          child: CustomButton(
                            text: 'Add Media',
                            onPressed: _pickImage,
                            icon: Icons.image,
                            fullWidth: true,
                          ),
                        ),
                      ],
                    ),
                    const SizedBox(height: 16),
                    if (_currentPosition != null)
                      Container(
                        padding: const EdgeInsets.all(12),
                        decoration: BoxDecoration(
                          color: Colors.green[50],
                          borderRadius: BorderRadius.circular(8),
                          border: Border.all(color: Colors.green),
                        ),
                        child: Row(
                          children: [
                            const Icon(Icons.check_circle, color: Colors.green),
                            const SizedBox(width: 8),
                            Expanded(
                              child: Text(
                                'Location captured: ${_currentPosition!.latitude.toStringAsFixed(4)}, '
                                '${_currentPosition!.longitude.toStringAsFixed(4)}',
                                style: const TextStyle(fontSize: 14),
                              ),
                            ),
                          ],
                        ),
                      ),
                    const SizedBox(height: 24),
                    if (_attachments.isNotEmpty) ...[
                      Text(
                        'Attachments (${_attachments.length})',
                        style: theme.textTheme.titleMedium?.copyWith(
                          fontWeight: FontWeight.bold,
                          color: theme.primaryColor,
                        ),
                      ),
                      const SizedBox(height: 8),
                      Wrap(
                        spacing: 8,
                        runSpacing: 8,
                        children: List.generate(_attachments.length, (index) {
                          final file = _attachments[index];
                          return Chip(
                            label: Text(
                              file.name,
                              overflow: TextOverflow.ellipsis,
                              style: const TextStyle(fontSize: 12),
                            ),
                            avatar: const Icon(Icons.attachment, size: 18),
                            deleteIcon: const Icon(Icons.close, size: 18),
                            onDeleted: () => _removeAttachment(index),
                          );
                        }),
                      ),
                      const SizedBox(height: 16),
                    ],
                    FileUploadWidget(
                      onFilesSelected: (files) {
                        setState(() => _attachments.addAll(files));
                      },
                    ),
                    const SizedBox(height: 24),
                    CustomButton(
                      text: _isSubmitting ? 'Submitting...' : localizations.submit,
                      onPressed: _isSubmitting ? null : _submitGrievance,
                      icon: Icons.send,
                      fullWidth: true,
                    ),
                  ],
                ),
              ),
            ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\citizen\track_grievance.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/providers/grievance_provider.dart';
// import 'package:main_ui/widgets/grievance_card.dart';
import 'package:main_ui/widgets/empty_state.dart';
import 'package:main_ui/widgets/loading_indicator.dart';
// import 'package:main_ui/widgets/track_grievance_progress.dart';
import 'package:main_ui/widgets/CombinedGrievanceCard.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/widgets/navigation_drawer.dart';

// Assuming a provider for the authenticated user's ID (e.g., from JWT)
final userIdProvider = Provider<int?>((ref) {
  // Replace with actual logic to get user ID from JWT or auth service
  return 1; // Placeholder: Replace with actual user ID from auth
});

class TrackGrievance extends ConsumerStatefulWidget {
  const TrackGrievance({super.key});

  @override
  ConsumerState<TrackGrievance> createState() => _TrackGrievanceState();
}

class _TrackGrievanceState extends ConsumerState<TrackGrievance> {
  int _selectedIndex = 0;
  final PageController _pageController = PageController(viewportFraction: 0.9);
  int _currentPage = 0;

  @override
  void initState() {
    super.initState();
    WidgetsBinding.instance.addPostFrameCallback((_) {
      _startAutoScroll();
    });
  }

  @override
  void didChangeDependencies() {
    super.didChangeDependencies();
    // Fetch grievances when the screen loads
    final userId = ref.read(userIdProvider);
    if (userId != null) {
      ref.invalidate(citizenHistoryProvider(userId));
    }
  }

  void _startAutoScroll() {
    Future.delayed(const Duration(seconds: 5), () {
      if (mounted) {
        final nextPage = _currentPage + 1;
        if (nextPage < 3) {
          if (_pageController.hasClients) {
            _pageController.animateToPage(
              nextPage,
              duration: const Duration(milliseconds: 800),
              curve: Curves.easeInOut,
            );
          }
          
        } else {
          _pageController.animateToPage(
            0,
            duration: const Duration(milliseconds: 800),
            curve: Curves.easeInOut,
          );
        }
        _startAutoScroll();
      }
    });
  }

  @override
  void dispose() {
    _pageController.dispose();
    super.dispose();
  }

  void _onItemTapped(int index) {
    setState(() {
      _selectedIndex = index;
    });
    if (index == 1) { // Submit      _navigateToSubmit();    } else if (index == 0) { // Track (current screen)
      // Do nothing or refresh
      final userId = ref.read(userIdProvider);
      if (userId != null) {
        ref.invalidate(citizenHistoryProvider(userId));
      }
    } else if (index == 2) { // Profile
      Navigator.pushNamed(context, '/profile');
    }
  }

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);
    final localizations = AppLocalizations.of(context)!;
    final userId = ref.watch(userIdProvider);

    if (userId == null) {
      return Scaffold(
        backgroundColor: const Color(0xFFf8fbff),
        appBar: AppBar(
          title: Text(localizations.track_grievances),
          backgroundColor: theme.appBarTheme.backgroundColor,
          foregroundColor: theme.appBarTheme.foregroundColor,
          elevation: theme.appBarTheme.elevation,
        ),
        body: EmptyState(
          icon: Icons.error_outline,
          title: localizations.error,
          message: localizations.please_login,
          actionButton: ElevatedButton(
            onPressed: () => Navigator.pushNamed(context, '/login'),
            child: Text(localizations.login),
          ),
        ),
      );
    }

    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: Text(localizations.track_grievances),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
      ),
      drawer: const CustomNavigationDrawer(),
      body: RefreshIndicator(
        onRefresh: () async {
          final userId = ref.read(userIdProvider);
          if (userId != null) {
            ref.invalidate(citizenHistoryProvider(userId));
            await ref.read(citizenHistoryProvider(userId).future);
          }
        },
        child: ref
            .watch(citizenHistoryProvider(userId))
            .when(
              data: (grievances) {
                if (grievances.isEmpty) {
                  return EmptyState(
                    icon: Icons.inbox_rounded,
                    title: localizations.noGrievances,
                    message: localizations.noGrievancesMessage,
                    actionButton: ElevatedButton( // Changed to call _navigateToSubmit
                      onPressed: _navigateToSubmit,
                      child: Text(localizations.submitGrievance),
                    ),
                  );
                }
                return SingleChildScrollView(
                  physics: const AlwaysScrollableScrollPhysics(),
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      // Promotional Banner Carousel
                      SizedBox(
                        height: 180,
                        child: PageView.builder(
                          controller: _pageController,
                          onPageChanged: (index) {
                            setState(() {
                              _currentPage = index;
                            });
                          },
                          itemCount: 3,
                          itemBuilder: (context, index) {
                            final List<Map<String, dynamic>> banners = [
                              {
                                'title': localizations.submitGrievance,
                                'subtitle': localizations.submitGrievanceSubtitle,
                                'color': theme.colorScheme.primaryContainer,
                                'icon': Icons.add_task_rounded,
                              },
                              {
                                'title': localizations.track_grievances,
                                'subtitle':
                                    localizations.trackGrievancesSubtitle,
                                'color': theme.colorScheme.secondaryContainer,
                                'icon': Icons.track_changes_rounded,
                              },
                              {
                                'title': localizations.quickResolutionsTitle,
                                'subtitle': localizations.quickResolutionsSubtitle,
                                'color': theme.colorScheme.tertiaryContainer,
                                'icon': Icons.verified_user_rounded,
                              },
                            ];
                            return _buildBannerItem(banners[index], theme);
                          },
                        ),
                      ),
                      // Page indicators
                      const SizedBox(height: 8),
                      Center(
                        child: Row(
                          mainAxisAlignment: MainAxisAlignment.center,
                          children: List.generate(3, (index) {
                            return Container(
                              width: 8.0,
                              height: 8.0,
                              margin: const EdgeInsets.symmetric(
                                horizontal: 4.0,
                              ),
                              decoration: BoxDecoration(
                                shape: BoxShape.circle,
                                color: _currentPage == index
                                    ? theme.colorScheme.primary
                                    : Colors.grey[300],
                              ),
                            );
                          }),
                        ),
                      ),
                      const SizedBox(height: 24),
                      Padding(
                        padding: const EdgeInsets.symmetric(horizontal: 16.0),
                        child: Text(
                          localizations.grievanceDetails,
                          style: theme.textTheme.headlineSmall?.copyWith(
                            fontWeight: FontWeight.w700,
                          ),
                        ),
                      ),
                      const SizedBox(height: 16),
                      // Grievances List with Progress
                      ListView.builder(
                        shrinkWrap: true,
                        physics: const NeverScrollableScrollPhysics(),
                        itemCount: grievances.length,
                        itemBuilder: (context, index) {
                          final grievance = grievances[index];
                          
                          return Padding(
  padding: const EdgeInsets.symmetric(
    horizontal: 16.0,
    vertical: 8.0,
  ),
  child: CombinedGrievanceCard(
    grievance: grievance,
    onTap: () async {
      await _navigateToDetail(grievance.id);
    },
  ),
);
                        },
                      ),
                    ],
                  ),
                );
              },
              loading: () => const LoadingIndicator(),
              error: (error, _) => EmptyState(
                icon: Icons.error_outline,
                title: localizations.error,
                message: error.toString(),
                actionButton: ElevatedButton(
                  onPressed: () => ref.refresh(citizenHistoryProvider(userId)),
                  child: Text(localizations.retry),
                ),
              ),
            ),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: _navigateToSubmit, // Changed to call _navigateToSubmit
        backgroundColor: theme.colorScheme.primary,
        foregroundColor: Colors.white,
        child: const Icon(Icons.add_rounded),
      ),
      bottomNavigationBar: BottomNavigationBar(
        items: const <BottomNavigationBarItem>[
          BottomNavigationBarItem(
            icon: Icon(Icons.track_changes_outlined),
            activeIcon: Icon(Icons.track_changes_rounded),
            label: 'Track',
          ),
          BottomNavigationBarItem(
            icon: Icon(Icons.add_circle_outline),
            activeIcon: Icon(Icons.add_circle_rounded),
            label: 'Submit',
          ),
          BottomNavigationBarItem(
            icon: Icon(Icons.person_outline),
            activeIcon: Icon(Icons.person_rounded),
            label: 'Profile',
          ),
        ],
        currentIndex: _selectedIndex,
        selectedItemColor: theme.colorScheme.primary,
        unselectedItemColor: Colors.grey,
        showUnselectedLabels: true,
        onTap: _onItemTapped,
      ),
    );
  }

  Widget _buildBannerItem(Map<String, dynamic> banner, ThemeData theme) {
    return Padding(
      padding: const EdgeInsets.all(8.0),
      child: Container(
        decoration: BoxDecoration(
          color: banner['color'],
          borderRadius: BorderRadius.circular(16),
        ),
        padding: const EdgeInsets.all(20),
        child: Row(
          children: [
            Icon(
              banner['icon'],
              size: 40,
              color: theme.colorScheme.onPrimaryContainer,
            ),
            const SizedBox(width: 16),
            Expanded(
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  Text(
                    banner['title'],
                    style: TextStyle(
                      fontSize: 18,
                      fontWeight: FontWeight.bold,
                      color: theme.colorScheme.onPrimaryContainer,
                    ),
                  ),
                  const SizedBox(height: 4),
                  Text(
                    banner['subtitle'],
                    style:
                        TextStyle(color: theme.colorScheme.onPrimaryContainer.withOpacity(0.8)),
                  ),
                ],
              ),
            ),
          ],
        ),
      ),
    );
  }

  // Helper method to navigate and refresh
  Future<void> _navigateToSubmit() async {
    final result = await Navigator.pushNamed(context, '/citizen/submit');
    if (result == true && mounted) {
      final userId = ref.read(userIdProvider);
      if (userId != null) {
        ref.invalidate(citizenHistoryProvider(userId));
      }
    }
  }

  // Helper method to navigate to detail and refresh
  Future<void> _navigateToDetail(int grievanceId) async {
    final result = await Navigator.pushNamed(context, '/citizen/detail', arguments: grievanceId);
    if (result == true && mounted) {
      final userId = ref.read(userIdProvider);
      if (userId != null) {
        ref.invalidate(citizenHistoryProvider(userId));
      }
    }
  }
}


=== Folder: screens\common ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\common\announcements_screen.dart ---
// D:\Company_Data\PCMCApp\main_ui\lib\screens\common\announcements_screen.dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:intl/intl.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/models/announcement_model.dart';
import 'package:main_ui/providers/user_provider.dart';
import 'package:main_ui/services/api_service.dart';

final announcementsProvider = FutureProvider<List<Announcement>>((ref) async {
  final response = await ApiService.get('/admins/announcements');
  return (response.data as List).map((json) => Announcement.fromJson(json)).toList();
});

class AnnouncementsScreen extends ConsumerStatefulWidget {
  const AnnouncementsScreen({super.key});

  @override
  _AnnouncementsScreenState createState() => _AnnouncementsScreenState();
}

class _AnnouncementsScreenState extends ConsumerState<AnnouncementsScreen> {
  final _formKey = GlobalKey<FormState>();
  final _titleController = TextEditingController();
  final _messageController = TextEditingController();
  String _type = 'general';
  DateTime? _expiresAt;
  String? _targetRole;

  void _showAddAnnouncementDialog() {
    showDialog(
      context: context,
      builder: (context) {
        return Dialog(
          shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
          child: Container(
            padding: const EdgeInsets.all(24),
            decoration: BoxDecoration(
              color: Colors.white,
              borderRadius: BorderRadius.circular(16),
            ),
            child: Form(
              key: _formKey,
              child: SingleChildScrollView(
                child: Column(
                  mainAxisSize: MainAxisSize.min,
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      AppLocalizations.of(context)!.addAnnouncement,
                      style: const TextStyle(fontSize: 20, fontWeight: FontWeight.bold),
                    ),
                    const SizedBox(height: 20),
                    TextFormField(
                      controller: _titleController,
                      decoration: InputDecoration(
                        labelText: AppLocalizations.of(context)!.title,
                        border: OutlineInputBorder(borderRadius: BorderRadius.circular(8)),
                        filled: true,
                        fillColor: const Color(0xFFf8fbff),
                      ),
                      validator: (value) => value!.isEmpty ? AppLocalizations.of(context)!.error : null,
                    ),
                    const SizedBox(height: 16),
                    TextFormField(
                      controller: _messageController,
                      decoration: InputDecoration(
                        labelText: AppLocalizations.of(context)!.message,
                        border: OutlineInputBorder(borderRadius: BorderRadius.circular(8)),
                        filled: true,
                        fillColor: const Color(0xFFf8fbff),
                      ),
                      validator: (value) => value!.isEmpty ? AppLocalizations.of(context)!.error : null,
                      maxLines: 3,
                    ),
                    const SizedBox(height: 16),
                    DropdownButtonFormField<String>(
                      initialValue: _type,
                      items: ['general', 'emergency'].map((t) => DropdownMenuItem(
                        value: t, 
                        child: Text(t.capitalize(), style: const TextStyle(fontSize: 14)),
                      )).toList(),
                      onChanged: (value) => setState(() => _type = value!),
                      decoration: InputDecoration(
                        labelText: AppLocalizations.of(context)!.type,
                        border: OutlineInputBorder(borderRadius: BorderRadius.circular(8)),
                        filled: true,
                        fillColor: const Color(0xFFf8fbff),
                      ),
                      borderRadius: BorderRadius.circular(8),
                    ),
                    const SizedBox(height: 16),
                    Container(
                      decoration: BoxDecoration(
                        color: const Color(0xFFf8fbff),
                        borderRadius: BorderRadius.circular(8),
                        border: Border.all(color: Colors.grey.shade300),
                      ),
                      child: ListTile(
                        title: Text(
                          _expiresAt == null
                              ? AppLocalizations.of(context)!.selectExpiration
                              : DateFormat('yyyy-MM-dd').format(_expiresAt!),
                          style: const TextStyle(fontSize: 14),
                        ),
                        trailing: const Icon(Icons.calendar_today, size: 20),
                        onTap: () async {
                          final picked = await showDatePicker(
                            context: context,
                            initialDate: DateTime.now(),
                            firstDate: DateTime.now(),
                            lastDate: DateTime.now().add(const Duration(days: 365)),
                          );
                          if (picked != null) setState(() => _expiresAt = picked);
                        },
                      ),
                    ),
                    const SizedBox(height: 16),
                    DropdownButtonFormField<String>(
                      initialValue: _targetRole,
                      items: [
                        {'label': 'CITIZEN', 'value': 'citizen'},
                        {'label': 'SUPERVISOR', 'value': 'member_head'},
                        {'label': 'FIELD_STAFF', 'value': 'field_staff'},
                        {'label': 'ADMIN', 'value': 'admin'},
                      ].map((role) => DropdownMenuItem(
                        value: role['value'],
                        child: Text(role['label']!, style: const TextStyle(fontSize: 14)),
                      )).toList(),
                      onChanged: (value) => setState(() => _targetRole = value),
                      decoration: InputDecoration(
                        labelText: AppLocalizations.of(context)!.targetRole,
                        border: OutlineInputBorder(borderRadius: BorderRadius.circular(8)),
                        filled: true,
                        fillColor: const Color(0xFFf8fbff),
                      ),
                      borderRadius: BorderRadius.circular(8),
                    ),
                    const SizedBox(height: 24),
                    Row(
                      mainAxisAlignment: MainAxisAlignment.end,
                      children: [
                        TextButton(
                          onPressed: () => Navigator.pop(context),
                          child: Text(AppLocalizations.of(context)!.cancel),
                        ),
                        const SizedBox(width: 8),
                        ElevatedButton(
                          onPressed: () async {
                            if (_formKey.currentState!.validate()) {
                              final data = {
                                'title': _titleController.text,
                                'message': _messageController.text,
                                'type': _type,
                                'expires_at': _expiresAt?.toIso8601String(),
                                'target_role': _targetRole,
                                'is_active': true,
                              };
                              try {
                                await ApiService.post('/admins/announcements', data);
                                ref.refresh(announcementsProvider);
                                Navigator.pop(context);
                                _titleController.clear();
                                _messageController.clear();
                                _type = 'general';
                                _expiresAt = null;
                                _targetRole = null;
                                ScaffoldMessenger.of(context).showSnackBar(
                                  SnackBar(
                                    content: Text(AppLocalizations.of(context)!.announcementAdded),
                                    backgroundColor: Colors.green,
                                  ),
                                );
                              } catch (e) {
                                ScaffoldMessenger.of(context).showSnackBar(
                                  SnackBar(
                                    content: Text('Error: $e'),
                                    backgroundColor: Colors.red,
                                  ),
                                );
                              }
                            }
                          },
                          style: ElevatedButton.styleFrom(
                            backgroundColor: Colors.blue,
                            foregroundColor: Colors.white,
                            shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(8)),
                          ),
                          child: Text(AppLocalizations.of(context)!.submit),
                        ),
                      ],
                    ),
                  ],
                ),
              ),
            ),
          ),
        );
      },
    );
  }

  Future<void> _deleteAnnouncement(int id) async {
    final localizations = AppLocalizations.of(context)!;
    final confirmed = await showDialog<bool>(
      context: context,
      builder: (context) => AlertDialog(
        title: Text(localizations.confirmDelete),
        content: const Text('Are you sure you want to delete this announcement?'),
        actions: [
          TextButton(
            onPressed: () => Navigator.of(context).pop(false),
            child: Text(localizations.cancel),
          ),
          ElevatedButton(
            onPressed: () => Navigator.of(context).pop(true),
            style: ElevatedButton.styleFrom(backgroundColor: Colors.red),
            child: Text(localizations.delete),
          ),
        ],
      ),
    );

    if (confirmed == true) {
      try {
        await ApiService.delete('/admins/announcements/$id');
        ref.refresh(announcementsProvider);
        if (mounted) {
          ScaffoldMessenger.of(context).showSnackBar(
            const SnackBar(content: Text('Announcement deleted successfully'), backgroundColor: Colors.green),
          );
        }
      } catch (e) {
        if (mounted) {
          ScaffoldMessenger.of(context).showSnackBar(SnackBar(content: Text('Error: $e'), backgroundColor: Colors.red));
        }
      }
    }
  }
  @override
  Widget build(BuildContext context) {
    final localizations = AppLocalizations.of(context)!;
    final user = ref.watch(userNotifierProvider);
    final isAdmin = user?.role?.toUpperCase() == 'ADMIN';
    final announcementsAsync = ref.watch(announcementsProvider);

    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: Text(localizations.announcements),
        backgroundColor: Theme.of(context).appBarTheme.backgroundColor,
        foregroundColor: Theme.of(context).appBarTheme.foregroundColor,
        elevation: Theme.of(context).appBarTheme.elevation,
      ),
      floatingActionButton: isAdmin
          ? FloatingActionButton(
              onPressed: _showAddAnnouncementDialog,
              backgroundColor: Colors.blue,
              foregroundColor: Colors.white,
              shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
              child: const Icon(Icons.add),
            )
          : null,
      body: announcementsAsync.when(
        data: (announcements) => announcements.isEmpty
            ? Center(
                child: Column(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    Icon(Icons.announcement, size: 64, color: Colors.grey.shade400),
                    const SizedBox(height: 16),
                    Text(
                      localizations.noAnnouncements,
                      style: TextStyle(color: Colors.grey.shade600, fontSize: 16),
                    ),
                  ],
                ),
              )
            : ListView.builder(
                padding: const EdgeInsets.all(16),
                itemCount: announcements.length,
                itemBuilder: (context, index) {
                  final ann = announcements[index];
                  return Container(
                    margin: const EdgeInsets.only(bottom: 16),
                    decoration: BoxDecoration(
                      borderRadius: BorderRadius.circular(12),
                      boxShadow: [
                        BoxShadow(
                          color: Colors.grey.withOpacity(0.1),
                          blurRadius: 6,
                          offset: const Offset(0, 2),
                        ),
                      ],
                    ),
                    child: Card(
                      color: const Color(0xFFecf2fe),
                      elevation: 0,
                      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
                      child: Padding(
                        padding: const EdgeInsets.all(16),
                        child: Column(
                          crossAxisAlignment: CrossAxisAlignment.start,
                          children: [
                            Row(
                              crossAxisAlignment: CrossAxisAlignment.start,
                              children: [
                                Container(
                                  padding: const EdgeInsets.all(8),
                                  decoration: BoxDecoration(
                                    color: ann.type == 'emergency' ? Colors.red.withOpacity(0.1) : Colors.blue.withOpacity(0.1),
                                    shape: BoxShape.circle,
                                  ),
                                  child: Icon(
                                    ann.type == 'emergency' ? Icons.warning : Icons.info,
                                    color: ann.type == 'emergency' ? Colors.red : Colors.blue,
                                    size: 20,
                                  ),
                                ),
                                const SizedBox(width: 12),
                                Expanded(
                                  child: Column(
                                    crossAxisAlignment: CrossAxisAlignment.start,
                                    children: [
                                      Text(
                                        ann.title,
                                        style: const TextStyle(fontSize: 16, fontWeight: FontWeight.bold),
                                      ),
                                      const SizedBox(height: 4),
                                      Text(
                                        ann.message,
                                        style: TextStyle(fontSize: 14, color: Colors.grey.shade700),
                                      ),
                                    ],
                                  ),
                                ),
                                Row(
                                  children: [
                                    Container(
                                      padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 4),
                                      decoration: BoxDecoration(
                                        color: ann.type == 'emergency' ? Colors.red.withOpacity(0.1) : Colors.blue.withOpacity(0.1),
                                        borderRadius: BorderRadius.circular(12),
                                      ),
                                      child: Text(
                                        ann.type.toUpperCase(),
                                        style: TextStyle(
                                          fontSize: 12,
                                          fontWeight: FontWeight.w600,
                                          color: ann.type == 'emergency' ? Colors.red : Colors.blue,
                                        ),
                                      ),
                                    ),
                                    if (isAdmin)
                                      IconButton(
                                        icon: const Icon(Icons.delete, color: Colors.red, size: 20),
                                        onPressed: () => _deleteAnnouncement(ann.id),
                                        tooltip: 'Delete Announcement',
                                      ),
                                  ],
                                ),
                              ],
                            ),
                            const SizedBox(height: 12),
                            Divider(color: Colors.grey.shade300, height: 1),
                            const SizedBox(height: 12),
                            Row(
                              children: [
                                Icon(Icons.calendar_today, size: 14, color: Colors.grey.shade600),
                                const SizedBox(width: 4),
                                Text(
                                  'Posted on ${DateFormat('dd/MM/yyyy').format(ann.createdAt)}',
                                  style: TextStyle(fontSize: 12, color: Colors.grey.shade600),
                                ),
                                if (ann.expiresAt != null) ...[
                                  const SizedBox(width: 16),
                                  Icon(Icons.timer, size: 14, color: Colors.grey.shade600),
                                  const SizedBox(width: 4),
                                  Text(
                                    'Expires on ${DateFormat('dd/MM/yyyy').format(ann.expiresAt!)}',
                                    style: TextStyle(fontSize: 12, color: Colors.grey.shade600),
                                  ),
                                ],
                              ],
                            ),
                          ],
                        ),
                      ),
                    ),
                  );
                },
              ),
        loading: () => const Center(
          child: CircularProgressIndicator(
            valueColor: AlwaysStoppedAnimation<Color>(Colors.blue),
          ),
        ),
        error: (err, stack) => Center(
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              const Icon(Icons.error_outline, size: 64, color: Colors.red),
              const SizedBox(height: 16),
              Text(
                '${localizations.error}: $err',
                style: const TextStyle(color: Colors.red),
                textAlign: TextAlign.center,
              ),
            ],
          ),
        ),
      ),
    );
  }

  @override
  void dispose() {
    _titleController.dispose();
    _messageController.dispose();
    super.dispose();
  }
}

// Extension to capitalize strings
extension StringExtension on String {
  String capitalize() {
    return "${this[0].toUpperCase()}${substring(1)}";
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\common\app_version_screen.dart ---
import 'package:flutter/material.dart';
import 'package:package_info_plus/package_info_plus.dart';
import 'package:main_ui/l10n/app_localizations.dart';

class AppVersionScreen extends StatefulWidget {
  const AppVersionScreen({super.key});

  @override
  State<AppVersionScreen> createState() => _AppVersionScreenState();
}

class _AppVersionScreenState extends State<AppVersionScreen> {
  String version = "";
  String appName = "";
  String packageName = "";

  @override
  void initState() {
    super.initState();
    _loadVersion();
  }

  Future<void> _loadVersion() async {
    final info = await PackageInfo.fromPlatform();
    if (!mounted) return;
    if (version.isEmpty) {
      version = AppLocalizations.of(context)?.loadingData ?? "Loading...";
    }
    setState(() {
      version = "${info.version} (Build ${info.buildNumber})";
      appName = info.appName;
      packageName = info.packageName;
    });
  }

  @override
  Widget build(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);
    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: Text(l10n.appVersion),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
      ),
      body: SingleChildScrollView(
        padding: const EdgeInsets.all(20),
        child: Column(
          children: [
            const SizedBox(height: 40),
            // App Icon/Logo
            Container(
              width: 100,
              height: 100,
              decoration: BoxDecoration(
                color: Colors.blue,
                borderRadius: BorderRadius.circular(20),
                boxShadow: [
                  BoxShadow(
                    color: Colors.blue.withOpacity(0.3),
                    blurRadius: 10,
                    offset: const Offset(0, 4),
                  ),
                ],
              ),
              child: const Icon(
                Icons.apps_rounded,
                size: 50,
                color: Colors.white,
              ),
            ),
            const SizedBox(height: 24),
            // App Name
            Text(
              appName.isNotEmpty ? appName : l10n.appNameFallback,
              style: const TextStyle(
                fontSize: 24,
                fontWeight: FontWeight.bold,
                color: Colors.black87,
              ),
            ),
            const SizedBox(height: 8),
            // Package Name
            Text(
              packageName.isNotEmpty ? packageName : l10n.packageNameFallback,
              style: TextStyle(
                fontSize: 14,
                color: Colors.grey.shade600,
              ),
            ),
            const SizedBox(height: 40),
            // Version Card
            Container(
              decoration: BoxDecoration(
                borderRadius: BorderRadius.circular(16),
                boxShadow: [
                  BoxShadow(
                    color: Colors.grey.withOpacity(0.1),
                    blurRadius: 10,
                    offset: const Offset(0, 4),
                  ),
                ],
              ),
              child: Card(
                color: const Color(0xFFecf2fe),
                elevation: 0,
                shape: RoundedRectangleBorder(
                  borderRadius: BorderRadius.circular(16),
                ),
                child: Padding(
                  padding: const EdgeInsets.all(24),
                  child: Column(
                    children: [
                      const Icon(
                        Icons.info_outline_rounded,
                        size: 40,
                        color: Colors.blue,
                      ),
                      const SizedBox(height: 16),
                      Text(
                        l10n.currentVersion,
                        style: TextStyle(
                          fontSize: 16,
                          fontWeight: FontWeight.w600,
                          color: Colors.black87,
                        ),
                      ),
                      const SizedBox(height: 8),
                      Text(
                        version.isEmpty ? l10n.loadingData : version,
                        style: const TextStyle(
                          fontSize: 20,
                          fontWeight: FontWeight.bold,
                          color: Colors.blue,
                        ),
                        textAlign: TextAlign.center,
                      ),
                      const SizedBox(height: 16),
                      const Divider(),
                      const SizedBox(height: 16),
                      // Additional Info
                      Row(
                        mainAxisAlignment: MainAxisAlignment.spaceAround,
                        children: [
                          _buildInfoItem(
                            l10n,
                            Icons.update,
                            l10n.lastUpdated,
                            "October 2023",
                          ),
                          _buildInfoItem(
                            l10n,
                            Icons.system_security_update,
                            l10n.minimumOS,
                            "Android 8.0+",
                          ),
                        ],
                      ),
                    ],
                  ),
                ),
              ),
            ),
            const SizedBox(height: 24),
            // Update Button
            SizedBox(
              width: double.infinity,
              child: ElevatedButton(
                onPressed: () {
                  // Add update functionality here
                },
                style: ElevatedButton.styleFrom(
                  backgroundColor: Colors.blue,
                  foregroundColor: Colors.white,
                  padding: const EdgeInsets.symmetric(vertical: 16),
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(12),
                  ),
                  elevation: 0,
                ),
                child: Text(
                  l10n.checkForUpdates,
                  style: TextStyle(
                    fontSize: 16,
                    fontWeight: FontWeight.w600,
                  ),
                ),
              ),
            ),
            const SizedBox(height: 16),
            // Additional Info
            Container(
              padding: const EdgeInsets.all(16),
              decoration: BoxDecoration(
                color: Colors.white,
                borderRadius: BorderRadius.circular(12),
              ),
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Text(
                    l10n.versionInformation,
                    style: TextStyle(
                      fontSize: 16,
                      fontWeight: FontWeight.w600,
                    ),
                  ),
                  const SizedBox(height: 12),
                  _buildVersionInfoItem(l10n.status, l10n.upToDate, Colors.green),
                  const SizedBox(height: 8),
                  _buildVersionInfoItem(l10n.releaseType, "Stable", Colors.blue),
                  const SizedBox(height: 8),
                  _buildVersionInfoItem(l10n.size, "28.5 MB", Colors.grey),
                ],
              ),
            ),
            const SizedBox(height: 24),
            Text(
              l10n.thankYouMessage,
              style: TextStyle(
                fontSize: 14,
                color: Colors.grey.shade600,
                fontStyle: FontStyle.italic,
              ),
            ),
          ],
        ),
      ),
    );
  }

  Widget _buildInfoItem(AppLocalizations l10n, IconData icon, String title, String value) {
    return Column(
      children: [
        Icon(icon, size: 20, color: Colors.blue),
        const SizedBox(height: 8),
        Text(
          title,
          style: TextStyle(
            fontSize: 12,
            color: Colors.grey.shade600,
          ),
        ),
        const SizedBox(height: 4),
        Text(
          value,
          style: const TextStyle(
            fontSize: 14,
            fontWeight: FontWeight.w600,
          ),
        ),
      ],
    );
  }

  Widget _buildVersionInfoItem(String title, String value, Color color) {
    return Row(
      mainAxisAlignment: MainAxisAlignment.spaceBetween,
      children: [
        Text(
          title,
          style: TextStyle(
            fontSize: 14,
            color: Colors.grey.shade700,
          ),
        ),
        Text(
          value,
          style: TextStyle(
            fontSize: 14,
            fontWeight: FontWeight.w600,
            color: color,
          ),
        ),
      ],
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\common\contact_support_screen.dart ---
import 'package:flutter/material.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:url_launcher/url_launcher.dart';

class ContactSupportScreen extends StatelessWidget {
  const ContactSupportScreen({super.key});

  void _launchEmail(BuildContext context) async {
    final l10n = AppLocalizations.of(context)!;
    final Uri emailUri = Uri(
      scheme: 'mailto', 
      path: 'support@pcmcapp.com', 
      query: 'subject=App Support'
    );
    if (!await launchUrl(emailUri)) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text(l10n.couldNotLaunchUrl('email'))),
      );
    }
  }

  void _launchPhone(BuildContext context) async {
    final l10n = AppLocalizations.of(context)!;
    final Uri phoneUri = Uri(scheme: 'tel', path: '+91-9876543210');
    if (!await launchUrl(phoneUri)) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text(l10n.couldNotLaunchPhone)),
      );
    }
  }

  @override
  Widget build(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);
    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: Text(l10n.contactSupport),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
      ),
      body: SingleChildScrollView(
        padding: const EdgeInsets.all(20),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            const SizedBox(height: 16),
            Center(
              child: Container(
                padding: const EdgeInsets.all(20),
                decoration: BoxDecoration(
                  color: Colors.white,
                  borderRadius: BorderRadius.circular(16),
                  boxShadow: [
                    BoxShadow(
                      color: Colors.grey.withOpacity(0.1),
                      blurRadius: 10,
                      offset: const Offset(0, 4),
                    ),
                  ],
                ),
                child: Column(
                  children: [
                    Icon(
                      Icons.support_agent,
                      size: 64,
                      color: Colors.blue.shade700,
                    ),
                    const SizedBox(height: 16),
                    Text(
                      l10n.needHelp,
                      style: TextStyle(
                        fontSize: 24,
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                    const SizedBox(height: 8),
                    Text(
                      l10n.supportTeamMessage,
                      textAlign: TextAlign.center,
                      style: TextStyle(
                        fontSize: 16,
                        color: Colors.grey.shade600,
                      ),
                    ),
                  ],
                ),
              ),
            ),
            const SizedBox(height: 32),
            Text(
              l10n.contactOptions,
              style: TextStyle(
                fontSize: 18,
                fontWeight: FontWeight.w600,
              ),
            ),
            const SizedBox(height: 16),
            // Email Card
            Container(
              margin: const EdgeInsets.only(bottom: 16),
              decoration: BoxDecoration(
                borderRadius: BorderRadius.circular(12),
                boxShadow: [
                  BoxShadow(
                    color: Colors.grey.withOpacity(0.1),
                    blurRadius: 6,
                    offset: const Offset(0, 2),
                  ),
                ],
              ),
              child: Card(
                color: const Color(0xFFecf2fe),
                elevation: 0,
                shape: RoundedRectangleBorder(
                  borderRadius: BorderRadius.circular(12),
                ),
                child: InkWell(
                  onTap: () => _launchEmail(context),
                  borderRadius: BorderRadius.circular(12),
                  child: Padding(
                    padding: const EdgeInsets.all(20),
                    child: Row(
                      children: [
                        Container(
                          width: 50,
                          height: 50,
                          decoration: BoxDecoration(
                            color: Colors.blue.withOpacity(0.1),
                            shape: BoxShape.circle,
                          ),
                          child: Icon(
                            Icons.email,
                            color: Colors.blue.shade700,
                            size: 26,
                          ),
                        ),
                        const SizedBox(width: 16),
                        Expanded(
                          child: Column(
                            crossAxisAlignment: CrossAxisAlignment.start,
                            children: [
                              Text(
                                l10n.emailSupport,
                                style: TextStyle(
                                  fontSize: 16,
                                  fontWeight: FontWeight.w600,
                                ),
                              ),
                              const SizedBox(height: 4),
                              Text(
                                "support@pcmcapp.com",
                                style: TextStyle(
                                  fontSize: 14,
                                  color: Colors.grey.shade700,
                                ),
                              ),
                              const SizedBox(height: 4),
                              Text(
                                l10n.emailSupportResponseTime,
                                style: TextStyle(
                                  fontSize: 12,
                                  color: Colors.grey.shade600,
                                ),
                              ),
                            ],
                          ),
                        ),
                        Icon(
                          Icons.arrow_forward_ios,
                          size: 16,
                          color: Colors.grey.shade500,
                        ),
                      ],
                    ),
                  ),
                ),
              ),
            ),
            // Phone Card
            Container(
              margin: const EdgeInsets.only(bottom: 16),
              decoration: BoxDecoration(
                borderRadius: BorderRadius.circular(12),
                boxShadow: [
                  BoxShadow(
                    color: Colors.grey.withOpacity(0.1),
                    blurRadius: 6,
                    offset: const Offset(0, 2),
                  ),
                ],
              ),
              child: Card(
                color: const Color(0xFFecf2fe),
                elevation: 0,
                shape: RoundedRectangleBorder(
                  borderRadius: BorderRadius.circular(12),
                ),
                child: InkWell(
                  onTap: () => _launchPhone(context),
                  borderRadius: BorderRadius.circular(12),
                  child: Padding(
                    padding: const EdgeInsets.all(20),
                    child: Row(
                      children: [
                        Container(
                          width: 50,
                          height: 50,
                          decoration: BoxDecoration(
                            color: Colors.green.withOpacity(0.1),
                            shape: BoxShape.circle,
                          ),
                          child: Icon(
                            Icons.phone,
                            color: Colors.green.shade700,
                            size: 26,
                          ),
                        ),
                        const SizedBox(width: 16),
                        Expanded(
                          child: Column(
                            crossAxisAlignment: CrossAxisAlignment.start,
                            children: [
                              Text(
                                l10n.callSupport,
                                style: TextStyle(
                                  fontSize: 16,
                                  fontWeight: FontWeight.w600,
                                ),
                              ),
                              const SizedBox(height: 4),
                              Text(
                                "+91-9876543210",
                                style: TextStyle(
                                  fontSize: 14,
                                  color: Colors.grey.shade700,
                                ),
                              ),
                              const SizedBox(height: 4),
                              Text(
                                l10n.callSupportAvailability,
                                style: TextStyle(
                                  fontSize: 12,
                                  color: Colors.grey.shade600,
                                ),
                              ),
                            ],
                          ),
                        ),
                        Icon(
                          Icons.arrow_forward_ios,
                          size: 16,
                          color: Colors.grey.shade500,
                        ),
                      ],
                    ),
                  ),
                ),
              ),
            ),
            // FAQ Section
            Container(
              margin: const EdgeInsets.only(bottom: 16),
              decoration: BoxDecoration(
                borderRadius: BorderRadius.circular(12),
                boxShadow: [
                  BoxShadow(
                    color: Colors.grey.withOpacity(0.1),
                    blurRadius: 6,
                    offset: const Offset(0, 2),
                  ),
                ],
              ),
              child: Card(
                color: const Color(0xFFecf2fe),
                elevation: 0,
                shape: RoundedRectangleBorder(
                  borderRadius: BorderRadius.circular(12),
                ),
                child: InkWell(
                  onTap: () => Navigator.pushNamed(context, '/faqs'),
                  borderRadius: BorderRadius.circular(12),
                  child: Padding(
                    padding: const EdgeInsets.all(20),
                    child: Row(
                      children: [
                        const Icon(
                          Icons.help_outline,
                          color: Colors.orange,
                          size: 26,
                        ),
                        const SizedBox(width: 16),
                        Expanded(
                          child: Column(
                            crossAxisAlignment: CrossAxisAlignment.start,
                            children: [
                              Text(
                                l10n.faqsHelpCenter,
                                style: const TextStyle(
                                  fontSize: 16,
                                  fontWeight: FontWeight.w600,
                                ),
                              ),
                              const SizedBox(height: 4),
                              Text(
                                l10n.faqsHelpCenterSubtitle,
                                style: const TextStyle(
                                  fontSize: 14,
                                  color: Colors.grey,
                                ),
                              ),
                            ],
                          ),
                        ),
                        const Icon(
                          Icons.arrow_forward_ios,
                          size: 16,
                          color: Colors.grey,
                        ),
                      ],
                    ),
                  ),
                ),
              ),
            ),
            const SizedBox(height: 24),
            Center(
              child: Text(
                l10n.weAreHereToHelp,
                style: TextStyle(
                  fontSize: 14,
                  fontStyle: FontStyle.italic,
                  color: Colors.grey,
                ),
              ),
            ),
          ],
        ),
      ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\common\faqs_screen.dart ---
import 'package:flutter/material.dart';
import 'package:main_ui/l10n/app_localizations.dart';

class FaqsScreen extends StatelessWidget {
  const FaqsScreen({super.key});

  @override
  Widget build(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    final faqs = [
      {
        "q": l10n.faq1_q,
        "a": l10n.faq1_a,
        "icon": Icons.report_problem_outlined
      },
      {
        "q": l10n.faq2_q,
        "a": l10n.faq2_a,
        "icon": Icons.track_changes_outlined
      },
      {
        "q": l10n.faq3_q,
        "a": l10n.faq3_a,
        "icon": Icons.attach_file_outlined
      },
      {
        "q": l10n.faq4_q,
        "a": l10n.faq4_a,
        "icon": Icons.schedule_outlined
      },
      {
        "q": l10n.faq5_q,
        "a": l10n.faq5_a,
        "icon": Icons.list_alt_outlined
      },
      {
        "q": l10n.faq6_q,
        "a": l10n.faq6_a,
        "icon": Icons.edit_outlined
      },
      {
        "q": l10n.faq7_q,
        "a": l10n.faq7_a,
        "icon": Icons.notifications_outlined
      },
    ];

    final theme = Theme.of(context);
    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: Text(l10n.faqs),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
      ),
      body: SingleChildScrollView(
        padding: const EdgeInsets.all(20),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            // Header Section
            Container(
              padding: const EdgeInsets.all(20),
              decoration: BoxDecoration(
                color: Colors.white,
                borderRadius: BorderRadius.circular(16),
                boxShadow: [
                  BoxShadow(
                    color: Colors.grey.withOpacity(0.1),
                    blurRadius: 10,
                    offset: const Offset(0, 4),
                  ),
                ],
              ),
              child: Row(
                children: [
                  Icon(
                    Icons.help_outline_rounded,
                    size: 40,
                    color: Colors.blue.shade700,
                  ),
                  const SizedBox(width: 16),
                  Expanded(
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                        Text(
                          l10n.needHelp,
                          style: TextStyle(
                            fontSize: 18,
                            fontWeight: FontWeight.bold,
                          ),
                        ),
                        const SizedBox(height: 4),
                        Text(
                          l10n.faqsHeaderSubtitle,
                          style: TextStyle(
                            fontSize: 14,
                            color: Colors.grey.shade600,
                          ),
                        ),
                      ],
                    ),
                  ),
                ],
              ),
            ),
            const SizedBox(height: 24),
            Text(
              l10n.faqsCommonQuestions,
              style: TextStyle(
                fontSize: 18,
                fontWeight: FontWeight.w600,
              ),
            ),
            const SizedBox(height: 16),

            // FAQ Items
            ListView.separated(
              physics: const NeverScrollableScrollPhysics(),
              shrinkWrap: true,
              itemCount: faqs.length,
              separatorBuilder: (_, __) => const SizedBox(height: 12),
              itemBuilder: (context, index) {
                final faq = faqs[index];
                return Container(
                  decoration: BoxDecoration(
                    borderRadius: BorderRadius.circular(12),
                    boxShadow: [
                      BoxShadow(
                        color: Colors.grey.withOpacity(0.1),
                        blurRadius: 6,
                        offset: const Offset(0, 2),
                      ),
                    ],
                  ),
                  child: Card(
                    color: const Color(0xFFecf2fe),
                    elevation: 0,
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(12),
                    ),
                    child: ExpansionTile(
                      leading: Icon(
                        faq['icon'] as IconData,
                        color: Colors.blue.shade700,
                      ),
                      title: Text(
                        faq['q'] as String,
                        style: const TextStyle(
                          fontSize: 16,
                          fontWeight: FontWeight.w600,
                        ),
                      ),
                      tilePadding: const EdgeInsets.symmetric(horizontal: 16),
                      children: [
                        Padding(
                          padding: const EdgeInsets.fromLTRB(24, 0, 16, 16),
                          child: Text(
                            faq['a'] as String,
                            style: TextStyle(
                              fontSize: 15,
                              color: Colors.grey.shade700,
                              height: 1.4,
                            ),
                          ),
                        ),
                      ],
                    ),
                  ),
                );
              },
            ),

            const SizedBox(height: 24),

            // Contact Support Card
            Container(
              decoration: BoxDecoration(
                borderRadius: BorderRadius.circular(12),
                boxShadow: [
                  BoxShadow(
                    color: Colors.grey.withOpacity(0.1),
                    blurRadius: 6,
                    offset: const Offset(0, 2),
                  ),
                ],
              ),
              child: Card(
                color: Colors.white,
                elevation: 0,
                shape: RoundedRectangleBorder(
                  borderRadius: BorderRadius.circular(12),
                ),
                child: Padding(
                  padding: const EdgeInsets.all(20),
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      Text(
                        l10n.faqsStillNeedHelp,
                        style: TextStyle(
                          fontSize: 16,
                          fontWeight: FontWeight.w600,
                        ),
                      ),
                      const SizedBox(height: 8),
                      Text(
                        l10n.faqsContactSupportMessage,
                        style: TextStyle(
                          fontSize: 14,
                          color: Colors.grey.shade600,
                        ),
                      ),
                      const SizedBox(height: 16),
                      SizedBox(
                        width: double.infinity,
                        child: ElevatedButton.icon(
                          onPressed: () => Navigator.pushNamed(context, '/contact-support'),
                          style: ElevatedButton.styleFrom(
                            backgroundColor: Colors.blue,
                            foregroundColor: Colors.white,
                            padding: const EdgeInsets.symmetric(vertical: 12),
                            shape: RoundedRectangleBorder(
                              borderRadius: BorderRadius.circular(8),
                            ),
                          ),
                          icon: const Icon(Icons.support_agent, size: 20),
                          label: Text(l10n.contactSupport),
                        ),
                      ),
                    ],
                  ),
                ),
              ),
            ),
            const SizedBox(height: 20),
          ],
        ),
      ),
    );
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\common\notifications_screen.dart ---
import 'package:flutter/material.dart';

class NotificationsScreen extends StatelessWidget {
  const NotificationsScreen({super.key});

  @override
  Widget build(BuildContext context) {
    // Later connect with backend: GET /notifications
    final notifications = [
      {
        "title": "Grievance Update", 
        "body": "Your complaint #123 resolved.", 
        "time": "2 hours ago",
        "type": "success"
      },
      {
        "title": "Reminder", 
        "body": "Submit feedback for grievance #101.", 
        "time": "1 day ago",
        "type": "info"
      },
      {
        "title": "New Message", 
        "body": "You have a new message from support team.", 
        "time": "3 days ago",
        "type": "message"
      },
      {
        "title": "System Update", 
        "body": "New features added to the app. Update now!", 
        "time": "1 week ago",
        "type": "update"
      },
    ];

    return Scaffold(
      backgroundColor: const Color(0xFFf8fbff),
      appBar: AppBar(
        title: const Text(
          "Notifications", // This should be localized, e.g., localizations.notifications
          style: TextStyle(
            fontWeight: FontWeight.w600,
            color: Colors.black,
          ),
        ),
        backgroundColor: const Color(0xFFF8FBFF),
        elevation: 0,
        foregroundColor: Colors.blue,
      ),
      body: notifications.isEmpty
          ? Center(
              child: Column(
                mainAxisAlignment: MainAxisAlignment.center,
                children: [
                  Icon(
                    Icons.notifications_off_outlined,
                    size: 64,
                    color: Colors.grey.shade400,
                  ),
                  const SizedBox(height: 16),
                  Text(
                    "No notifications yet",
                    style: TextStyle(
                      fontSize: 18,
                      color: Colors.grey.shade600,
                    ),
                  ),
                  const SizedBox(height: 8),
                  Text(
                    "We'll notify you when something arrives",
                    style: TextStyle(
                      fontSize: 14,
                      color: Colors.grey.shade500,
                    ),
                  ),
                ],
              ),
            )
          : ListView.builder(
              padding: const EdgeInsets.all(16),
              itemCount: notifications.length,
              itemBuilder: (context, index) {
                final notif = notifications[index];
                final type = notif['type'] as String;
                
                // Different icons based on notification type
                IconData icon;
                Color iconColor;
                
                switch (type) {
                  case "success":
                    icon = Icons.check_circle_outline;
                    iconColor = Colors.green;
                    break;
                  case "info":
                    icon = Icons.info_outline;
                    iconColor = Colors.blue;
                    break;
                  case "message":
                    icon = Icons.email_outlined;
                    iconColor = Colors.purple;
                    break;
                  case "update":
                    icon = Icons.system_update_outlined;
                    iconColor = Colors.orange;
                    break;
                  default:
                    icon = Icons.notifications_outlined;
                    iconColor = Colors.blue;
                }
                
                return Container(
                  margin: const EdgeInsets.only(bottom: 16),
                  decoration: BoxDecoration(
                    borderRadius: BorderRadius.circular(12),
                    boxShadow: [
                      BoxShadow(
                        color: Colors.grey.withOpacity(0.1),
                        blurRadius: 6,
                        offset: const Offset(0, 2),
                      ),
                    ],
                  ),
                  child: Card(
                    color: const Color(0xFFecf2fe),
                    elevation: 0,
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(12),
                    ),
                    child: Padding(
                      padding: const EdgeInsets.all(16),
                      child: Row(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          Container(
                            width: 40,
                            height: 40,
                            decoration: BoxDecoration(
                              color: iconColor.withOpacity(0.1),
                              shape: BoxShape.circle,
                            ),
                            child: Icon(
                              icon,
                              color: iconColor,
                              size: 20,
                            ),
                          ),
                          const SizedBox(width: 12),
                          Expanded(
                            child: Column(
                              crossAxisAlignment: CrossAxisAlignment.start,
                              children: [
                                Text(
                                  notif['title']!,
                                  style: const TextStyle(
                                    fontSize: 16,
                                    fontWeight: FontWeight.w600,
                                  ),
                                ),
                                const SizedBox(height: 4),
                                Text(
                                  notif['body']!,
                                  style: TextStyle(
                                    fontSize: 14,
                                    color: Colors.grey.shade700,
                                  ),
                                ),
                                const SizedBox(height: 8),
                                Text(
                                  notif['time']!,
                                  style: TextStyle(
                                    fontSize: 12,
                                    color: Colors.grey.shade500,
                                  ),
                                ),
                              ],
                            ),
                          ),
                        ],
                      ),
                    ),
                  ),
                );
              },
            ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\common\profile_screen.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:intl/intl.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/services/api_service.dart';
import 'package:main_ui/services/auth_service.dart';
import 'package:main_ui/widgets/custom_button.dart';
import 'package:main_ui/widgets/loading_indicator.dart';
import 'package:main_ui/widgets/file_upload_widget.dart';
import 'package:main_ui/models/user_model.dart';
import 'package:main_ui/providers/user_provider.dart';
import 'package:file_picker/file_picker.dart';
import 'package:main_ui/utils/constants.dart';

class ProfileScreen extends ConsumerStatefulWidget {
  const ProfileScreen({super.key});

  @override
  ConsumerState<ProfileScreen> createState() => _ProfileScreenState();
}

class _ProfileScreenState extends ConsumerState<ProfileScreen> {
  final _formKey = GlobalKey<FormState>();
  late TextEditingController _nameController;
  late TextEditingController _emailController;
  late TextEditingController _addressController;
  PlatformFile? _profilePic;
  bool _isEditing = false;
  bool _isLoading = false;

  @override
  void initState() {
    super.initState();
    final user = ref.read(userNotifierProvider);
    _nameController = TextEditingController(text: user?.name);
    _emailController = TextEditingController(text: user?.email);
    _addressController = TextEditingController(text: user?.address);
    _profilePic = null;
  }

  @override
  void dispose() {
    _nameController.dispose();
    _emailController.dispose();
    _addressController.dispose();
    super.dispose();
  }

  Future<void> _updateProfile() async {
    if (_formKey.currentState!.validate()) {
      setState(() => _isLoading = true);
      try {
        final updatedUser = await ApiService.updateProfile(
          name: _nameController.text,
          email: _emailController.text,
          password: null, // No password field, so null
          address: _addressController.text,
          profilePic: _profilePic,
        );
        ref.read(userNotifierProvider.notifier).setUser(updatedUser);
        setState(() {
          _isEditing = false;
          _profilePic = null;
        });
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text(AppLocalizations.of(context)!.userUpdatedSuccess)),
        );
      } catch (e) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('${AppLocalizations.of(context)!.failedToUpdateUser}: $e')),
        );
      } finally {
        setState(() => _isLoading = false);
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    final localizations = AppLocalizations.of(context)!;
    final theme = Theme.of(context);
    final user = ref.watch(userNotifierProvider);

    return Scaffold(
      appBar: AppBar(
        title: Text(localizations.profile),
        actions: [
          if (user != null)
            IconButton(
              icon: const Icon(Icons.logout),
              tooltip: localizations.logout,
              onPressed: () async {
                setState(() => _isLoading = true);
                try {
                  await AuthService.logout();
                  ref.read(userNotifierProvider.notifier).setUser(null);
                  Navigator.pushReplacementNamed(context, '/login');
                } catch (e) {
                  ScaffoldMessenger.of(context).showSnackBar(
                    SnackBar(content: Text(localizations.logoutFailed)),
                  );
                } finally {
                  setState(() => _isLoading = false);
                }
              },
            ),
        ],
      ),
      body: _isLoading
          ? const LoadingIndicator()
          : user == null
              ? _buildNotLoggedInView(context, localizations, theme)
              : _buildProfileView(context, localizations, theme, user),
    );
  }

  Widget _buildNotLoggedInView(
      BuildContext context, AppLocalizations localizations, ThemeData theme) {
    return Center(
      child: Column(
        mainAxisAlignment: MainAxisAlignment.center,
        children: [
          Text(
            localizations.please_login,
            style: theme.textTheme.titleLarge?.copyWith(fontWeight: FontWeight.bold),
          ),
          const SizedBox(height: 16),
          SizedBox(
            width: 200, // Constrain the button width
            child: CustomButton(
              text: localizations.login,
              icon: Icons.login,
              onPressed: () => Navigator.pushNamed(context, '/login'),
            ),
          ),
        ],
      ),
    );
  }

  Widget _buildProfileView(
      BuildContext context, AppLocalizations localizations, ThemeData theme, User user) {
    return SingleChildScrollView(
      child: Padding(
        padding: const EdgeInsets.all(16.0),
        child: Form(
          key: _formKey,
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.center,
            children: [
              // Profile header with picture
              Container(
                padding: const EdgeInsets.all(16),
                decoration: BoxDecoration(
                  color: theme.colorScheme.primary.withAlpha(40),
                  borderRadius: BorderRadius.circular(16),
                ),
                child: Column(
                  children: [
                    Stack(
                      alignment: Alignment.bottomRight,
                      children: [
                        CircleAvatar(
                          radius: 50,
                          backgroundImage: user.profilePicture != null && user.profilePicture!.isNotEmpty
                              ? NetworkImage('${Constants.baseUrl}/uploads/${user.profilePicture}')
                              : null,
                          backgroundColor: theme.colorScheme.primary,
                          onBackgroundImageError: user.profilePicture != null && user.profilePicture!.isNotEmpty
                              ? (error, stackTrace) {
                                  print('Error loading profile picture: $error : ${Constants.baseUrl}/uploads/${user.profilePicture}');
                                }
                              : null,
                          child: user.profilePicture == null || user.profilePicture!.isEmpty
                              ? Text(
                                  user.name?.isNotEmpty == true ? user.name![0].toUpperCase() : '?',
                                  style: TextStyle(
                                    color: theme.colorScheme.onPrimary,
                                    fontSize: 40,
                                    fontWeight: FontWeight.bold,
                                  ),
                                )
                              : null,
                        ),
                        if (_isEditing)
                          IconButton(
                            icon: const Icon(Icons.camera_alt, color: Colors.white),
                            onPressed: () {
                              showModalBottomSheet(
                                context: context,
                                builder: (context) => FileUploadWidget(
                                  onFilesSelected: (files) {
                                    if (files.isNotEmpty) {
                                      setState(() => _profilePic = files.first);
                                      Navigator.pop(context);
                                      ScaffoldMessenger.of(context).showSnackBar(
                                        SnackBar(content: Text(localizations.profilePictureUpdateMessage)),
                                      );
                                    }
                                  },
                                ),
                              );
                            },
                          ),
                      ],
                    ),
                    const SizedBox(height: 16),
                    Text(
                      user.name ?? localizations.name,
                      style: theme.textTheme.headlineMedium?.copyWith(
                        fontWeight: FontWeight.bold,
                        color: theme.colorScheme.primary,
                      ),
                    ),
                    const SizedBox(height: 8),
                    Text(
                      user.role?.toUpperCase() ?? localizations.unknownRole,
                      style: theme.textTheme.titleMedium?.copyWith(
                        color: theme.colorScheme.secondary,
                        fontWeight: FontWeight.w600,
                      ),
                    ),
                  ],
                ),
              ),
              const SizedBox(height: 24),
              // Profile details card
              Card(
                color: const Color(0xffecf2fe),
                elevation: 4,
                shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
                child: Padding(
                  padding: const EdgeInsets.all(16.0),
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      _buildProfileField(
                          localizations: localizations,
                        icon: Icons.email,
                        label: localizations.email,
                        value: user.email,
                        controller: _emailController,
                        enabled: _isEditing,
                        validator: (value) =>
                            value == null || !value.contains('@') ? localizations.invalidEmail : null,
                      ),
                      const Divider(),
                      _buildProfileField(
                          localizations: localizations,
                        icon: Icons.person,
                        label: localizations.name,
                        value: user.name,
                        controller: _nameController,
                        enabled: _isEditing,
                        validator: (value) =>
                            value == null || value.isEmpty ? localizations.nameRequired : null,
                      ),
                      const Divider(),
                      _buildProfileField(
                          localizations: localizations,
                        icon: Icons.location_on,
                        label: localizations.address,
                        value: user.address,
                        controller: _addressController,
                        enabled: _isEditing,
                      ),
                      const Divider(),
                      ListTile(
                        leading: Icon(Icons.access_time, color: theme.colorScheme.primary),
                        title: Text(localizations.lastLogin),
                        subtitle: Text(
                          user.lastLogin != null
                              ? DateFormat('dd/MM/yyyy HH:mm').format(user.lastLogin!)
                              : localizations.notApplicable,
                        ),
                      ),
                      const Divider(),
                      ListTile(
                        leading: Icon(Icons.verified_user, color: theme.colorScheme.primary),
                        title: Text(localizations.accountStatus),
                        subtitle: Text(user.isActive ? localizations.statusActive : localizations.statusInactive),
                      ),
                      if (user.departmentId != null) ...[
                        const Divider(),
                        ListTile(
                          leading: Icon(Icons.location_city, color: theme.colorScheme.primary),
                          title: Text(localizations.department),
                          subtitle: FutureBuilder(
                            future: ApiService.getMasterArea(user.departmentId!),
                            builder: (context, snapshot) {
                              if (snapshot.connectionState == ConnectionState.waiting) {
                                return const Text('Loading...');
                              }
                              if (snapshot.hasError || !snapshot.hasData || snapshot.data == null) {
                                return Text(localizations.statusUnknown);
                              }
                              return Text(snapshot.data!['name'] ?? localizations.statusUnknown);
                            },
                          ),
                        ),
                      ],
                    ],
                  ),
                ),
              ),
              const SizedBox(height: 24),
              if (_isEditing)
                Row(
                  mainAxisAlignment: MainAxisAlignment.spaceEvenly,
                  children: [
                    Expanded(
                      child: Padding(
                        padding: const EdgeInsets.only(right: 8.0),
                        child: CustomButton(
                          text: localizations.cancel,
                          backgroundColor: theme.colorScheme.secondary,
                          onPressed: () => setState(() {
                            _isEditing = false;
                            _nameController.text = user.name ?? '';
                            _emailController.text = user.email ?? '';
                            _addressController.text = user.address ?? '';
                            _profilePic = null;
                          }),
                        ),
                      ),
                    ),
                    Expanded(
                      child: Padding(
                        padding: const EdgeInsets.only(left: 8.0),
                        child: CustomButton(
                          text: localizations.update,
                          icon: Icons.save,
                          onPressed: _updateProfile,
                          isLoading: _isLoading,
                        ),
                      ),
                    ),
                  ],
                )
              else
                SizedBox(
                  width: double.infinity,
                  child: CustomButton( // Localize 'Edit Profile'
                    text: localizations.editProfile,
                    icon: Icons.edit,
                    onPressed: () => setState(() => _isEditing = true),
                  ),
                ),
              const SizedBox(height: 16),
            ],
          ),
        ),
      ),
    );
  }

  Widget _buildProfileField({
    required AppLocalizations localizations,
    required IconData icon,
    required String label,
    required String? value,
    required TextEditingController controller,
    bool enabled = false,
    String? Function(String?)? validator,
  }) {
    return ListTile(
      leading: Icon(icon, color: Theme.of(context).colorScheme.primary),
      title: Text(label),
      subtitle: enabled
          ? TextFormField(
              controller: controller,
              decoration: InputDecoration(
                border: const OutlineInputBorder(),
                hintText: label,
              ),
              validator: validator,
            )
          : Text(value ?? localizations.notApplicable),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\common\settings_screen.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/providers/locale_provider.dart';
import 'package:main_ui/providers/user_provider.dart';
import 'package:main_ui/services/auth_service.dart';
import 'package:main_ui/services/api_service.dart';
import 'package:main_ui/utils/validators.dart';
import 'package:main_ui/widgets/custom_button.dart';
import 'package:main_ui/widgets/loading_indicator.dart';

class SettingsScreen extends ConsumerStatefulWidget {
  const SettingsScreen({super.key});

  @override
  ConsumerState<SettingsScreen> createState() => _SettingsScreenState();
}

class _SettingsScreenState extends ConsumerState<SettingsScreen> {
  bool _notificationsEnabled = true;
  bool _isLoading = false;
  final _formKey = GlobalKey<FormState>();
  late TextEditingController _nameController;
  late TextEditingController _emailController;
  late TextEditingController _passwordController;

  @override
  void initState() {
    super.initState();
    _nameController = TextEditingController();
    _emailController = TextEditingController();
    _passwordController = TextEditingController();
    _loadSettings();
  }

  @override
  void dispose() {
    _nameController.dispose();
    _emailController.dispose();
    _passwordController.dispose();
    super.dispose();
  }

  Future<void> _loadSettings() async {
    setState(() => _isLoading = true);
    try {
      final response = await ApiService.get('/settings/');
      setState(() {
        _notificationsEnabled = response.data['notifications_enabled'] ?? true;
        final user = ref.read(userNotifierProvider);
        _nameController.text = user?.name ?? '';
        _emailController.text = user?.email ?? '';
      });
        } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text('Failed to load settings: $e'),
          backgroundColor: Colors.red,
        ),
      );
    } finally {
      setState(() => _isLoading = false);
    }
  }

  Future<void> _saveSettings() async {
    if (!_formKey.currentState!.validate()) return;
    setState(() => _isLoading = true);
    try {
      await ApiService.post('/settings/', {
        'notifications_enabled': _notificationsEnabled,
        'name': _nameController.text,
        'email': _emailController.text,
        'password': _passwordController.text.isNotEmpty ? _passwordController.text : null,
      });
      await ref.read(userNotifierProvider.notifier).updateUser();
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(
          content: Text('Settings saved successfully!'),
          backgroundColor: Colors.green,
        ),
      );
    } catch (e) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text('Failed to save: $e'),
          backgroundColor: Colors.red,
        ),
      );
    } finally {
      setState(() => _isLoading = false);
    }
  }

  @override
  Widget build(BuildContext context) {
    final localizations = AppLocalizations.of(context)!;
    final locale = ref.watch(localeNotifierProvider);
    final theme = Theme.of(context);

    return Scaffold(
      backgroundColor: const Color(0xFFF8FBFF),
      appBar: AppBar(
        title: Text(localizations.settings),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
      ),
      body: _isLoading
          ? const LoadingIndicator()
          : SingleChildScrollView(
              padding: const EdgeInsets.all(16.0),
              child: Form(
                key: _formKey,
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    // Account Section
                    _buildSectionTitle(localizations.account),
                    const SizedBox(height: 12),
                    Card(
                      elevation: 0,
                      color: const Color(0xFFECF2FE),
                      shape: RoundedRectangleBorder(
                        borderRadius: BorderRadius.circular(12),
                      ),
                      child: Padding(
                        padding: const EdgeInsets.all(16.0),
                        child: Column(
                          children: [
                            TextFormField(
                              controller: _nameController,
                              decoration: InputDecoration(
                                labelText: localizations.name,
                                filled: true,
                                fillColor: Colors.white,
                                border: OutlineInputBorder(
                                  borderRadius: BorderRadius.circular(8),
                                  borderSide: BorderSide.none,
                                ),
                                contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 14),
                              ),
                              validator: validateRequired,
                            ),
                            const SizedBox(height: 12),
                            TextFormField(
                              controller: _emailController,
                              decoration: InputDecoration(
                                labelText: localizations.email,
                                filled: true,
                                fillColor: Colors.white,
                                border: OutlineInputBorder(
                                  borderRadius: BorderRadius.circular(8),
                                  borderSide: BorderSide.none,
                                ),
                                contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 14),
                              ),
                              validator: validateEmail,
                            ),
                            const SizedBox(height: 12),
                            TextFormField(
                              controller: _passwordController,
                              decoration: InputDecoration(
                                labelText: '${localizations.password} (optional)',
                                filled: true,
                                fillColor: Colors.white,
                                border: OutlineInputBorder(
                                  borderRadius: BorderRadius.circular(8),
                                  borderSide: BorderSide.none,
                                ),
                                contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 14),
                              ),
                              obscureText: true,
                              validator: (value) => value!.isNotEmpty ? validateRequired(value) : null,
                            ),
                          ],
                        ),
                      ),
                    ),
                    const SizedBox(height: 24),

                    // Notifications
                    _buildSectionTitle(localizations.notifications),
                    const SizedBox(height: 12),
                    Card(
                      elevation: 0,
                      color: const Color(0xFFECF2FE),
                      shape: RoundedRectangleBorder(
                        borderRadius: BorderRadius.circular(12),
                      ),
                      child: SwitchListTile(
                        title: Text(localizations.enableNotifications ,
                            style: const TextStyle(fontWeight: FontWeight.w500)),
                        value: _notificationsEnabled,
                        onChanged: (value) => setState(() => _notificationsEnabled = value),
                      ),
                    ),
                    const SizedBox(height: 24),

                    // Language
                    _buildSectionTitle(localizations.language),
                    const SizedBox(height: 12),
                    Card(
                      elevation: 0,
                      color: const Color(0xFFECF2FE),
                      shape: RoundedRectangleBorder(
                        borderRadius: BorderRadius.circular(12),
                      ),
                      child: Padding(
                        padding: const EdgeInsets.symmetric(horizontal: 16.0, vertical: 4),
                        child: DropdownButtonFormField<Locale>(
                          initialValue: locale,
                          decoration: InputDecoration(
                            border: InputBorder.none,
                            filled: true,
                            fillColor: Colors.white,
                            contentPadding: const EdgeInsets.symmetric(horizontal: 16),
                          ),
                          items: const [
                            DropdownMenuItem(value: Locale('en'), child: Text('English')),
                            DropdownMenuItem(value: Locale('mr'), child: Text('Marathi')),
                            DropdownMenuItem(value: Locale('hi'), child: Text('Hindi')),
                          ],
                          onChanged: (value) => ref.read(localeNotifierProvider.notifier).setLocale(value!),
                        ),
                      ),
                    ),
                    const SizedBox(height: 24),

                    // Privacy & Security
                    _buildSectionTitle(localizations.privacySecurity ),
                    const SizedBox(height: 12),
                    Card(
                      elevation: 0,
                      color: const Color(0xFFECF2FE),
                      shape: RoundedRectangleBorder(
                        borderRadius: BorderRadius.circular(12),
                      ),
                      child: Column(
                        children: [
                          ListTile(
                            title: Text(localizations.viewPrivacyPolicy),
                            trailing: const Icon(Icons.arrow_forward_ios, size: 16),
                            onTap: () => Navigator.pushNamed(context, '/privacy-policy'),
                          ),
                        ],
                      ),
                    ),
                    const SizedBox(height: 24),

                    // Help & Support
                    _buildSectionTitle(localizations.helpSupport ),
                    const SizedBox(height: 12),
                    Card(
                      elevation: 0,
                      color: const Color(0xFFECF2FE),
                      shape: RoundedRectangleBorder(
                        borderRadius: BorderRadius.circular(12),
                      ),
                      child: Column(
                        children: [
                          ListTile(
                            title: Text(localizations.faqs ),
                            trailing: const Icon(Icons.arrow_forward_ios, size: 16),
                            onTap: () => Navigator.pushNamed(context, '/faqs'),
                          ),
                          const Divider(height: 1),
                          ListTile(
                            title: Text(localizations.contactSupport ),
                            trailing: const Icon(Icons.arrow_forward_ios, size: 16),
                            onTap: () => Navigator.pushNamed(context, '/contact-support'),
                          ),
                        ],
                      ),
                    ),
                    const SizedBox(height: 24),

                    // About
                    _buildSectionTitle(localizations.about ),
                    const SizedBox(height: 12),
                    Card(
                      elevation: 0,
                      color: const Color(0xFFECF2FE),
                      shape: RoundedRectangleBorder(
                        borderRadius: BorderRadius.circular(12),
                      ),
                      child: ListTile(
                        title: Text(localizations.appVersion ),
                        trailing: const Icon(Icons.arrow_forward_ios, size: 16),
                        onTap: () => Navigator.pushNamed(context, '/app-version'),
                      ),
                    ),
                    const SizedBox(height: 32),

                    // Save & Logout
                    SizedBox(
                      width: double.infinity,
                      child: CustomButton(
                        text: localizations.save ,
                        onPressed: _saveSettings,
                      ),
                    ),
                    const SizedBox(height: 12),
                    SizedBox(
                      width: double.infinity,
                      child: CustomButton(
                        text: localizations.logout ,
                        backgroundColor: Colors.red,
                        onPressed: () async {
                          await AuthService.logout();
                          ref.read(userNotifierProvider.notifier).setUser(null);
                          Navigator.pushReplacementNamed(context, '/login');
                        },
                      ),
                    ),
                  ],
                ),
              ),
            ),
    );
  }

  Widget _buildSectionTitle(String title) {
    return Text(
      title,
      style: const TextStyle(
        fontSize: 18,
        fontWeight: FontWeight.w600,
        color: Colors.blue,
      ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\common\view_privacy_policy_screen.dart ---
import 'package:flutter/material.dart';
import 'package:main_ui/l10n/app_localizations.dart';

class PrivacyPolicyScreen extends StatelessWidget {
  const PrivacyPolicyScreen({super.key});

  @override
  Widget build(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);
    return Scaffold(
      backgroundColor: const Color(0xFFF8FBFF), // Background color
      appBar: AppBar(
        title: Text(l10n.privacyPolicy),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
      ),
      body: SingleChildScrollView(
        padding: const EdgeInsets.all(16.0),
        child: Card(
          color: const Color(0xFFECF2FE), // Card background
          elevation: 2,
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(16),
          ),
          child: Padding(
            padding: const EdgeInsets.all(20.0),
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(
                  l10n.privacyPolicyCommitmentTitle,
                  style: const TextStyle(
                    fontSize: 22,
                    fontWeight: FontWeight.bold,
                    color: Colors.black87,
                  ),
                ),
                const SizedBox(height: 10),
                Text(
                  l10n.privacyPolicyCommitmentBody,
                  style: const TextStyle(fontSize: 16, color: Colors.black87, height: 1.5),
                ),
                const SizedBox(height: 20),
                Text(
                  l10n.privacyPolicyDataCollectionTitle,
                  style: const TextStyle(
                    fontSize: 18,
                    fontWeight: FontWeight.w600,
                    color: Colors.black87,
                  ),
                ),
                const SizedBox(height: 8),
                Text(
                  l10n.privacyPolicyDataCollectionBody,
                  style: const TextStyle(fontSize: 15, height: 1.4),
                ),
                const SizedBox(height: 20),
                Text(
                  l10n.privacyPolicyDataUsageTitle,
                  style: const TextStyle(
                    fontSize: 18,
                    fontWeight: FontWeight.w600,
                    color: Colors.black87,
                  ),
                ),
                const SizedBox(height: 8),
                Text(
                  l10n.privacyPolicyDataUsageBody,
                  style: const TextStyle(fontSize: 15, height: 1.4),
                ),
                const SizedBox(height: 20),
                Text(
                  l10n.privacyPolicySecurityTitle,
                  style: const TextStyle(
                    fontSize: 18,
                    fontWeight: FontWeight.w600,
                    color: Colors.black87,
                  ),
                ),
                const SizedBox(height: 8),
                Text(
                  l10n.privacyPolicySecurityBody,
                  style: const TextStyle(fontSize: 15, height: 1.4),
                ),
              ],
            ),
          ),
        ),
      ),
    );
  }
}


=== Folder: screens\field_staff ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\field_staff\assigned_list.dart ---
import 'dart:io'
    if (dart.library.html) 'dart:html'; // Conditional import for web
import 'package:file_picker/file_picker.dart';
import 'package:flutter/foundation.dart' show kIsWeb;
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/models/grievance_model.dart';
import 'package:main_ui/widgets/navigation_drawer.dart';
import 'package:main_ui/services/api_service.dart';
import 'package:main_ui/widgets/empty_state.dart';
import 'package:main_ui/widgets/loading_indicator.dart';
import 'package:intl/intl.dart'; // For formatting dates

class AssignedList extends ConsumerStatefulWidget {
  const AssignedList({super.key});

  @override
  ConsumerState<AssignedList> createState() => _AssignedListState();
}

class _AssignedListState extends ConsumerState<AssignedList> {
  late Future<List<Grievance>> _grievancesFuture;

  @override
  void initState() {
    super.initState();
    _grievancesFuture = _fetchAssignedGrievances();
  }

  Future<List<Grievance>> _fetchAssignedGrievances() async {
    try {
      final response = await ApiService.get('/grievances/assigned');
      
      return (response.data as List)
          .map((json) => Grievance.fromJson(json))
          .toList();
    } catch (e) {
      throw Exception('Failed to load assigned grievances: $e');
    }
  }

  Future<void> _updateStatus(int grievanceId, String newStatus) async {
    try {
      // Perform the API call
      await ApiService.put('/grievances/$grievanceId/status', {
        'status': newStatus,
      });

      if (!mounted) return;

      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(content: Text('Status updated successfully')),
      );
      // Refresh the list to show the updated status
      setState(() {
        _grievancesFuture = _fetchAssignedGrievances();
      });
    } catch (e) {
      if (!mounted) return;
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(content: Text('Failed to update status: $e')),
      );
    }
  }


  Future<void> _uploadWorkproof(int grievanceId, PlatformFile file, String notes) async {
    try {
      await ApiService.postMultipart(
        '/grievances/$grievanceId/workproof',
        files: [file],
        fieldName: 'file',
        data: {'notes': notes},
      );
      setState(() => _grievancesFuture = _fetchAssignedGrievances());
      if (!mounted) return;
      ScaffoldMessenger.of(
        context,
      ).showSnackBar(const SnackBar(content: Text('Work proof uploaded')));
    } catch (e) {
      if (!mounted) return;
      ScaffoldMessenger.of(
        context,
      ).showSnackBar(SnackBar(content: Text('Failed to upload: $e')));
    }
  }

  Future<void> _closeGrievance(int grievanceId) async {
    try {
      await ApiService.post('/grievances/$grievanceId/close', {});
      setState(() => _grievancesFuture = _fetchAssignedGrievances());
      if (!mounted) return;
      ScaffoldMessenger.of(
        context,
      ).showSnackBar(const SnackBar(content: Text('Grievance closed')));
    } catch (e) {
      if (!mounted) return;
      ScaffoldMessenger.of(
        context,
      ).showSnackBar(SnackBar(content: Text('Failed to close: $e')));
    }
  }

  void _showUpdateStatusPopup(Grievance grievance) {
    String? selectedStatus;
    showDialog(
      context: context,
      builder: (context) {
        return StatefulBuilder(
          builder: (BuildContext context, StateSetter setState) {
            return AlertDialog(
              backgroundColor: Colors.white,
              shape: RoundedRectangleBorder(
                borderRadius: BorderRadius.circular(16.0),
              ),
              title: const Text(
                'Update Status',
                style: TextStyle(fontWeight: FontWeight.bold),
              ),
              content: DropdownButtonFormField<String>(
                decoration: InputDecoration(
                  border: OutlineInputBorder(
                    borderRadius: BorderRadius.circular(12.0),
                  ),
                  filled: true,
                  fillColor: Colors.grey[50],
                ),
                hint: const Text('Select New Status'),
                initialValue: selectedStatus,
                items: ['in_progress', 'on_hold', 'resolved'].map((status) {
                  return DropdownMenuItem<String>(
                    value: status,
                    child: Text(
                      status.replaceAll('_', ' ').toUpperCase(),
                      style: const TextStyle(fontSize: 14),
                    ),
                  );
                }).toList(),
                onChanged: (value) {
                  setState(() {
                    selectedStatus = value;
                  });
                },
              ),
              actions: [
                TextButton(
                  onPressed: () => Navigator.pop(context),
                  child: const Text('Cancel'),
                ),
                ElevatedButton(
                  style: ElevatedButton.styleFrom(
                    backgroundColor: const Color(0xFF4A64F6),
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(12.0),
                    ),
                  ),
                  onPressed: () {
                    if (selectedStatus != null) {
                      _updateStatus(grievance.id, selectedStatus!);
                      Navigator.pop(context);
                    }
                  },
                  child: const Text(
                    'Update',
                    style: TextStyle(color: Colors.white),
                  ),
                ),
              ],
            );
          },
        );
      },
    );
  }

  void _showUploadWorkproofPopup(Grievance grievance) async {
    final notesController = TextEditingController();
    final formKey = GlobalKey<FormState>();

    final file = await FilePicker.platform.pickFiles(
      type: FileType.any,
    ).then((result) => result?.files.first);

    if (file == null) return;

    if (mounted) {
      showDialog(
        context: context,
        builder: (context) {
          return AlertDialog(
            title: const Text('Add Workproof Notes'),
            content: Form(
              key: formKey,
              child: TextFormField(
                controller: notesController,
                decoration: const InputDecoration(
                  labelText: 'Notes',
                  hintText: 'Describe the work done...',
                  border: OutlineInputBorder(),
                ),
                maxLines: 3,
                validator: (value) {
                  if (value == null || value.trim().isEmpty) {
                    return 'Notes are required';
                  }
                  return null;
                },
              ),
            ),
            actions: [
              TextButton(
                onPressed: () => Navigator.pop(context),
                child: const Text('Cancel'),
              ),
              ElevatedButton(
                onPressed: () {
                  if (formKey.currentState!.validate()) {
                    _uploadWorkproof(grievance.id, file, notesController.text);
                    Navigator.pop(context);
                  }
                },
                child: const Text('Upload'),
              ),
            ],
          );
        },
      );
    }
  }

  Widget _buildGrievanceItem(Grievance grievance) {
    final l10n = AppLocalizations.of(context)!;
    final dateFormat = DateFormat(
      'yyyy-MM-dd HH:mm:ss',
    ); // For formatting dates

    // Status color mapping
    Color getStatusColor(String status) {
      switch (status) {
        case 'new':
          return Colors.blue;
        case 'in_progress':
          return Colors.orange;
        case 'on_hold':
          return Colors.red;
        case 'resolved':
          return Colors.green;
        default:
          return Colors.grey;
      }
    }

    // Priority color mapping
    Color getPriorityColor(String priority) {
      switch (priority) {
        case 'high':
          return Colors.red;
        case 'medium':
          return Colors.orange;
        case 'low':
          return Colors.green;
        default:
          return Colors.grey;
      }
    }

    return Container(
      margin: const EdgeInsets.symmetric(vertical: 8.0, horizontal: 16.0),
      decoration: BoxDecoration(
        color: const Color(0xFFECF2FE), // Card background color
        borderRadius: BorderRadius.circular(16.0),
        boxShadow: [
          BoxShadow(
            color: Colors.black.withOpacity(0.05),
            blurRadius: 8,
            offset: const Offset(0, 2),
          ),
        ],
      ),
      child: Padding(
        padding: const EdgeInsets.all(16.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            // Header with ID and status
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                Expanded(
                  child: Text(
                    grievance.title ?? 'No Title',
                    style: Theme.of(context).textTheme.titleLarge?.copyWith(
                          fontWeight: FontWeight.bold,
                          color: const Color(0xFF1A237E),
                        ),
                    overflow: TextOverflow.ellipsis,
                  ),
                ),
                Container(
                  padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),
                  decoration: BoxDecoration(
                    color: getStatusColor(grievance.status ?? '').withOpacity(0.1),
                    borderRadius: BorderRadius.circular(20),
                    border: Border.all(
                      color: getStatusColor(grievance.status ?? ''),
                      width: 1,
                    ),
                  ),
                  child: Text(
                    grievance.status?.toUpperCase() ?? "N/A",
                    style: TextStyle(
                      color: getStatusColor(grievance.status ?? ''),
                      fontWeight: FontWeight.bold,
                      fontSize: 12,
                    ),
                  ),
                ),
              ],
            ),
            const SizedBox(height: 4),
            Text(
              'Complaint ID: ${grievance.complaintId}',
              style: Theme.of(context).textTheme.bodySmall?.copyWith(
                    color: Colors.grey[600],
                  ),
            ),

            // Divider
            const Divider(height: 24, thickness: 1),

            // Description
            Text(
              'Description:',
              style: Theme.of(context).textTheme.titleMedium?.copyWith(
                    fontWeight: FontWeight.w600,
                  ),
            ),
            const SizedBox(height: 4),
            Text(
              grievance.description ?? 'No Description',
              style: Theme.of(context).textTheme.bodyMedium,
            ),

            // Status and Priority
            const SizedBox(height: 16),
            Row(
              children: [
                // Status
                Expanded(
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      Text(
                        'Status',
                        style: Theme.of(context).textTheme.bodySmall?.copyWith(
                              color: Colors.grey[600],
                              fontWeight: FontWeight.w500,
                            ),
                      ),
                      const SizedBox(height: 4),
                      Row(
                        children: [
                          Container(
                            width: 12,
                            height: 12,
                            decoration: BoxDecoration(
                              color: getStatusColor(grievance.status ?? ''),
                              shape: BoxShape.circle,
                            ),
                          ),
                          const SizedBox(width: 8),
                          Text(
                            grievance.status?.replaceAll('_', ' ').toUpperCase() ?? "N/A",
                            style: TextStyle(
                              color: getStatusColor(grievance.status ?? ''),
                              fontWeight: FontWeight.w500,
                            ),
                          ),
                        ],
                      ),
                    ],
                  ),
                ),
                
                // Priority
                Expanded(
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      Text(
                        'Priority',
                        style: Theme.of(context).textTheme.bodySmall?.copyWith(
                              color: Colors.grey[600],
                              fontWeight: FontWeight.w500,
                            ),
                      ),
                      const SizedBox(height: 4),
                      Row(
                        children: [
                          Container(
                            width: 12,
                            height: 12,
                            decoration: BoxDecoration(
                              color: getPriorityColor(grievance.priority ?? ''),
                              shape: BoxShape.circle,
                            ),
                          ),
                          const SizedBox(width: 8),
                          Text(
                            grievance.priority?.toUpperCase() ?? 'N/A',
                            style: TextStyle(
                              color: getPriorityColor(grievance.priority ?? ''),
                              fontWeight: FontWeight.w500,
                            ),
                          ),
                        ],
                      ),
                    ],
                  ),
                ),
              ],
            ),

            // Dates
            const SizedBox(height: 16),
            Text(
              'Dates',
              style: Theme.of(context).textTheme.bodySmall?.copyWith(
                    color: Colors.grey[600],
                    fontWeight: FontWeight.w500,
                  ),
            ),
            const SizedBox(height: 4),
            Text(
              'Created: ${dateFormat.format(grievance.createdAt!)}',
              style: Theme.of(context).textTheme.bodySmall,
            ),
            Text(
              'Updated: ${dateFormat.format(grievance.updatedAt!)}',
              style: Theme.of(context).textTheme.bodySmall,
            ),
            if (grievance.resolvedAt != null)
              Text(
                'Resolved: ${dateFormat.format(grievance.resolvedAt!)}',
                style: Theme.of(context).textTheme.bodySmall,
              ),

            // Location
            const SizedBox(height: 16),
            Text(
              'Location',
              style: Theme.of(context).textTheme.bodySmall?.copyWith(
                    color: Colors.grey[600],
                    fontWeight: FontWeight.w500,
                  ),
            ),
            const SizedBox(height: 4),
            Text(
              'Area: ${grievance.area?.name ?? 'N/A'}',
              style: Theme.of(context).textTheme.bodySmall,
            ),
            Row(
              children: [
                Expanded(
                  child: Text(
                    'Lat: ${grievance.latitude ?? 'N/A'}',
                    style: Theme.of(context).textTheme.bodySmall,
                  ),
                ),
                Expanded(
                  child: Text(
                    'Long: ${grievance.longitude ?? 'N/A'}',
                    style: Theme.of(context).textTheme.bodySmall,
                  ),
                ),
              ],
            ),

            // Subject
            const SizedBox(height: 16),
            Text(
              'Subject',
              style: Theme.of(context).textTheme.bodySmall?.copyWith(
                    color: Colors.grey[600],
                    fontWeight: FontWeight.w500,
                  ),
            ),
            const SizedBox(height: 4),
            Text(
              grievance.subject?.name ?? 'N/A',
              style: Theme.of(context).textTheme.bodySmall,
            ),
            if (grievance.subject?.description != null)
              Text(
                '${grievance.subject?.description}',
                style: Theme.of(context).textTheme.bodySmall,
              ),

            // Additional Fields
            const SizedBox(height: 16),
            if (grievance.rejectionReason != null)
              Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Text(
                    'Rejection Reason',
                    style: Theme.of(context).textTheme.bodySmall?.copyWith(
                          color: Colors.grey[600],
                          fontWeight: FontWeight.w500,
                        ),
                  ),
                  const SizedBox(height: 4),
                  Text(
                    grievance.rejectionReason!,
                    style: Theme.of(context).textTheme.bodySmall,
                  ),
                ],
              ),
            Text(
              'Attachments: ${grievance.attachments?.isEmpty ?? true ? 'None' : grievance.attachments!.length}',
              style: Theme.of(context).textTheme.bodySmall,
            ),

            // Action Buttons
            const Divider(height: 24, thickness: 1),
            Wrap(
              spacing: 8.0,
              runSpacing: 8.0,
              alignment: WrapAlignment.end,
              children: [
                ElevatedButton(
                  onPressed: grievance.status == 'resolved'
                      ? null
                      : () => _showUpdateStatusPopup(grievance),
                  style: ElevatedButton.styleFrom(
                    backgroundColor: const Color(0xFF2196F3),
                    foregroundColor: Colors.white,
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(12.0),
                    ),
                    padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 10),
                  ),
                  child: const Row(
                    mainAxisSize: MainAxisSize.min,
                    children: [
                      Icon(Icons.update, size: 18),
                      SizedBox(width: 4),
                      Text('Update Status'),
                    ],
                  ),
                ),
                ElevatedButton(
                  onPressed: grievance.status == 'resolved'
                      ? null
                      : () => _showUploadWorkproofPopup(grievance),
                  style: ElevatedButton.styleFrom(
                    backgroundColor: const Color(0xFFFF9800),
                    foregroundColor: Colors.white,
                    shape: RoundedRectangleBorder(
                      borderRadius: BorderRadius.circular(12.0),
                    ),
                    padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 10),
                  ),
                  child: const Row(
                    mainAxisSize: MainAxisSize.min,
                    children: [
                      Icon(Icons.upload_file, size: 18),
                      SizedBox(width: 4),
                      Text('Upload Proof'),
                    ],
                  ),
                ),
                // if (grievance.status == 'resolved')
                //   ElevatedButton(
                //     onPressed: () => _closeGrievance(grievance.id),
                //     style: ElevatedButton.styleFrom(
                //       backgroundColor: const Color(0xFFF44336),
                //       foregroundColor: Colors.white,
                //       shape: RoundedRectangleBorder(
                //         borderRadius: BorderRadius.circular(12.0),
                //       ),
                //       padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 10),
                //     ),
                //     child: const Row(
                //       mainAxisSize: MainAxisSize.min,
                //       children: [
                //         Icon(Icons.close, size: 18),
                //         SizedBox(width: 4),
                //         Text('Close'),
                //       ],
                //     ),
                //   ),
              ],
            ),
          ],
        ),
      ),
    );
  }

  @override
  Widget build(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    final theme = Theme.of(context);
    return Scaffold(
      backgroundColor: const Color(0xFFF8FBFF), // Background color
      appBar: AppBar(
        title: Text(l10n.assignedGrievances),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
      ),
      drawer: const CustomNavigationDrawer(),
      body: FutureBuilder<List<Grievance>>(
        future: _grievancesFuture,
        builder: (context, snapshot) {
          if (snapshot.connectionState == ConnectionState.waiting) {
            return const LoadingIndicator();
          } else if (snapshot.hasError) {
            return EmptyState(
              icon: Icons.error,
              title: l10n.error,
              message: '${snapshot.error}',
              actionButton: ElevatedButton(
                onPressed: () => setState(
                  () => _grievancesFuture = _fetchAssignedGrievances(),
                ),
                style: ElevatedButton.styleFrom(
                  backgroundColor: const Color(0xFF4A64F6),
                  foregroundColor: Colors.white,
                  shape: RoundedRectangleBorder(
                    borderRadius: BorderRadius.circular(12.0),
                  ),
                ),
                child: Text(l10n.retry),
              ),
            );
          } else if (!snapshot.hasData || snapshot.data!.isEmpty) {
            return EmptyState(
              icon: Icons.hourglass_empty,
              title: l10n.noAssigned,
              message: l10n.noAssignedMessage,
            );
          } else {
            return RefreshIndicator(
              onRefresh: () async {
                setState(() => _grievancesFuture = _fetchAssignedGrievances());
              },
              child: ListView.builder(
                padding: const EdgeInsets.all(16.0),
                itemCount: snapshot.data!.length,
                itemBuilder: (context, index) {
                  final grievance = snapshot.data![index];
                  return _buildGrievanceItem(grievance);
                },
              ),
            );
          }
        },
      ),
    );
  }
}

=== Folder: screens\member_head ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\screens\member_head\view_grievances.dart ---
import 'package:dio/dio.dart';
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/models/grievance_model.dart';
import 'package:main_ui/services/api_service.dart';
import 'package:main_ui/widgets/empty_state.dart';
import 'package:main_ui/widgets/loading_indicator.dart';
import 'package:main_ui/widgets/status_badge.dart';
import 'package:main_ui/widgets/navigation_drawer.dart';

class ViewGrievances extends StatefulWidget {
  const ViewGrievances({super.key});

  @override
  State<ViewGrievances> createState() => _ViewGrievancesState();
}

class _ViewGrievancesState extends State<ViewGrievances> {
  List<Grievance> grievances = [];
  List<Grievance> filteredGrievances = [];
  bool isLoading = true;
  String? selectedStatus;
  String? selectedPriority;
  String? selectedArea;
  String? selectedSubject;
  List<Map<String, dynamic>> areas = [];
  List<Map<String, dynamic>> subjects = [];
  List<Map<String, dynamic>> fieldStaff = [];
  String errorMessage = '';
  final CancelToken _cancelToken = CancelToken();

  final List<String> statuses = [
    'new',
    'in_progress',
    'on_hold',
    'resolved',
    'closed',
    'rejected'
  ];

  final List<String> priorities = ['low', 'medium', 'high', 'urgent'];

  @override
  void initState() {
    super.initState();
    _loadData();
  }

  @override
  void dispose() {
    _cancelToken.cancel();
    super.dispose();
  }

  Future<void> _loadData() async {
    if (!mounted) return;
    setState(() {
      isLoading = true;
      errorMessage = '';
    });

    try {
      final response = await ApiService.get('/grievances/all');
     

      if (response.data is! List) {
        throw Exception("Expected a list from API, got ${response.data.runtimeType}");
      }

      grievances = (response.data as List).map((e) {
        try {
          return Grievance.fromJson(e);
        } catch (e) {
          rethrow;
        }
      }).toList();

      filteredGrievances = List.from(grievances);
    

      final areasResponse = await ApiService.get('/areas');
      areas = (areasResponse.data as List?)
              ?.map((a) => {"id": a["id"].toString(), "name": a["name"] ?? "Unknown"})
              .toSet() // removes duplicates
              .toList() ?? [];

      final subjectsResponse = await ApiService.get('/subjects');
      subjects = (subjectsResponse.data as List?)
              ?.map((s) => {"id": s["id"].toString(), "name": s["name"] ?? "Unknown"})
              .toSet() // removes duplicates
              .toList() ?? [];

      final staffResponse = await ApiService.get('/fieldStaff/fieldStaff?role=field_staff');
      fieldStaff = (staffResponse.data as List?)
              ?.map((s) => {"id": s["id"].toString(), "name": s["name"] ?? "Unknown"})
              .toSet() // removes duplicates
              .toList() ?? [];
    } catch (e) {
      
      if (mounted) {
        setState(() {
          errorMessage = e.toString();
        });
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text(AppLocalizations.of(context)!.error)),
        );
      }
    } finally {
      if (mounted) {
        setState(() {
          isLoading = false;
        });
      }
    }
  }

  void _resetFilters() {
    setState(() {
      selectedStatus = null;
      selectedPriority = null;
      selectedArea = null;
      selectedSubject = null;
      _applyFilters();
    });
  }

  void _applyFilters() {
    filteredGrievances = grievances.where((g) {
      return (selectedStatus == null || g.status == selectedStatus) &&
          (selectedPriority == null || g.priority == selectedPriority) &&
          (selectedArea == null || g.areaId.toString() == selectedArea) &&
          (selectedSubject == null || g.subjectId.toString() == selectedSubject);
    }).toList();
    if (mounted) {
      setState(() {});
    }
  }

  void _showActionSheet(Grievance grievance) {
  final isFinalStatus = ['resolved', 'closed', 'rejected']
      .contains(grievance.status?.toLowerCase());

  final alreadyAssigned = grievance.assignedTo != null; // ✅ check if assigned

  showModalBottomSheet(
    context: context,
    backgroundColor: Colors.white,
    shape: const RoundedRectangleBorder(
      borderRadius: BorderRadius.vertical(top: Radius.circular(20)),
    ),
    builder: (ctx) => SafeArea(
      child: ListView(
        shrinkWrap: true,
        padding: const EdgeInsets.all(16),
        children: [
          // Update Status
          ListTile(
            enabled: !isFinalStatus,
            leading: Icon(Icons.update,
                color: isFinalStatus ? Colors.grey : Colors.blue),
            title: Text(
              AppLocalizations.of(context)!.updateStatus,
              style: TextStyle(
                  fontWeight: FontWeight.w500,
                  color: isFinalStatus ? Colors.grey : null),
            ),
            onTap: isFinalStatus
                ? null
                : () {
                    Navigator.pop(ctx);
                    _showUpdateStatusDialog(grievance);
                  },
          ),
          const Divider(height: 1),

          // Assign Grievance
          ListTile(
            enabled: !alreadyAssigned, // ✅ disable if already assigned
            leading: Icon(Icons.assignment_ind,
                color: alreadyAssigned ? Colors.grey : Colors.blue),
            title: Text(
              AppLocalizations.of(context)!.assignGrievance,
              style: TextStyle(
                fontWeight: FontWeight.w500,
                color: alreadyAssigned ? Colors.grey : null,
              ),
            ),
            onTap: alreadyAssigned
                ? null
                : () {
                    Navigator.pop(ctx);
                    _showAssignDialog(grievance);
                  },
          ),
          const Divider(height: 1),

          // Reject
          ListTile(
            leading: const Icon(Icons.cancel, color: Colors.red),
            title: Text(AppLocalizations.of(context)!.rejectGrievance,
                style: const TextStyle(
                    fontWeight: FontWeight.w500, color: Colors.red)),
            onTap: () {
              Navigator.pop(ctx);
              _showRejectDialog(grievance);
            },
          ),
          const Divider(height: 1),

          // View Details
          ListTile(
            leading: const Icon(Icons.visibility, color: Colors.blue),
            title: Text(AppLocalizations.of(context)!.viewDetails,
                style: const TextStyle(fontWeight: FontWeight.w500)),
            onTap: () {
              Navigator.pop(ctx);
              Navigator.pushNamed(context, '/citizen/detail',
                  arguments: grievance.id);
            },
          ),
        ],
      ),
    ),
  );
}


  void _showUpdateStatusDialog(Grievance grievance) {
    String? newStatus;
    showDialog(
      context: context,
      builder: (ctx) => AlertDialog(
        title: Text(AppLocalizations.of(context)!.updateStatus,
            style: const TextStyle(fontWeight: FontWeight.bold)),
        backgroundColor: Colors.white,
        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
        content: DropdownButtonFormField<String>(
          initialValue: newStatus,
          decoration: InputDecoration(
            filled: true,
            fillColor: const Color(0xffecf2fe),
            border: OutlineInputBorder(
              borderRadius: BorderRadius.circular(12),
              borderSide: BorderSide.none,
            ),
          ),
          hint: Text(AppLocalizations.of(context)!.selectStatus),
          items: statuses.map((s) => DropdownMenuItem(value: s, child: Text(s))).toList(),
          onChanged: (value) => newStatus = value,
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(ctx),
            child: Text(AppLocalizations.of(context)!.cancel,
                style: const TextStyle(color: Colors.grey)),
          ),
          ElevatedButton(
            style: ElevatedButton.styleFrom(
              backgroundColor: Colors.blue,
              shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
            ),
            onPressed: () async {
              if (newStatus != null) {
                try {
                  await ApiService.put('/grievances/${grievance.id}/status', {'status': newStatus});
                  if (context.mounted) Navigator.pop(ctx);
                  _loadData();
                } catch (e) {
                  if (context.mounted) {
                    ScaffoldMessenger.of(context).showSnackBar(SnackBar(content: Text(e.toString())));
                  }
                }
              }
            },
            child: Text(AppLocalizations.of(context)!.update,
                style: const TextStyle(color: Colors.white)),
          ),
        ],
      ),
    );
  }

  void _showAssignDialog(Grievance grievance) {
    String? assigneeId;
    showDialog(
      context: context,
      builder: (ctx) => AlertDialog(
        title: Text(AppLocalizations.of(context)!.assignGrievance,
            style: const TextStyle(fontWeight: FontWeight.bold)),
        backgroundColor: Colors.white,
        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
        content: DropdownButtonFormField<String>(
          initialValue: assigneeId,
          decoration: InputDecoration(
            filled: true,
            fillColor: const Color(0xffecf2fe),
            border: OutlineInputBorder(
              borderRadius: BorderRadius.circular(12),
              borderSide: BorderSide.none,
            ),
          ),
          hint: Text(AppLocalizations.of(context)!.selectAssignee),
          items: fieldStaff.map((staff) => DropdownMenuItem(value: staff['id'].toString(), child: Text(staff['name'] ?? 'Unknown'))).toList(),
          onChanged: (value) => assigneeId = value,
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(ctx),
            child: Text(AppLocalizations.of(context)!.cancel,
                style: const TextStyle(color: Colors.grey)),
          ),
          ElevatedButton(
            style: ElevatedButton.styleFrom(
              backgroundColor: Colors.blue,
              shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
            ),
            onPressed: () async {
              if (assigneeId != null) {
                try {
                  await ApiService.put('/grievances/${grievance.id}/reassign', {'assigned_to': assigneeId});
                  if (context.mounted) Navigator.pop(ctx);
                  _loadData();
                } catch (e) {
                  if (context.mounted) {
                    ScaffoldMessenger.of(context).showSnackBar(SnackBar(content: Text(e.toString())));
                  }
                }
              }
            },
            child: Text(AppLocalizations.of(context)!.assignGrievance,
                style: const TextStyle(color: Colors.white)),
          ),
        ],
      ),
    );
  }

  void _showRejectDialog(Grievance grievance) {
    final TextEditingController reasonController = TextEditingController();
    showDialog(
      context: context,
      builder: (ctx) => AlertDialog(
        title: Text(AppLocalizations.of(context)!.rejectGrievance,
            style: const TextStyle(fontWeight: FontWeight.bold)),
        backgroundColor: Colors.white,
        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
        content: TextField(
          controller: reasonController,
          maxLines: 3,
          decoration: InputDecoration(
            hintText: AppLocalizations.of(context)!.rejectionReason ?? 'Enter rejection reason',
            filled: true,
            fillColor: const Color(0xffecf2fe),
            border: OutlineInputBorder(
              borderRadius: BorderRadius.circular(12),
              borderSide: BorderSide.none,
            ),
          ),
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(ctx),
            child: Text(AppLocalizations.of(context)!.cancel,
                style: const TextStyle(color: Colors.grey)),
          ),
          ElevatedButton(
            style: ElevatedButton.styleFrom(
              backgroundColor: Colors.red,
              shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
            ),
            onPressed: () async {
              final reason = reasonController.text;
              if (reason.isNotEmpty) {
                try {
                  await ApiService.post('/grievances/${grievance.id}/reject', {'reason': reason});
                  if (context.mounted) Navigator.pop(ctx);
                  _loadData();
                } catch (e) {
                  if (context.mounted) {
                    ScaffoldMessenger.of(context).showSnackBar(SnackBar(content: Text(e.toString())));
                  }
                }
              }
            },
            child: Text(AppLocalizations.of(context)!.reject,
                style: const TextStyle(color: Colors.white)),
          ),
        ],
      ),
    );
  }

  @override
  Widget build(BuildContext context) {
    final l = AppLocalizations.of(context)!;
    final theme = Theme.of(context);

    return Scaffold(
      backgroundColor: const Color(0xfff8fbff),
      appBar: AppBar(
        title: Text(l.viewgrievanceetails),
        backgroundColor: theme.appBarTheme.backgroundColor,
        foregroundColor: theme.appBarTheme.foregroundColor,
        elevation: theme.appBarTheme.elevation,
      ),
      drawer: const CustomNavigationDrawer(),
      body: isLoading
          ? const LoadingIndicator()
          : SingleChildScrollView(
              child: Column(
                mainAxisSize: MainAxisSize.min,
                children: [
                  grievances.isEmpty
                      ? EmptyState(
                          icon: Icons.hourglass_empty,
                          title: l.noGrievances,
                          message: l.noGrievancesMessage,
                          actionButton: ElevatedButton(
                            onPressed: _loadData,
                            style: ElevatedButton.styleFrom(
                              backgroundColor: Colors.blue,
                              shape: RoundedRectangleBorder(
                                borderRadius: BorderRadius.circular(12),
                              ),
                            ),
                            child: Text(l.retry, style: const TextStyle(color: Colors.white)),
                          ),
                        )
                      : RefreshIndicator(
                          onRefresh: _loadData,
                          child: ListView.builder(
                            shrinkWrap: true,
                            physics: const NeverScrollableScrollPhysics(),
                            itemCount: filteredGrievances.length + 1, // +1 for the filter section
                            itemBuilder: (ctx, i) {
                              if (i == 0) {
                                // The first item is the filter section
                                return Container(
                                  margin: const EdgeInsets.only(bottom: 16),
                                  padding: const EdgeInsets.all(16),
                                  color: Colors.white,
                                  child: Column(
                                    crossAxisAlignment: CrossAxisAlignment.start,
                                    children: [
                                    Row(
                                      mainAxisAlignment: MainAxisAlignment.spaceBetween,
                                      children: [
                                        const Text("Filters", style: TextStyle(fontWeight: FontWeight.bold, fontSize: 16)),
                                        TextButton.icon(
                                          onPressed: _resetFilters,
                                          icon: const Icon(Icons.clear_all, size: 18),
                                          label: Text(l.clearFilters),
                                        ),
                                      ],
                                    ),
                                      const SizedBox(height: 12),
                                      Wrap(
                                        spacing: 12,
                                        runSpacing: 12,
                                        children: [
                                          _buildFilterDropdown(l.filterByStatus, statuses, selectedStatus, (v) {
                                            selectedStatus = v;
                                            _applyFilters();
                                          }),
                                          _buildFilterDropdown(l.filterByPriority, priorities, selectedPriority, (v) {
                                            selectedPriority = v;
                                            _applyFilters();
                                          }),
                                          _buildFilterDropdown(
                                            l.filterByArea,
                                            areas,
                                            selectedArea, (v) {
                                            setState(() {
                                              selectedArea = v;
                                              _applyFilters();
                                            });
                                          },
                                          ),
                                          _buildFilterDropdown(
                                            l.filterBySubject,
                                            subjects,
                                            selectedSubject, (v) {
                                            setState(() {
                                              selectedSubject = v;
                                              _applyFilters();
                                            });
                                          },
                                          ),
                                        ],
                                      ),
                                    ],
                                  ),
                                );
                              }
                              final g = filteredGrievances[i - 1]; // Adjust index for grievance items
                              return Container(
                                margin: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
                                decoration: BoxDecoration(
                                  color: const Color(0xffecf2fe),
                                  borderRadius: BorderRadius.circular(16),
                                  boxShadow: [
                                    BoxShadow(
                                      color: Colors.black.withOpacity(0.1),
                                      blurRadius: 6,
                                      offset: const Offset(0, 2),
                                    ),
                                  ],
                                ),
                                child: Padding(
                                  padding: const EdgeInsets.all(16),
                                  child: Column(
                                    crossAxisAlignment: CrossAxisAlignment.start,
                                    children: [
                                      Row(
                                        mainAxisAlignment: MainAxisAlignment.spaceBetween,
                                        children: [
                                          Expanded(
                                            child: Text(g.title ?? 'Untitled',
                                                style: const TextStyle(
                                                    fontWeight: FontWeight.bold, fontSize: 16)),
                                          ),
                                          StatusBadge(status: g.status ?? 'new'),
                                        ],
                                      ),
                                      const SizedBox(height: 12),
                                      Text(g.description ?? '',
                                          style: TextStyle(color: Colors.grey[700])),
                                      const SizedBox(height: 12),
                                      Row(
                                        mainAxisAlignment: MainAxisAlignment.spaceBetween,
                                        children: [
                                          if (g.priority != null)
                                            Chip(
                                              label: Text(g.priority!,
                                                  style: const TextStyle(fontSize: 12, color: Colors.white)),
                                              backgroundColor: _getPriorityColor(g.priority!),
                                              padding: const EdgeInsets.symmetric(horizontal: 8),
                                            ),
                                          const Spacer(),
                                          ElevatedButton(
                                            style: ElevatedButton.styleFrom(
                                              backgroundColor: Colors.blue,
                                              shape: RoundedRectangleBorder(
                                                borderRadius: BorderRadius.circular(12),
                                              ),
                                            ),
                                            onPressed: () => _showActionSheet(g),
                                            child: Text(l.takeAction ?? 'Take Action',
                                                style: const TextStyle(color: Colors.white)),
                                          ),
                                        ],
                                      ),
                                    ],
                                  ),
                                ),
                              );
                            },
                          ),
                        ),
                  /* This was the old structure that caused the overflow
                  Column(
                    mainAxisSize: MainAxisSize.min,
                    children: [
                      Container(
                        padding: const EdgeInsets.all(16),
                        color: Colors.white,
                        child: Column(
                          crossAxisAlignment: CrossAxisAlignment.start,
                          children: [
                            const Text("Filters",
                                style: TextStyle(fontWeight: FontWeight.bold, fontSize: 16)),
                            const SizedBox(height: 12),
                            Wrap(
                              spacing: 12,
                              runSpacing: 12,
                                  children: [
                                    _buildFilterDropdown(
                                      l.filterByStatus,
                                      statuses,
                                      selectedStatus,
                                      (v) {
                                        setState(() {
                                          selectedStatus = v;
                                          _applyFilters();
                                        });
                                      },
                                    ),
                                    _buildFilterDropdown(
                                      l.filterByPriority,
                                      priorities,
                                      selectedPriority,
                                      (v) {
                                        setState(() {
                                          selectedPriority = v;
                                          _applyFilters();
                                        });
                                      },
                                    ),
                                    _buildFilterDropdown(
                                      l.filterByArea,
                                      areas.map((a) => a['name'] as String).toList(),
                                      areas.firstWhere((a) => a['id'] == selectedArea, orElse: () => {'name': null})['name'],
                                      (v) {
                                        setState(() {
                                          selectedArea = v == null ? null : areas.firstWhere((a) => a['name'] == v)['id'];
                                          _applyFilters();
                                        });
                                      },
                                    ),
                                    _buildFilterDropdown(
                                      l.filterBySubject,
                                      subjects.map((s) => s['name'] as String).toList(),
                                      subjects.firstWhere((s) => s['id'] == selectedSubject, orElse: () => {'name': null})['name'],
                                      (v) {
                                        setState(() {
                                          selectedSubject = v == null ? null : subjects.firstWhere((s) => s['name'] == v)['id'];
                                          _applyFilters();
                                        });
                                      },
                                    ),
                                  ],
                            ),
                          ],
                        ),
                      ),
                      const SizedBox(height: 16),
                      RefreshIndicator(
                        onRefresh: _loadData,
                        child: ListView.builder(
                                shrinkWrap: true,
                                physics: const NeverScrollableScrollPhysics(),
                                itemCount: filteredGrievances.length,
                                itemBuilder: (ctx, i) {
                                  final g = filteredGrievances[i];
                                  return Container(
                                    margin: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
                                    decoration: BoxDecoration(
                                      color: const Color(0xffecf2fe),
                                      borderRadius: BorderRadius.circular(16),
                                      boxShadow: [
                                        BoxShadow(
                                          color: Colors.black.withOpacity(0.1),
                                          blurRadius: 6,
                                          offset: const Offset(0, 2),
                                        ),
                                      ],
                                    ),
                                    child: Padding(
                                      padding: const EdgeInsets.all(16),
                                      child: Column(
                                        crossAxisAlignment: CrossAxisAlignment.start,
                                        children: [
                                          Row(
                                            mainAxisAlignment: MainAxisAlignment.spaceBetween,
                                            children: [
                                              Expanded(
                                                child: Text(g.title ?? 'Untitled',
                                                    style: const TextStyle(
                                                        fontWeight: FontWeight.bold, fontSize: 16)),
                                              ),
                                              StatusBadge(status: g.status ?? 'new'),
                                            ],
                                          ),
                                          const SizedBox(height: 12),
                                          Text(g.description ?? '',
                                              style: TextStyle(color: Colors.grey[700])),
                                          const SizedBox(height: 12),
                                          Row(
                                            mainAxisAlignment: MainAxisAlignment.spaceBetween,
                                            children: [
                                              if (g.priority != null)
                                                Chip(
                                                  label: Text(g.priority!,
                                                      style: const TextStyle(fontSize: 12, color: Colors.white)),
                                                  backgroundColor: _getPriorityColor(g.priority!),
                                                  padding: const EdgeInsets.symmetric(horizontal: 8),
                                                ),
                                              const Spacer(),
                                              ElevatedButton(
                                                style: ElevatedButton.styleFrom(
                                                  backgroundColor: Colors.blue,
                                                  shape: RoundedRectangleBorder(
                                                    borderRadius: BorderRadius.circular(12),
                                                  ),
                                                ),
                                                onPressed: () => _showActionSheet(g),
                                                child: Text(l.takeAction ?? 'Take Action',
                                                    style: const TextStyle(color: Colors.white)),
                                              ),
                                            ],
                                          ),
                                        ],
                                      ),
                                    ),
                                  );
                                },
                              ),
                      ),
                    ],
                  ),*/
                ],
              ),
            ),
    );
  }

  Widget _buildFilterDropdown(
    String label,
    dynamic items,
    String? selected,
    ValueChanged<String?> onChanged,
  ) {
    List<DropdownMenuItem<String?>> dropdownItems = [];

    // Default "All" option
    dropdownItems.add(const DropdownMenuItem(
      value: null,
      child: Text("All", style: TextStyle(color: Colors.grey)),
    ));

    if (items is List<String>) {
      // Handle plain string lists (status, priority)
      dropdownItems.addAll(
        items.map(
          (s) => DropdownMenuItem(
        value: s,
        child: Text(s, overflow: TextOverflow.ellipsis), // Prevent long text overflow
      ),
        ),
      );
    } else if (items is List<Map<String, dynamic>>) { // Handle maps with {id, name} (areas, subjects, staff)
      // Handle maps with {id, name} (areas, subjects, staff)
      dropdownItems.addAll(
        items.map(
          (m) => DropdownMenuItem(
            value: m['id']?.toString(),
            child: Text(m['name'] ?? 'Unknown'),
          ),
        ), // Prevent long text overflow
      );
    }

    return Container(
      padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 4),
      decoration: BoxDecoration(
        color: const Color(0xffecf2fe),
        borderRadius: BorderRadius.circular(12),
      ),
      child: Row(
      children: [
        Expanded(
          child: DropdownButton<String?>(
            hint: Text(label, style: const TextStyle(fontSize: 14)),
            value: selected,
            items: dropdownItems,
            onChanged: onChanged,
            underline: const SizedBox(),
            icon: const Icon(Icons.arrow_drop_down, color: Colors.blue),
            isDense: true,
            isExpanded: true, // ✅ fixes overflow issue
            borderRadius: BorderRadius.circular(12),
          ),
        ),
      ],
    ),
    );
  }

  Color _getPriorityColor(String priority) {
    switch (priority) {
      case 'low':
        return Colors.green;
      case 'medium':
        return Colors.orange;
      case 'high':
        return Colors.orangeAccent;
      case 'urgent':
        return Colors.red;
      default:
        return Colors.grey;
    }
  }
}

=== Folder: services ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\services\admin_service.dart ---
import 'api_service.dart';  // Add this import

class AdminService {
  static Future<Map<String, dynamic>> getDashboard() async {
    try {
      final response = await ApiService.get('/admin/dashboard'); // Assuming an endpoint
      return response.data;
    } catch (e) {
      throw Exception('Failed to load dashboard data');
    }
  }

  static Future<List<dynamic>> getAuditLogs() async {
  try {
    final response = await ApiService.get('/admin/audit-logs');
    return response.data as List<dynamic>;
  } catch (e) {
    throw Exception('Failed to load audit logs: $e');
  }
}
}


--- File: D:\Company_Data\PCMCApp\main_ui\lib\services\api_service.dart ---
import 'package:dio/dio.dart';
import 'package:flutter/foundation.dart' show kIsWeb;
import 'package:main_ui/models/user_model.dart';
import 'package:main_ui/services/auth_service.dart';
import 'package:main_ui/utils/constants.dart';
import 'package:logging/logging.dart';
import 'package:file_picker/file_picker.dart';

final Logger _logger = Logger('ApiService');

class ApiService {
  static final Dio _dio = Dio();

  static Future<void> init() async {
    _dio.options.baseUrl = Constants.baseUrl;
    _dio.options.connectTimeout = Duration(seconds: 10);
    _dio.options.receiveTimeout = Duration(seconds: 15);
    _dio.options.headers = {'Content-Type': 'application/json'};

    // Add interceptor to attach JWT token
    _dio.interceptors.add(InterceptorsWrapper(
      onRequest: (options, handler) async {
        final token = await AuthService.getToken();
        if (token != null && token.isNotEmpty) {
          options.headers['Authorization'] = 'Bearer $token';
          _logger.fine('Added Authorization header with token');
        } else {
          _logger.warning('No token available for request: ${options.path}');
        }
        return handler.next(options);
      },
      onError: (DioException error, handler) async {
        if (error.response?.statusCode == 401) {
          _logger.warning('Unauthorized request: ${error.requestOptions.path}. Logging out.');
          await AuthService.logout();
          // Optionally trigger navigation to login screen via a provider or event
        }
        return handler.next(error);
      },
    ));

    _logger.info('ApiService initialized with base URL: ${Constants.baseUrl}');
  }

  // Generic GET method
  static Future<Response> get(
    String path, {
    Map<String, dynamic>? headers,
    ResponseType? responseType,
    Options? options,
  }) async {
    final mergedOptions = options ??
        Options(
          headers: headers,
          responseType: responseType,
        );
    
    final url = _dio.options.baseUrl + path;
    
    try {
      return await _dio.get(path, options: mergedOptions);
    } on DioException catch (e) {
      _logger.severe('GET request failed: $path, Error: ${e.message}');
      rethrow;
    }
  }

  // Generic POST method
  static Future<Response> post(
    String path,
    dynamic data, {
    Map<String, dynamic>? headers,
    ResponseType? responseType,
  }) async {
    try {
      return await _dio.post(
        path,
        data: data,
        options: Options(
          headers: headers,
          responseType: responseType,
        ),
      );
    } on DioException catch (e) {
      _logger.severe('POST request failed: $path, Error: ${e.message}');
      rethrow;
    }
  }

  // Generic POST method for multipart data (file uploads)
// Generic POST method for multipart data (file uploads)
static Future<Response> postMultipart(
  String path, {
  required List<PlatformFile> files,
  Map<String, dynamic>? data,
  String fieldName = 'files', // ✅ default field name
}) async {
  try {
    final formData = FormData.fromMap({
      ...?data,
      fieldName: files.length == 1
          ? MultipartFile.fromBytes(files.first.bytes!, filename: files.first.name)
          : files
              .map((file) => MultipartFile.fromBytes(file.bytes!, filename: file.name))
              .toList(),
    });

    return await _dio.post(
      path,
      data: formData,
    );
  } on DioException catch (e) {
    _logger.severe('Multipart POST request failed: $path, Error: ${e.message}');
    rethrow;
  }
}

  // Generic PUT method
  static Future<Response> put(
    String path,
    dynamic data, {
    Map<String, dynamic>? headers,
    ResponseType? responseType,
  }) async {
    try {
      return await _dio.put(
        path,
        data: data,
        options: Options(
          headers: headers,
          responseType: responseType,
        ),
      );
    } on DioException catch (e) {
      _logger.severe('PUT request failed: $path, Error: ${e.message}');
      rethrow;
    }
  }

  // Generic DELETE method
  static Future<Response> delete(
    String path, {
    Map<String, dynamic>? headers,
    ResponseType? responseType,
  }) async {
    try {
      return await _dio.delete(
        path,
        options: Options(
          headers: headers,
          responseType: responseType,
        ),
      );
    } on DioException catch (e) {
      _logger.severe('DELETE request failed: $path, Error: ${e.message}');
      rethrow;
    }
  }

  // Fetch all users
  static Future<List<User>> getUsers() async {
    try {
      final response = await _dio.get('/admins/users');
      final List<dynamic> data = response.data;
      return data.map((json) => User.fromJson(json)).toList();
    } on DioException catch (e) {
      _logger.severe('Failed to load users: ${e.message}');
      throw Exception('Failed to load users: ${e.message}');
    }
  }

  // Add or update a user
  static Future<User> addUpdateUser(Map<String, dynamic> data) async {
    try {
      Response response;
      final id = data['id']?.toString();
      print('Sending data to API: $data');

      if (id != null && id.isNotEmpty) {
        response = await _dio.put('/admins/users/$id', data: data);
      } else {
        response = await _dio.post('/admins/users', data: data);
      }
      _logger.info('API response: ${response.data}');
      return User.fromJson(response.data);
    } on DioException catch (e) {
      _logger.severe('DioException in addUpdateUser: ${e.response?.data} - ${e.message}');
      throw Exception('Failed to add/update user: ${e.response?.data?['msg'] ?? e.message}');
    }
  }



  // Upload profile picture
  static Future<Map<String, dynamic>> uploadProfilePicture(PlatformFile file) async {
    try {
      final formData = FormData.fromMap({
        'file': MultipartFile.fromBytes(file.bytes!, filename: file.name),
      });
      final response = await _dio.post('/users/profile-picture', data: formData);
      return response.data as Map<String, dynamic>;
    } on DioException catch (e) {
      _logger.severe('Failed to upload profile picture: ${e.message}');
      throw Exception('Failed to upload profile picture: ${e.message}');
    }
  }







  

static Future<User> updateProfile({
  String? name,
  String? email,
  String? password,
  String? address,
  PlatformFile? profilePic,
}) async {
  try {
    final token = await AuthService.getToken();

    final Map<String, dynamic> fields = {};

    if (name != null) fields['name'] = name;
    if (email != null) fields['email'] = email;
    if (password != null && password.isNotEmpty) fields['password'] = password;
    if (address != null) fields['address'] = address;

    // Handle file upload (web vs mobile)
    if (profilePic != null) {
      if (kIsWeb) {
        fields['profile_picture'] = MultipartFile.fromBytes(
          profilePic.bytes!,
          filename: profilePic.name,
        );
      } else {
        fields['profile_picture'] = await MultipartFile.fromFile(
          profilePic.path!,
          filename: profilePic.name,
        );
      }
    }

    final formData = FormData.fromMap(fields);

    final response = await _dio.put(
      '/auth/me',
      data: formData,
      options: Options(
        headers: {
          'Authorization': 'Bearer $token',
        },
      ),
    );

    return User.fromJson(response.data as Map<String, dynamic>);
  } on DioException catch (e) {
    final errorMsg = e.response?.data ?? e.message;
    _logger.severe('Failed to update profile: $errorMsg');
    throw Exception('Failed to update profile: $errorMsg');
  }
}

  // Fetch area by ID
  static Future<Map<String, dynamic>?> getMasterArea(int areaId) async {
    try {
      final response = await _dio.get('/areas/$areaId');
      return response.data as Map<String, dynamic>?;
    } on DioException catch (e) {
      _logger.severe('Failed to fetch area $areaId: ${e.message}');
      throw Exception('Failed to fetch area: ${e.message}');
    }
  }

  // Delete a user
  static Future<void> deleteUser(int userId) async {
    try {
      final url = '${_dio.options.baseUrl}/admins/users/$userId';
      _logger.info('🔗 DELETE URL: $url');
      await _dio.delete('/admins/users/$userId');
    } on DioException catch (e) {
      _logger.severe('Failed to delete user $userId: ${e.message}');
      throw Exception('Failed to delete user: ${e.message}');
    }
  }

  // Fetch a specific grievance by ID
  static Future<Response> getGrievance(int id) async {
    try {
      final response = await _dio.get('/grievances/$id');
      return response;
    } on DioException catch (e) {
      _logger.severe('Failed to fetch grievance $id: ${e.message}');
      throw Exception('Failed to fetch grievance: ${e.message}');
    }
  }

  static Dio get dio => _dio;
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\services\auth_service.dart ---
import 'dart:async';
import 'package:firebase_auth/firebase_auth.dart' as fb_auth;
import 'package:firebase_core/firebase_core.dart';
import 'package:flutter_web_auth_2/flutter_web_auth_2.dart';

import 'package:http/http.dart' as http;
import 'package:shared_preferences/shared_preferences.dart';
import 'dart:convert';
import '../models/user_model.dart';
import '../firebase_options.dart';
import 'package:main_ui/utils/constants.dart';

class AuthService {
  static final String _baseUrl = Constants.baseUrl; // Update with your backend URL
  static final fb_auth.FirebaseAuth _firebaseAuth = fb_auth.FirebaseAuth.instance;
  static String? _token;
  static final _authStateController = StreamController<String?>.broadcast();

  // Stream to notify UI about auth changes
  static Stream<String?> get authStateChanges => _authStateController.stream;

  // Initialize SharedPreferences once
  static Future<SharedPreferences> get _storage async {
    return await SharedPreferences.getInstance();
  }

  /// Initializes the AuthService
  static Future<void> initialize() async {
    await Firebase.initializeApp(
      options: DefaultFirebaseOptions.currentPlatform,
    );
    final prefs = await _storage;
    _token = prefs.getString('access_token');
    _authStateController.add(_token); // Notify initial token state
  }

  /// Stores backend JWT token
  static Future<String?> setToken(Map<String, dynamic> response) async {
    final backendToken = response['access_token'];
    if (backendToken == null || backendToken.isEmpty) {
      throw Exception('Invalid token received');
    }
    final prefs = await _storage;
    await prefs.setString('access_token', backendToken);
    _token = backendToken;
    _authStateController.add(backendToken); // Notify token change
    return backendToken;
  }

  /// Public method to store a token (for external use if needed)
  static Future<void> storeToken(String token) async {
    if (token.isEmpty) {
      throw Exception('Cannot store empty token');
    }
    final prefs = await _storage;
    await prefs.setString('access_token', token);
    _token = token;
    _authStateController.add(token); // Notify token change
  }

  /// Initiates Google Sign-In flow using backend OAuth
  static Future<void> googleLogin() async {
    try {
      final result = await FlutterWebAuth2.authenticate(
        url: '$_baseUrl/auth/google',
        callbackUrlScheme: 'com.example.mainUi', // Update with your app's scheme
      );
      final response = await http.get(
        Uri.parse('$_baseUrl/auth/google/callback?$result'),
      );
      if (response.statusCode == 200) {
        final data = json.decode(response.body);
        await setToken(data);
      } else {
        throw Exception(json.decode(response.body)['msg'] ?? 'Google login failed');
      }
    } catch (e) {
      
      rethrow;
    }
  }

  /// Registers a new user with email and password
  static Future<void> register(
    String name,
    String email,
    String password, {
    String? address,
    String? phoneNumber,
    String? voterId,
  }) async {
    try {
      final Map<String, dynamic> body = {
        'name': name,
        'email': email,
        'password': password,
        'role': 'citizen',
        if (address != null) 'address': address,
        if (phoneNumber != null) 'phone_number': phoneNumber,
        if (voterId != null) 'voter_id': voterId,
      };
      final response = await http.post(
        Uri.parse('$_baseUrl/auth/register'),
        headers: {'Content-Type': 'application/json'},
        body: json.encode(body),
      );
      if (response.statusCode == 200) {
        await passwordLogin(email, password); // Auto-login after registration
      } else {
        throw Exception(json.decode(response.body)['msg'] ?? 'Registration failed');
      }
    } catch (e) {
     
      rethrow;
    }
  }

  /// Signs in a user with email and password
  static Future<void> passwordLogin(String email, String password) async {
    try {
      final response = await http.post(
        Uri.parse('$_baseUrl/auth/login'),
        headers: {'Content-Type': 'application/json'},
        body: json.encode({'email': email, 'password': password}),
      );
      if (response.statusCode == 200) {
        final data = json.decode(response.body);
        await setToken(data);
      } else {
        throw Exception(json.decode(response.body)['msg'] ?? 'Login failed');
      }
    } catch (e) {
     
      rethrow;
    }
  }

  /// Requests OTP for mobile login
  static Future<void> requestOtp(String phoneNumber) async {
    try {
      final response = await http.post(
        Uri.parse('$_baseUrl/auth/otp/request'),
        headers: {'Content-Type': 'application/json'},
        body: json.encode({'phone_number': phoneNumber}),
      );
      if (response.statusCode != 200) {
        throw Exception(json.decode(response.body)['msg'] ?? 'Failed to request OTP');
      }
    } catch (e) {
      
      rethrow;
    }
  }

  /// Verifies OTP for mobile login
  static Future<void> verifyOtp(String phoneNumber, String otp) async {
    try {
      final response = await http.post(
        Uri.parse('$_baseUrl/auth/otp/verify'),
        headers: {'Content-Type': 'application/json'},
        body: json.encode({'phone_number': phoneNumber, 'otp': otp}),
      );
      if (response.statusCode == 200) {
        final data = json.decode(response.body);
        await setToken(data);
      } else {
        throw Exception(json.decode(response.body)['msg'] ?? 'OTP verification failed');
      }
    } catch (e) {
      
      rethrow;
    }
  }

  /// Fetches the current user's profile from the backend
  static Future<User?> getCurrentUser() async {
    try {
      final token = await getToken();
      if (token == null || token.isEmpty) return null;
      final response = await http.get(
        Uri.parse('$_baseUrl/auth/me'),
        headers: {'Authorization': 'Bearer $token'},
      );
      if (response.statusCode == 200) {
        return User.fromJson(json.decode(response.body));
      } else {
        await logout();
        return null;
      }
    } catch (e) {
      
      return null;
    }
  }

  /// Signs out the current user
  static Future<void> logout() async {
    try {
      final prefs = await _storage;
      await prefs.remove('access_token');
      _token = null;
      _authStateController.add(null); // Notify token cleared
      await _firebaseAuth.signOut();
    } catch (e) {
      rethrow;
    }
  }

  /// Gets the stored backend JWT
  static Future<String?> getToken() async {
    if (_token != null && _token!.isNotEmpty) return _token;
    final prefs = await _storage;
    _token = prefs.getString('access_token');
    return _token?.isNotEmpty == true ? _token : null;
  }

  /// Closes the auth state stream
  static void dispose() {
    _authStateController.close();
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\services\file_service.dart ---
// lib/services/file_service.dart
import 'package:file_picker/file_picker.dart';

class FileService {
  static Future<List<PlatformFile>> pickFiles() async {
    FilePickerResult? result = await FilePicker.platform.pickFiles(
      allowMultiple: true,
      type: FileType.custom,
      allowedExtensions: ['pdf', 'jpg', 'jpeg'],
    );
    if (result != null) {
      return result.files;
    }
    return [];
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\services\grievance_service.dart ---
import 'package:dio/dio.dart';
import 'package:flutter/foundation.dart';
import 'package:file_picker/file_picker.dart';
import '../models/grievance_model.dart';
import 'api_service.dart';
import 'package:geolocator/geolocator.dart';

class GrievanceService {
  static final Dio _dio = ApiService.dio;

  // Note: This service assumes a Dio interceptor is configured in ApiService
  // to automatically handle the JWT Authorization header.
  GrievanceService();

  // Helper to parse grievance lists from response, reducing code duplication.
  List<Grievance> _parseGrievanceList(Response response) {
    if (response.data is List) {
      return (response.data as List).map((g) => Grievance.fromJson(g)).toList();
    }
    if (response.data is Map && response.data['grievances'] is List) {
      return (response.data['grievances'] as List).map((g) => Grievance.fromJson(g)).toList();
    }
    throw Exception('Unexpected response format: ${response.data}');
  }

  // Helper to create consistent error messages from DioExceptions.
  Exception _handleDioException(DioException e, String action) {
    String errorMessage;
    if (e.type == DioExceptionType.connectionError || e.type == DioExceptionType.connectionTimeout) {
      errorMessage = 'Unable to connect to the server. Please check your network or server status.';
    } else if (e.response?.statusCode == 401) {
      errorMessage = 'Unauthorized: Please log in again.';
    } else {
      errorMessage = 'Failed to $action: ${e.response?.data?['msg'] ?? e.message}';
    }
    return Exception(errorMessage);
  }

  static Future<Position?> _getLocation() async {
    bool serviceEnabled = await Geolocator.isLocationServiceEnabled();
    if (!serviceEnabled) return null;
    LocationPermission permission = await Geolocator.checkPermission();
    if (permission == LocationPermission.denied) {
      permission = await Geolocator.requestPermission();
      if (permission == LocationPermission.denied) return null;
    }
    return await Geolocator.getCurrentPosition();
  }

  Future<Grievance> getGrievanceDetails(int id) async {
  try {
    
    final response = await _dio.get('/grievances/mine');
    
    // Check if response.data is a List
    if (response.data is List) {
      final grievances = (response.data as List)
          .map((json) => Grievance.fromJson(json as Map<String, dynamic>))
          .toList();
      
      // Find the grievance with the matching id
      final grievance = grievances.firstWhere(
        (g) => g.id == id,
        orElse: () => throw Exception('Grievance with id $id not found'),
      );
      print(grievance.toJson() );
      return grievance;
    } else {
      // If response.data is already a single object
      return Grievance.fromJson(response.data as Map<String, dynamic>);
    }
  } on DioException catch (e) {
   
    throw _handleDioException(e, 'fetch grievance details');
  } catch (e) {
    
    rethrow;
  }
}



Future<Grievance> getGrievanceById(int id) async {
  try {
    final response = await _dio.get('/grievances/$id');
    return Grievance.fromJson(response.data as Map<String, dynamic>);
  } on DioException catch (e) {
    throw _handleDioException(e, 'fetch grievance details');
  } catch (e) {
    rethrow;
  }
}




  Future<List<Grievance>> getAllGrievances() async {
  try {
    
    final response = await _dio.get('/admin/grievances/all');
    
    return _parseGrievanceList(response);
  } on DioException catch (e) {
    
    throw _handleDioException(e, 'fetch all grievances');
  } catch (e) {
   
    rethrow;
  }
}







  Future<List<Grievance>> getGrievancesByUserId(int userId) async {
    try {
      
      final response = await _dio.get('/grievances/track');
      
      return _parseGrievanceList(response);
    } on DioException catch (e) {
      
      throw _handleDioException(e, 'fetch user grievances');
    } catch (e) {
      
      rethrow;
    }
  }

  Future<void> addComment(int id, String commentText, {List<PlatformFile>? attachments}) async {
    try {
      final formData = FormData.fromMap({
        'comment_text': commentText,
      });

      if (attachments != null && attachments.isNotEmpty) {
        for (var file in attachments) {
          if (kIsWeb) {
            formData.files.add(MapEntry(
              'attachments',
              MultipartFile.fromBytes(file.bytes!, filename: file.name),
            ));
          } else {
            formData.files.add(MapEntry(
              'attachments',
              await MultipartFile.fromFile(file.path!, filename: file.name),
            ));
          }
        }
      }
      final response = await _dio.post(
        '/grievances/$id/comments',
        data: formData,
      );
      if (response.statusCode != 201) {
        throw Exception('Failed to add comment: ${response.statusMessage}');
      }
    } on DioException catch (e) {
      throw _handleDioException(e, 'add comment');
    } catch (e) {
      rethrow;
    }
  }

  Future<List<Grievance>> getMyGrievances() async {
    try {
      
      final response = await _dio.get('/grievances/mine');
      return _parseGrievanceList(response);
    } on DioException catch (e) {
     
      throw _handleDioException(e, 'fetch my grievances');
    } catch (e) {
      
      rethrow;
    }
  }

  Future<List<Grievance>> getNewGrievances() async {
    try {
    
      final response = await _dio.get('/grievances/new');
      return _parseGrievanceList(response);
    } on DioException catch (e) {
    
      throw _handleDioException(e, 'fetch new grievances');
    } catch (e) {
     
      rethrow;
    }
  }

  Future<List<Grievance>> getAssignedGrievances() async {
    try {
     
      final response = await _dio.get('/grievances/assigned');
      return _parseGrievanceList(response);
    } on DioException catch (e) {
     
      throw _handleDioException(e, 'fetch assigned grievances');
    } catch (e) {
     
      rethrow;
    }
  }

  Future<void> createGrievance({
    required String title,
    required String description,
    required int subjectId,
    required int areaId,
    String? priority,
    double? latitude,
    double? longitude,
    String? address,
    List<PlatformFile>? attachments,
  }) async {
    try {
      Position? position = await _getLocation();
      final formData = FormData.fromMap({
        'title': title,
        'description': description,
        'subject_id': subjectId,
        'area_id': areaId,
        'priority': priority ?? 'medium',
        if (position != null) 'latitude': position.latitude,
        if (position != null) 'longitude': position.longitude,
        if (address != null) 'address': address,
        if (attachments != null && attachments.isNotEmpty)
          'attachments': attachments.map((file) {
            if (kIsWeb) {
              return MultipartFile.fromBytes(file.bytes!, filename: file.name);
            } else {
              return MultipartFile.fromFileSync(file.path!, filename: file.path!.split('/').last);
            }
          }).toList(),
      });
      final response = await _dio.post('/grievances/', data: formData);
      if (response.statusCode == 201) {
        
      } else {
        throw Exception('Failed to create grievance: ${response.statusMessage}');
      }
    } on DioException catch (e) {
     
      throw _handleDioException(e, 'create grievance');
    } catch (e) {
      
      rethrow;
    }
  }

  Future<Map<String, dynamic>> updateGrievance(
    int id,
    Map<String, dynamic> data,
  ) async {
    try {
      final response = await _dio.put(
        '/grievances/$id',
        data: data,
      );
      if (response.statusCode == 200) {
        return response.data as Map<String, dynamic>;
      } else {
        throw Exception(
          'Failed to update grievance: ${response.data?['msg'] ?? response.statusMessage}',
        );
      }
    } on DioException catch (e) {
      throw _handleDioException(e, 'update grievance');
    }
  }





  Future<void> submitFeedback(int grievanceId, int rating, String feedbackText) async {
    try {
     
      final response = await _dio.post(
        '/grievances/$grievanceId/feedback',
        data: {
          'rating': rating,
          'feedback_text': feedbackText,
        },
      );
      if (response.statusCode != 200) {
        throw Exception('Failed to submit feedback: ${response.statusMessage}');
      }
    } on DioException catch (e) {
     
      throw _handleDioException(e, 'submit feedback');
    } catch (e) {
    
      rethrow;
    }
  }

  Future<void> reassignGrievance(int grievanceId, int assigneeId) async {
    try {
     
      final response = await _dio.put(
        '/grievances/$grievanceId/reassign',
        data: {'assignee_id': assigneeId},
      );
      if (response.statusCode != 200) {
        throw Exception('Failed to reassign grievance: ${response.statusMessage}');
      }
    } on DioException catch (e) {
     
      throw _handleDioException(e, 'reassign grievance');
    } catch (e) {
     
      rethrow;
    }
  }

  Future<void> updateGrievanceStatus(int grievanceId, String status) async {
    try {
     
      final response = await _dio.put(
        '/grievances/$grievanceId/status',
        data: {'status': status},
      );
      if (response.statusCode != 200) {
        throw Exception('Failed to update grievance status: ${response.statusMessage}');
      }
    } on DioException catch (e) {
    
      throw _handleDioException(e, 'update grievance status');
    } catch (e) {
     
      rethrow;
    }
  }



















  Future<void> escalateGrievance(int grievanceId, {int? assigneeId}) async {
    try {
     
      final data = assigneeId != null ? {'assignee_id': assigneeId} : {};
      final response = await _dio.post(
        '/grievances/$grievanceId/escalate',
        data: data,
      );
      if (response.statusCode != 200) {
        throw Exception('Failed to escalate grievance: ${response.statusMessage}');
      }
    } on DioException catch (e) {
     
      throw _handleDioException(e, 'escalate grievance');
    } catch (e) {
      
      rethrow;
    }
  }

  Future<void> deleteGrievance(int grievanceId) async {
    try {
      final response = await _dio.delete('/grievances/$grievanceId');
      if (response.statusCode != 200) {
        throw Exception('Failed to delete grievance: ${response.data?['message'] ?? response.statusMessage}');
      }
    } on DioException catch (e) {
      throw _handleDioException(e, 'delete grievance');
    } catch (e) {
      rethrow;
    }
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\services\master_data_service.dart ---
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:dio/dio.dart';
import '../models/master_data_model.dart';
import '../services/api_service.dart';

// Providers for fetching master data
final subjectsProvider = FutureProvider<List<MasterSubject>>((ref) async {
  return MasterDataService.getSubjects();
});

final areasProvider = FutureProvider<List<MasterArea>>((ref) async {
  return MasterDataService.getAreas();
});

class MasterDataService {
  static Future<List<MasterArea>> getAreas() async {
    try {
      print('MasterDataService: Sending GET /areas');
      final response = await ApiService.get('/areas');
      return (response.data as List).map((a) => MasterArea.fromJson(a)).toList();
    } catch (e) {
      print('Error fetching areas: $e');
      rethrow;
    }
  }

  static Future<MasterArea> addArea(Map<String, dynamic> data) async {
    try {
      print('MasterDataService: Sending POST /admins/areas with data: $data');
      final response = await ApiService.post('/admins/areas', data);
      return MasterArea.fromJson(response.data);
    } catch (e) {
      print('Error adding area: $e');
      rethrow;
    }
  }

  static Future<MasterArea> updateArea(int id, Map<String, dynamic> data) async {
    try {
      print('MasterDataService: Sending PUT /admins/areas/$id with data: $data');
      final response = await ApiService.put('/admins/areas/$id', data);
      return MasterArea.fromJson(response.data);
    } catch (e) {
      print('Error updating area: $e');
      rethrow;
    }
  }

  static Future<void> deleteArea(int areaId) async {
    try {
      print('MasterDataService: Sending DELETE /admins/areas/$areaId');
      await ApiService.delete('/admins/areas/$areaId');
    } on DioException catch (e) {
      print('Error deleting area: ${e.response?.data}');
      // Extract user-friendly message from backend
      final errorMsg = e.response?.data?['msg'] ?? 'Failed to delete area.';
      throw Exception(errorMsg);
    } catch (e) {
      print('Error deleting area: $e');
      rethrow;
    }
  }

  static Future<MasterSubject> addSubject(Map<String, dynamic> data) async {
    try {
      print('MasterDataService: Sending POST /admins/subjects with data: $data');
      final response = await ApiService.post('/admins/subjects', data);
      return MasterSubject.fromJson(response.data);
    } catch (e) {
      print('Error adding subject: $e');
      rethrow;
    }
  }

  static Future<MasterSubject> updateSubject(int id, Map<String, dynamic> data) async {
    try {
      print('MasterDataService: Sending PUT /admins/subjects/$id with data: $data');
      final response = await ApiService.put('/admins/subjects/$id', data);
      return MasterSubject.fromJson(response.data);
    } catch (e) {
      print('Error updating subject: $e');
      rethrow;
    }
  }

  static Future<void> deleteSubject(int subjectId) async {
    try {
      print('MasterDataService: Sending DELETE /admins/subjects/$subjectId');
      await ApiService.delete('/admins/subjects/$subjectId');
    } on DioException catch (e) {
      print('Error deleting subject: ${e.response?.data}');
      // Extract user-friendly message from backend
      final errorMsg = e.response?.data?['msg'] ?? 'Failed to delete subject.';
      throw Exception(errorMsg);
    } catch (e) {
      print('Error deleting subject: $e');
      rethrow;
    }
  }

  static Future<List<MasterSubject>> getSubjects() async {
    try {
      print('MasterDataService: Sending GET /subjects');
      final response = await ApiService.get('/subjects');
      return (response.data as List).map((s) => MasterSubject.fromJson(s)).toList();
    } on DioException catch (e) {
      print('DioError fetching subjects: ${e.response?.statusCode} - ${e.response?.data}');
      if (e.response?.statusCode == 405) {
        throw Exception('Use GET for listing subjects.');
      }
      throw Exception('Error fetching subjects: ${e.message}');
    } catch (e) {
      print('Unexpected error fetching subjects: $e');
      rethrow;
    }
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\services\notification_service.dart ---
import 'package:firebase_messaging/firebase_messaging.dart';
import 'package:main_ui/services/api_service.dart';

class NotificationService {
  static final FirebaseMessaging _messaging = FirebaseMessaging.instance;

  static Future<void> initialize() async {
    await _messaging.requestPermission();
    final token = await _messaging.getToken();
    print('FCM Token: $token');

    // Send token to backend
    await ApiService.post('/notifications/register', {'fcm_token': token});

    FirebaseMessaging.onMessage.listen((RemoteMessage message) {
      print('Foreground message: ${message.notification?.title}');
    });

    FirebaseMessaging.onBackgroundMessage(_backgroundHandler);
  }

  static Future<void> _backgroundHandler(RemoteMessage message) async {
    print('Background message: ${message.notification?.title}');
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\services\storage_service.dart ---
import 'package:flutter_secure_storage/flutter_secure_storage.dart';

class StorageService {
  static const _storage = FlutterSecureStorage();

  static Future<void> saveLocale(String locale) async {
    await _storage.write(key: 'locale', value: locale);
  }

  static Future<String?> getLocale() async {
    return await _storage.read(key: 'locale');
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\services\user_service.dart ---
// user_service.dart
import 'package:dio/dio.dart';
import 'package:main_ui/models/user_model.dart';
import 'package:main_ui/services/api_service.dart';

class UserService {
  /// Fetch all users
  static Future<List<User>> getUsers() async {
    try {
      
      final response = await ApiService.get(
        '/admins/users',
        headers: {
          'Accept': 'application/json',
        },
      );

      if (response.data == null || response.data is! List) {
        throw Exception('Invalid response format: Expected a list of users');
      }

      
      return (response.data as List)
          .map((user) => User.fromJson(user as Map<String, dynamic>))
          .toList();
    } on DioException catch (e) {
      

      if (e.response?.statusCode == 404) {
        throw Exception('Users endpoint not found. Check backend routes.');
      } else if (e.response?.statusCode == 405) {
        throw Exception('Invalid method. Use GET for listing users.');
      } else if (e.type == DioExceptionType.connectionError ||
          e.type == DioExceptionType.connectionTimeout) {
        throw Exception('Network error: Unable to connect to the server');
      }
      throw Exception('Failed to load users: ${e.message}');
    } catch (e) {
      throw Exception('Unexpected error while loading users: $e');
    }
  }

  /// Add a new user
  static Future<User> addUser(Map<String, dynamic> data) async {
    try {
      
      final response = await ApiService.post(
        '/admins/users',
        data,
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
        },
      );

      
      return User.fromJson(response.data);
    } on DioException catch (e) {
      
      throw Exception('Failed to add user: ${e.response?.data?['msg'] ?? e.message}');
    } catch (e) {
      throw Exception('Unexpected error while adding user: $e');
    }
  }

  /// Update an existing user
  static Future<User> updateUser(int id, Map<String, dynamic> data) async {
    try {
      
      final response = await ApiService.put(
        '/admins/users/$id',
        data,
        headers: {
          'Content-Type': 'application/json',
          'Accept': 'application/json',
        },
      );

      
      return User.fromJson(response.data);
    } on DioException catch (e) {
      

      if (e.type == DioExceptionType.connectionError) {
        throw Exception('Network error: Unable to connect to the server. Check if the server is running.');
      } else if (e.response != null) {
        throw Exception('Failed to update user: ${e.response?.data?['msg'] ?? e.message}');
      }
      throw Exception('Failed to update user: ${e.message}');
    } catch (e) {
      
      throw Exception('Unexpected error while updating user: $e');
    }
  }

  /// Delete a user
  static Future<void> deleteUser(int id) async {
    try {
      
      final response = await ApiService.delete(
        '/admins/users/$id',
        headers: {
          'Accept': 'application/json',
        },
      );
      
    } on DioException catch (e) {
      
      throw Exception('Failed to delete user: ${e.response?.data?['msg'] ?? e.message}');
    } catch (e) {
      throw Exception('Unexpected error while deleting user: $e');
    }
  }
}


=== Folder: utils ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\utils\constants.dart ---
import 'package:flutter/foundation.dart'
    show kIsWeb, defaultTargetPlatform, TargetPlatform;

class Constants {
  static String get baseUrl {
    if (kIsWeb) {
      return "http://localhost:5000";
    }

    switch (defaultTargetPlatform) {
      case TargetPlatform.android:
        return "http://10.0.2.2:5000"; // Android emulator
        // return "https://pcmcapp.onrender.com"; 
      case TargetPlatform.iOS:
      case TargetPlatform.macOS:
      case TargetPlatform.windows:
      case TargetPlatform.linux:
      default:
        return "http://localhost:5000";
    }
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\utils\theme.dart ---
// lib/utils/theme.dart
import 'package:flutter/material.dart';

// Color palette
const Color primaryColor = Color(0xFF1976D2);
const Color secondaryColor = Color(0xFF42A5F5);
const Color accentColor = Color(0xFFFF7043);
const Color successColor = Color(0xFF4CAF50);
const Color warningColor = Color(0xFFFF9800);
const Color errorColor = Color(0xFFF44336);
const Color backgroundColor = Color(0xFFF5F5F5);
const Color surfaceColor = Color(0xFFFFFFFF);
const Color onPrimaryColor = Color(0xFFFFFFFF);
const Color onSecondaryColor = Color(0xFFFFFFFF);
const Color onBackgroundColor = Color(0xFF000000);
const Color onSurfaceColor = Color(0xFF000000);
const Color greyColor = Color(0xFF9E9E9E);
const Color lightGreyColor = Color(0xFFEEEEEE);

// Text styles
const TextStyle headline1 = TextStyle(
  fontSize: 32.0,
  fontWeight: FontWeight.bold,
  color: onBackgroundColor,
);

const TextStyle headline2 = TextStyle(
  fontSize: 24.0,
  fontWeight: FontWeight.bold,
  color: onBackgroundColor,
);

const TextStyle headline3 = TextStyle(
  fontSize: 20.0,
  fontWeight: FontWeight.bold,
  color: onBackgroundColor,
);

const TextStyle subtitle1 = TextStyle(
  fontSize: 16.0,
  fontWeight: FontWeight.w500,
  color: onBackgroundColor,
);

const TextStyle bodyText1 = TextStyle(
  fontSize: 16.0,
  fontWeight: FontWeight.normal,
  color: onBackgroundColor,
);

const TextStyle bodyText2 = TextStyle(
  fontSize: 14.0,
  fontWeight: FontWeight.normal,
  color: onBackgroundColor,
);

const TextStyle caption = TextStyle(
  fontSize: 12.0,
  fontWeight: FontWeight.normal,
  color: greyColor,
);

const TextStyle buttonText = TextStyle(
  fontSize: 16.0,
  fontWeight: FontWeight.w600,
  color: onPrimaryColor,
);

// Theme data
final ThemeData lightTheme = ThemeData(
  brightness: Brightness.light,
  primaryColor: primaryColor,
  colorScheme: const ColorScheme.light(
    primary: primaryColor,
    secondary: secondaryColor,
    surface: surfaceColor,
    error: errorColor,
    onPrimary: onPrimaryColor,
    onSecondary: onSecondaryColor,
    onSurface: onSurfaceColor,
    onError: onPrimaryColor,
  ),
  scaffoldBackgroundColor: backgroundColor,
  appBarTheme: const AppBarTheme(
    backgroundColor: primaryColor,
    foregroundColor: onPrimaryColor,
    elevation: 2,
    centerTitle: true,
    titleTextStyle: TextStyle(
      fontSize: 20,
      fontWeight: FontWeight.w600,
      color: onPrimaryColor,
    ),
  ),
  cardTheme: CardThemeData(
    elevation: 2,
    shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
    margin: const EdgeInsets.all(8),
    color: surfaceColor,
  ),
  inputDecorationTheme: InputDecorationTheme(
    border: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: greyColor),
    ),
    enabledBorder: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: greyColor),
    ),
    focusedBorder: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: primaryColor, width: 2),
    ),
    errorBorder: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: errorColor),
    ),
    filled: true,
    fillColor: surfaceColor,
    contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 14),
  ),
  buttonTheme: const ButtonThemeData(
    buttonColor: primaryColor,
    textTheme: ButtonTextTheme.primary,
    shape: RoundedRectangleBorder(
      borderRadius: BorderRadius.all(Radius.circular(12)),
    ),
  ),
  elevatedButtonTheme: ElevatedButtonThemeData(
    style: ElevatedButton.styleFrom(
      backgroundColor: primaryColor,
      foregroundColor: onPrimaryColor,
      textStyle: buttonText,
      padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 16),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(12),
      ),
    ),
  ),
  textButtonTheme: TextButtonThemeData(
    style: TextButton.styleFrom(
      foregroundColor: primaryColor,
      textStyle: buttonText.copyWith(color: primaryColor),
      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),
    ),
  ),
  outlinedButtonTheme: OutlinedButtonThemeData(
    style: OutlinedButton.styleFrom(
      foregroundColor: primaryColor,
      side: const BorderSide(color: primaryColor),
      textStyle: buttonText.copyWith(color: primaryColor),
      padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 16),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(12),
      ),
    ),
  ),
  textTheme: TextTheme(
    displayLarge: headline1,
    displayMedium: headline2,
    displaySmall: headline3,
    titleMedium: subtitle1,
    bodyLarge: bodyText1,
    bodyMedium: bodyText2,
    labelSmall: caption,
  ),
  iconTheme: const IconThemeData(
    color: primaryColor,
    size: 24,
  ),
  dividerTheme: const DividerThemeData(
    color: lightGreyColor,
    thickness: 1,
    space: 1,
  ),
);

final ThemeData darkTheme = ThemeData(
  brightness: Brightness.dark,
  primaryColor: primaryColor,
  colorScheme: const ColorScheme.dark(
    primary: primaryColor,
    secondary: secondaryColor,
    surface: Color(0xFF121212),
    error: errorColor,
    onPrimary: onPrimaryColor,
    onSecondary: onSecondaryColor,
    onSurface: Color(0xFFFFFFFF),
    onError: onPrimaryColor,
  ),
  scaffoldBackgroundColor: const Color(0xFF000000),
  appBarTheme: const AppBarTheme(
    backgroundColor: Color(0xFF121212),
    foregroundColor: Color(0xFFFFFFFF),
    elevation: 2,
    centerTitle: true,
    titleTextStyle: TextStyle(
      fontSize: 20,
      fontWeight: FontWeight.w600,
      color: Color(0xFFFFFFFF),
    ),
  ),
  cardTheme: CardThemeData(
    elevation: 2,
    shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
    margin: const EdgeInsets.all(8),
    color: const Color(0xFF1E1E1E),
  ),
  inputDecorationTheme: InputDecorationTheme(
    border: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: Color(0xFF616161)),
    ),
    enabledBorder: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: Color(0xFF616161)),
    ),
    focusedBorder: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: primaryColor, width: 2),
    ),
    errorBorder: OutlineInputBorder(
      borderRadius: BorderRadius.circular(12),
      borderSide: const BorderSide(color: errorColor),
    ),
    filled: true,
    fillColor: const Color(0xFF1E1E1E),
    contentPadding: const EdgeInsets.symmetric(horizontal: 16, vertical: 14),
  ),
  buttonTheme: const ButtonThemeData(
    buttonColor: primaryColor,
    textTheme: ButtonTextTheme.primary,
    shape: RoundedRectangleBorder(
      borderRadius: BorderRadius.all(Radius.circular(12)),
    ),
  ),
  elevatedButtonTheme: ElevatedButtonThemeData(
    style: ElevatedButton.styleFrom(
      backgroundColor: primaryColor,
      foregroundColor: onPrimaryColor,
      textStyle: buttonText,
      padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 16),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(12),
      ),
    ),
  ),
  textButtonTheme: TextButtonThemeData(
    style: TextButton.styleFrom(
      foregroundColor: primaryColor,
      textStyle: buttonText.copyWith(color: primaryColor),
      padding: const EdgeInsets.symmetric(horizontal: 16, vertical: 12),
    ),
  ),
  outlinedButtonTheme: OutlinedButtonThemeData(
    style: OutlinedButton.styleFrom(
      foregroundColor: primaryColor,
      side: const BorderSide(color: primaryColor),
      textStyle: buttonText.copyWith(color: primaryColor),
      padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 16),
      shape: RoundedRectangleBorder(
        borderRadius: BorderRadius.circular(12),
      ),
    ),
  ),
  textTheme: TextTheme(
    displayLarge: headline1.copyWith(color: Color(0xFFFFFFFF)),
    displayMedium: headline2.copyWith(color: Color(0xFFFFFFFF)),
    displaySmall: headline3.copyWith(color: Color(0xFFFFFFFF)),
    titleMedium: subtitle1.copyWith(color: Color(0xFFFFFFFF)),
    bodyLarge: bodyText1.copyWith(color: Color(0xFFFFFFFF)),
    bodyMedium: bodyText2.copyWith(color: Color(0xFFFFFFFF)),
    labelSmall: caption.copyWith(color: Color(0xFFBDBDBD)),
  ),
  iconTheme: const IconThemeData(
    color: primaryColor,
    size: 24,
  ),
  dividerTheme: const DividerThemeData(
    color: Color(0xFF424242),
    thickness: 1,
    space: 1,
  ),
);
--- File: D:\Company_Data\PCMCApp\main_ui\lib\utils\validators.dart ---
// lib/utils/validators.dart

String? validateRequired(String? value) {
  if (value == null || value.isEmpty) {
    return 'This field is required';
  }
  return null;
}

String? validateEmail(String? value) {
  if (value == null || !value.contains('@')) {
    return 'Invalid email';
  }
  return null;
}

=== Folder: widgets ===

--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\CombinedGrievanceCard.dart ---
import 'package:flutter/material.dart';
import 'package:intl/intl.dart';
import 'package:main_ui/models/grievance_model.dart';
import 'package:main_ui/widgets/status_badge.dart';
import 'package:main_ui/l10n/app_localizations.dart'; // Import AppLocalizations

class CombinedGrievanceCard extends StatelessWidget {
  final Grievance grievance;
  final VoidCallback? onTap;

  // Define stage keys for localization
  static const _stageKeys = [
    {'status': 'new', 'key': 'stageSubmitted', 'icon': Icons.send},
    {'status': 'in_progress', 'key': 'stageReviewedBySupervisor', 'icon': Icons.visibility},
    {'status': 'in_progress', 'key': 'stageAssignedToFieldStaff', 'icon': Icons.assignment_ind},
    {'status': 'resolved', 'key': 'stageResolved', 'icon': Icons.check_circle},
  ];

  const CombinedGrievanceCard({super.key, required this.grievance, this.onTap});

  // Helper to get localized stage labels
  String _getLocalizedStageLabel(String key, AppLocalizations l10n) {
    switch (key) {
      case 'stageSubmitted':
        return l10n.stageSubmitted;
      case 'stageReviewedBySupervisor':
        return l10n.stageReviewedBySupervisor;
      case 'stageAssignedToFieldStaff':
        return l10n.stageAssignedToFieldStaff;
      case 'stageResolved':
        return l10n.stageResolved;
      default:
        return key; // Fallback
    }
  }

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);
    final status = grievance.status?.toLowerCase() ?? 'new';
    final l10n = AppLocalizations.of(context)!; // Get l10n instance

    return Card(
  elevation: 2,
  shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
  margin: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
  color: const Color(0xFFECF2FE),
  child: InkWell(
    borderRadius: BorderRadius.circular(16),    onTap: onTap,
    child: Padding(
      padding: const EdgeInsets.all(16.0),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          // Grievance Details Section
          Row(
            mainAxisAlignment: MainAxisAlignment.spaceBetween,
            children: [
              Expanded(
                child: Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text(
                      grievance.title ?? 'Untitled Grievance',
                      style: theme.textTheme.titleMedium?.copyWith(
                        fontWeight: FontWeight.w600,
                      ),
                      maxLines: 1,
                      overflow: TextOverflow.ellipsis,
                    ),
                    const SizedBox(height: 8),
                    Text(
                      grievance.description ?? 'No description provided',
                      style: theme.textTheme.bodyMedium?.copyWith(
                        color: theme.colorScheme.onSurface.withAlpha(179),
                      ),
                      maxLines: 2,
                      overflow: TextOverflow.ellipsis,
                    ),
                    const SizedBox(height: 12),
                    Row(
                      children: [
                        Icon(
                          Icons.calendar_today_rounded,
                          size: 16,
                          color: theme.colorScheme.onSurface.withAlpha(128),
                        ),
                        const SizedBox(width: 4),
                        Text(
                          _formatDate(grievance.createdAt!, l10n), // Pass l10n
                          style: theme.textTheme.bodySmall?.copyWith(
                            color: theme.colorScheme.onSurface.withAlpha(128),
                          ),
                        ),
                      ],
                    ),
                  ],
                ),
              ),
              Row(
                children: [
                  StatusBadge(status: status),
                  const SizedBox(width: 8),
                  Text( // Priority is data, but 'N/A' is a static string
                    grievance.priority ?? l10n.notApplicable,
                    style: theme.textTheme.bodySmall?.copyWith(
                      color: theme.colorScheme.onSurface.withAlpha(179),
                    ),
                  ),
                ],
              ),
            ],
          ),
          // Divider Line
          const SizedBox(height: 16),
          Divider(
            color: theme.colorScheme.onSurface.withAlpha(128),
            thickness: 1,
          ),
          const SizedBox(height: 16),
          // Grievance Progress Section
          Text( // Localize "Grievance Progress"
            l10n.grievanceProgressTitle,
            style: theme.textTheme.titleLarge?.copyWith(
              fontWeight: FontWeight.w600,
              color: theme.colorScheme.primary,
            ),
          ),
          const SizedBox(height: 16),
          Column(
            children: List.generate(_stageKeys.length, (index) {
              final stageData = _stageKeys[index];
              final String stageLabel = _getLocalizedStageLabel(stageData['key'] as String, l10n);
              final isActive = index <= _getCurrentStageIndex(status, grievance);

              return Row(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Column(
                    children: [
                      Container(
                        width: 32,
                        height: 32,
                        decoration: BoxDecoration(
                          shape: BoxShape.circle,
                          color: isActive
                              ? theme.colorScheme.primary
                              : theme.colorScheme.onSurface.withAlpha(51),
                        ),
                        child: Icon(
                              stageData['icon'] as IconData,
                          size: 20,
                          color: isActive
                              ? theme.colorScheme.onPrimary
                              : theme.colorScheme.onSurface.withAlpha(102),
                        ),
                      ),
                      if (index < 3)
                          Container( // Corrected to use _stageKeys.length - 1 for maintainability
                          width: 2,
                          height: 40,
                          color: isActive
                              ? theme.colorScheme.primary
                              : theme.colorScheme.onSurface.withAlpha(51),
                        ),
                    ],
                  ),
                  const SizedBox(width: 16),
                  Expanded(
                    child: Column(
                      crossAxisAlignment: CrossAxisAlignment.start,
                      children: [
                          Text( // Use localized label
                            stageLabel,
                          style: theme.textTheme.bodyLarge?.copyWith(
                            fontWeight: isActive ? FontWeight.w600 : FontWeight.normal,
                            color: isActive
                                ? theme.colorScheme.onSurface
                                : theme.colorScheme.onSurface.withAlpha(128),
                          ),
                        ),
                        if (isActive)
                          Text(
                              _getStageDetails(index, status, grievance, l10n), // Pass l10n
                            style: theme.textTheme.bodySmall?.copyWith(
                              color: theme.colorScheme.onSurface.withAlpha(179),
                            ),
                          ),
                        const SizedBox(height: 8),
                      ],
                    ),
                  ),
                ],
              );
            }),
          ),
        ],
      ),
    ),
  ),
);

  }

  int _getCurrentStageIndex(String status, Grievance grievance) {
    if (status == 'in_progress' && grievance.assignedTo != null) {
      return 2; // Assigned to Field Staff
    } else if (status == 'in_progress') {
      return 1; // Reviewed by Member Head
    } else if (status == 'resolved' || status == 'closed') {
      return 3; // Resolved
    }
    return 0; // Submitted
  }

  String _getStageDetails(int index, String status, Grievance grievance, AppLocalizations l10n) {
    switch (index) {
      case 0:
        return '${l10n.submittedOn} ${_formatDate(grievance.createdAt, l10n)}';
      case 1:
        return '${l10n.stageReviewedBySupervisor}${grievance.assignedBy != null ? " (${l10n.userLabel} ${grievance.assignedBy})" : ""}';
      case 2:
        return '${l10n.assignedToLabel}${grievance.assignee?.name != null ? " ${grievance.assignee!.name}" : " ${l10n.fieldStaffLabel}"}';
      case 3:
        return '${l10n.resolvedOn} ${_formatDate(grievance.resolvedAt, l10n)}';
      default:
        return '';
    }
  }

  String _formatDate(DateTime? date, AppLocalizations l10n) {
    if (date == null) return l10n.notApplicable;
    final now = DateTime.now();
    final difference = now.difference(date);
    if (difference.inDays > 1) {
      return l10n.timeAgoDays(difference.inDays);
    } else if (difference.inDays == 1) {
      return l10n.timeAgoDays(1); // Use plural for singular case
    } else if (difference.inHours > 1) {
      return l10n.timeAgoHours(difference.inHours);
    } else if (difference.inMinutes > 1) {
      return l10n.timeAgoMinutes(difference.inMinutes);
    } else {
      return l10n.timeAgoJustNow;
    }
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\comment_tile.dart ---
// lib/widgets/comment_tile.dart
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:url_launcher/url_launcher.dart';
import '../models/comment_model.dart';
import '../utils/constants.dart';
import '../../providers/user_provider.dart';


class CommentTile extends ConsumerWidget {
  final Comment comment;
  final VoidCallback? onLongPress;
  final VoidCallback? onTap;

  const CommentTile({
    super.key,
    required this.comment,
    this.onLongPress,
    this.onTap,
  });

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final currentUser = ref.watch(userNotifierProvider);
    final isCurrentUser = currentUser != null && currentUser.id == comment.userId;
    
    return Padding(
      padding: const EdgeInsets.symmetric(vertical: 8.0, horizontal: 16.0),
      child: Row(
        mainAxisAlignment: isCurrentUser ? MainAxisAlignment.end : MainAxisAlignment.start,
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          if (!isCurrentUser) ...[
            _buildAvatar(context, isCurrentUser),
            const SizedBox(width: 12.0),
          ],
          Flexible(
            child: GestureDetector(
              onTap: onTap,
              onLongPress: onLongPress,
              child: Container(
                constraints: BoxConstraints(
                  maxWidth: MediaQuery.of(context).size.width * 0.7,
                ),
                padding: const EdgeInsets.all(16.0),
                decoration: BoxDecoration(
                  color: isCurrentUser 
                      ? Theme.of(context).colorScheme.primary.withOpacity(0.1)
                      : Theme.of(context).colorScheme.surfaceVariant,
                  borderRadius: _getBorderRadius(isCurrentUser),
                  boxShadow: [
                    BoxShadow(
                      color: Colors.black.withOpacity(0.1),
                      blurRadius: 6.0,
                      offset: const Offset(0, 2),
                    ),
                  ],
                ),
                child: Column(
                  crossAxisAlignment: isCurrentUser ? CrossAxisAlignment.end : CrossAxisAlignment.start,
                  children: [
                    _buildHeader(context, isCurrentUser),
                    const SizedBox(height: 8.0),
                    _buildCommentText(context),
                    const SizedBox(height: 8.0),
                    _buildTimestamp(context),
                    if (comment.attachments != null && comment.attachments!.isNotEmpty)
                      _buildAttachments(context, isCurrentUser),
                  ],
                ),
              ),
            ),
          ),
          if (isCurrentUser) ...[
            const SizedBox(width: 12.0),
            _buildAvatar(context, isCurrentUser),
          ],
        ],
      ),
    );
  }

  Widget _buildAvatar(BuildContext context, bool isCurrentUser) {
    return CircleAvatar(
      radius: 16.0,
      backgroundColor: isCurrentUser
          ? Theme.of(context).colorScheme.primary
          : Theme.of(context).colorScheme.secondary,
      child: Text(
        comment.userName?.isNotEmpty == true 
            ? comment.userName![0].toUpperCase()
            : 'U',
        style: TextStyle(
          color: Colors.white,
          fontSize: 12.0,
          fontWeight: FontWeight.bold,
        ),
      ),
    );
  }

  Widget _buildHeader(BuildContext context, bool isCurrentUser) {
    return Row(
      mainAxisSize: MainAxisSize.min,
      children: [
        if (!isCurrentUser) ...[
          Icon(
            Icons.comment_outlined,
            size: 14.0,
            color: Theme.of(context).colorScheme.onSurfaceVariant,
          ),
          const SizedBox(width: 6.0),
        ],
        Flexible(
          child: Text(
            comment.userName ?? 'User ${comment.userId}',
            style: Theme.of(context).textTheme.bodyMedium?.copyWith(
              fontWeight: FontWeight.w600,
              color: isCurrentUser 
                  ? Theme.of(context).colorScheme.primary
                  : Theme.of(context).colorScheme.onSurface,
            ),
            overflow: TextOverflow.ellipsis,
          ),
        ),
        if (isCurrentUser) ...[
          const SizedBox(width: 6.0),
          Icon(
            Icons.comment_outlined,
            size: 14.0,
            color: Theme.of(context).colorScheme.primary.withOpacity(0.7),
          ),
        ],
      ],
    );
  }

  Widget _buildCommentText(BuildContext context) {
    return Text(
      comment.commentText ?? "",
      style: Theme.of(context).textTheme.bodyLarge?.copyWith(
        color: Theme.of(context).colorScheme.onSurface,
        height: 1.4,
      ),
      textAlign: TextAlign.start,
    );
  }

  Widget _buildTimestamp(BuildContext context) {
    return Text(
      _formatDateTime(comment.createdAt),
      style: Theme.of(context).textTheme.bodySmall?.copyWith(
        color: Theme.of(context).colorScheme.onSurface.withOpacity(0.6),
        fontSize: 11.0,
      ),
    );
  }

  Widget _buildAttachments(BuildContext context, bool isCurrentUser) {
    final theme = Theme.of(context);
    return Padding(
      padding: const EdgeInsets.only(top: 8.0),
      child: Column(
        crossAxisAlignment:
            isCurrentUser ? CrossAxisAlignment.end : CrossAxisAlignment.start,
        children: comment.attachments!.map((attachment) {
          final fileName = attachment.filePath.split('/').last;
          final isImage = fileName.endsWith('.jpg') ||
              fileName.endsWith('.jpeg') ||
              fileName.endsWith('.png');

          return GestureDetector(
            onTap: () => _launchURL(context, attachment.filePath),
            child: Container(
              margin: const EdgeInsets.only(top: 8.0),
              padding: const EdgeInsets.all(8.0),
              decoration: BoxDecoration(
                color: isCurrentUser
                    ? theme.colorScheme.primary.withOpacity(0.2)
                    : theme.colorScheme.surface,
                borderRadius: BorderRadius.circular(8.0),
                border: Border.all(
                  color: isCurrentUser
                      ? theme.colorScheme.primary.withOpacity(0.3)
                      : theme.dividerColor,
                ),
              ),
              child: Row(
                mainAxisSize: MainAxisSize.min,
                children: [
                  isImage
                      ? ClipRRect(
                          borderRadius: BorderRadius.circular(4.0),
                          child: Image.network(
                            '${Constants.baseUrl}/uploads/${attachment.filePath}',
                            width: 40,
                            height: 40,
                            fit: BoxFit.cover,
                            errorBuilder: (context, error, stackTrace) =>
                                const Icon(Icons.broken_image, size: 30),
                          ),
                        )
                      : Icon(Icons.insert_drive_file, size: 30, color: theme.colorScheme.onSurface.withOpacity(0.7)),
                  const SizedBox(width: 12),
                  Expanded(child: Text(fileName, style: theme.textTheme.bodyMedium?.copyWith(fontSize: 13), overflow: TextOverflow.ellipsis)),
                ],
              ),
            ),
          );
        }).toList(),
      ),
    );
  }

  BorderRadius _getBorderRadius(bool isCurrentUser) {
    return BorderRadius.only(
      topLeft: const Radius.circular(16.0),
      topRight: const Radius.circular(16.0),
      bottomLeft: isCurrentUser ? const Radius.circular(16.0) : const Radius.circular(4.0),
      bottomRight: isCurrentUser ? const Radius.circular(4.0) : const Radius.circular(16.0),
    );
  }

  String _formatDateTime(DateTime dateTime) {
  final now = DateTime.now();
  final difference = now.difference(dateTime.toLocal());

  print('DEBUG: now=$now, dateTime=$dateTime');
  print('DEBUG: difference=$difference '
      '(minutes=${difference.inMinutes}, hours=${difference.inHours}, days=${difference.inDays})');

  if (difference.inMinutes < 1) {
    print('DEBUG: Returning → Just now');
    return 'Just now';
  } else if (difference.inMinutes < 60) {
    print('DEBUG: Returning → ${difference.inMinutes}m ago');
    return '${difference.inMinutes}m ago';
  } else if (difference.inHours < 24) {
    print('DEBUG: Returning → ${difference.inHours}h ago');
    return '${difference.inHours}h ago';
  } else if (difference.inDays < 7) {
    print('DEBUG: Returning → ${difference.inDays}d ago');
    return '${difference.inDays}d ago';
  } else {
    final formatted = '${dateTime.day}/${dateTime.month}/${dateTime.year}';
    print('DEBUG: Returning → $formatted');
    return formatted;
  }
}

  Future<void> _launchURL(BuildContext context, String path) async {
    final String url = '${Constants.baseUrl}/uploads/$path';
    final Uri uri = Uri.parse(url);
    if (!await launchUrl(uri, mode: LaunchMode.externalApplication)) {
      if (context.mounted) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('Could not launch $url')),
        );
      }
    }
  }

}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\custom_button.dart ---
// lib/widgets/custom_button.dart
import 'package:flutter/material.dart';

class CustomButton extends StatelessWidget {
  final String text;
  final VoidCallback? onPressed;
  final IconData? icon;
  final Color? backgroundColor;
  final Color? foregroundColor;
  final bool fullWidth;
  final bool isLoading; // <-- Add this line

  const CustomButton({
    super.key,
    required this.text,
    this.onPressed,
    this.icon,
    this.backgroundColor,
    this.foregroundColor,
    this.fullWidth = true,
    this.isLoading = false, // <-- Add this line
  });

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);
    
    return ElevatedButton(
      onPressed: isLoading ? null : onPressed,
      style: ElevatedButton.styleFrom(
        backgroundColor: backgroundColor ?? theme.colorScheme.primary,
        foregroundColor: foregroundColor ?? theme.colorScheme.onPrimary,
        padding: const EdgeInsets.symmetric(vertical: 16, horizontal: 24),
        shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
        minimumSize: fullWidth ? const Size(double.infinity, 0) : null,
      ),
      child: isLoading
          ? const CircularProgressIndicator()
          : Row(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              if (icon != null) ...[
                Icon(icon, size: 20),
                const SizedBox(width: 8),
              ],
              Text(
                text,
                style: const TextStyle(fontWeight: FontWeight.w600),
              ),
            ],
          ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\custom_button_.dart ---
// lib/widgets/custom_button2.dart
import 'package:flutter/material.dart';

enum ButtonVariant { filled, outlined, text }
enum ButtonSize { small, medium, large }

class CustomButton2 extends StatelessWidget {
  final String text;
  final VoidCallback? onPressed;
  final IconData? icon;
  final Color? backgroundColor;
  final Color? foregroundColor;
  final bool fullWidth;
  final bool isLoading;

  final ButtonVariant variant;
  final ButtonSize size;

  const CustomButton2({
    super.key,
    required this.text,
    this.onPressed,
    this.icon,
    this.backgroundColor,
    this.foregroundColor,
    this.fullWidth = true,
    this.isLoading = false,
    this.variant = ButtonVariant.filled,
    this.size = ButtonSize.medium,
  });

  EdgeInsetsGeometry get _padding {
    switch (size) {
      case ButtonSize.small:
        return const EdgeInsets.symmetric(vertical: 8, horizontal: 12);
      case ButtonSize.large:
        return const EdgeInsets.symmetric(vertical: 20, horizontal: 28);
      case ButtonSize.medium:
      default:
        return const EdgeInsets.symmetric(vertical: 14, horizontal: 20);
    }
  }

  double get _fontSize {
    switch (size) {
      case ButtonSize.small:
        return 14;
      case ButtonSize.large:
        return 18;
      case ButtonSize.medium:
      default:
        return 16;
    }
  }

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);

    ButtonStyle style;
    switch (variant) {
      case ButtonVariant.outlined:
        style = OutlinedButton.styleFrom(
          foregroundColor: foregroundColor ?? theme.colorScheme.primary,
          side: BorderSide(color: theme.colorScheme.primary),
          padding: _padding,
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(12),
          ),
          minimumSize: fullWidth ? const Size(double.infinity, 0) : null,
        );
        break;

      case ButtonVariant.text:
        style = TextButton.styleFrom(
          foregroundColor: foregroundColor ?? theme.colorScheme.primary,
          padding: _padding,
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(12),
          ),
          minimumSize: fullWidth ? const Size(double.infinity, 0) : null,
        );
        break;

      case ButtonVariant.filled:
      default:
        style = ElevatedButton.styleFrom(
          backgroundColor: backgroundColor ?? theme.colorScheme.primary,
          foregroundColor: foregroundColor ?? theme.colorScheme.onPrimary,
          padding: _padding,
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(12),
          ),
          minimumSize: fullWidth ? const Size(double.infinity, 0) : null,
        );
        break;
    }

    final child = isLoading
        ? const SizedBox(
            height: 20,
            width: 20,
            child: CircularProgressIndicator(strokeWidth: 2),
          )
        : Row(
            mainAxisAlignment: MainAxisAlignment.center,
            mainAxisSize: MainAxisSize.min,
            children: [
              if (icon != null) ...[
                Icon(icon, size: 20),
                const SizedBox(width: 8),
              ],
              Text(
                text,
                style: TextStyle(
                  fontWeight: FontWeight.w600,
                  fontSize: _fontSize,
                ),
              ),
            ],
          );

    switch (variant) {
      case ButtonVariant.outlined:
        return OutlinedButton(onPressed: isLoading ? null : onPressed, style: style, child: child);
      case ButtonVariant.text:
        return TextButton(onPressed: isLoading ? null : onPressed, style: style, child: child);
      case ButtonVariant.filled:
      default:
        return ElevatedButton(onPressed: isLoading ? null : onPressed, style: style, child: child);
    }
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\empty_state.dart ---
// lib/widgets/empty_state.dart
import 'package:flutter/material.dart';

class EmptyState extends StatefulWidget {
  final IconData icon;
  final String title;
  final String message;
  final Widget? actionButton;
  final Color? iconColor; // Optional icon color
  final TextStyle? titleStyle; // Optional title style
  final TextStyle? messageStyle; // Optional message style
  final Color? backgroundColor; // Optional background color
  
  const EmptyState({
    super.key,
    required this.icon,
    required this.title,
    required this.message,
    this.actionButton,
    this.iconColor,
    this.titleStyle,
    this.messageStyle,
    this.backgroundColor,
  });

  @override
  State<EmptyState> createState() => _EmptyStateState();
}

class _EmptyStateState extends State<EmptyState>
    with SingleTickerProviderStateMixin {
  late final AnimationController _controller;
  late final Animation<double> _fadeAnimation;

  @override
  void initState() {
    super.initState();
    _controller = AnimationController(
      duration: const Duration(milliseconds: 600),
      vsync: this,
    );
    _fadeAnimation =
        CurvedAnimation(parent: _controller, curve: Curves.easeInOut);

    _controller.forward();
  }

  @override
  void dispose() {
    _controller.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);
    final screenSize = MediaQuery.of(context).size;
    final isSmallScreen = screenSize.width < 600;

    return Semantics(
      label: 'Empty state: ${widget.title}',
      child: Container(
        color: widget.backgroundColor ?? theme.colorScheme.surface,
        padding: EdgeInsets.all(isSmallScreen ? 16.0 : 32.0),
        child: Center(
          child: FadeTransition(
            opacity: _fadeAnimation,
            child: SingleChildScrollView(
              child: Column(
                mainAxisSize: MainAxisSize.min,
                mainAxisAlignment: MainAxisAlignment.center,
                crossAxisAlignment: CrossAxisAlignment.center,
                children: [
                  Icon(
                    widget.icon,
                    size: isSmallScreen ? 48 : 64,
                    color: widget.iconColor ??
                        theme.colorScheme.onSurface.withValues (alpha: 0.4),
                    semanticLabel: 'Empty state icon',
                  ),
                  const SizedBox(height: 16),
                  Text(
                    widget.title,
                    style: widget.titleStyle ??
                        theme.textTheme.titleLarge?.copyWith(
                          fontWeight: FontWeight.w600,
                          color: theme.colorScheme.onSurface,
                        ),
                    textAlign: TextAlign.center,
                    semanticsLabel: widget.title,
                  ),
                  const SizedBox(height: 8),
                  Text(
                    widget.message,
                    style: widget.messageStyle ??
                        theme.textTheme.bodyLarge?.copyWith(
                              color: theme.colorScheme.onSurface
                                  .withValues (alpha: 0.7),
                              height: 1.5,
                            ),
                    textAlign: TextAlign.center,
                    semanticsLabel: widget.message,
                  ),
                  if (widget.actionButton != null) ...[
                    const SizedBox(height: 24),
                    widget.actionButton!,
                  ],
                ],
              ),
            ),
          ),
        ),
      ),
    );
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\file_upload_widget.dart ---
// lib/widgets/file_upload_widget.dart
import 'package:file_picker/file_picker.dart';
import 'package:flutter/foundation.dart' show kIsWeb;
import 'package:flutter/material.dart';
import 'package:mime/mime.dart';

import 'dart:io' as io;
import '../services/file_service.dart';


class FileUploadWidget extends StatefulWidget {
  final Function(List<PlatformFile>) onFilesSelected; // Updated type
  const FileUploadWidget({super.key, required this.onFilesSelected});

  @override
  State<FileUploadWidget> createState() => _FileUploadWidgetState();
}

class _FileUploadWidgetState extends State<FileUploadWidget> {
  List<PlatformFile> files = []; // Updated type

  Future<void> _pickFiles() async {
    final newFiles = await FileService.pickFiles();
    if (files.length + newFiles.length > 10) {
      ScaffoldMessenger.of(context).showSnackBar(const SnackBar(content: Text('Max 10 files')));
    } else {
      setState(() => files.addAll(newFiles));
      widget.onFilesSelected(files);
    }
  }

  @override
  Widget build(BuildContext context) {
    return Column(
      children: [
        ElevatedButton(onPressed: _pickFiles, child: const Text('Upload Files')),
        ...files.map((file) {
          final mimeType = lookupMimeType(file.name); // Use name
          if (mimeType?.startsWith('image/') ?? false) {
            if (kIsWeb) {
              return Image.memory(file.bytes!, height: 100); // Web: Use bytes
            } else {
              return Image.file(io.File(file.path!), height: 100); // Non-web: Use path
            }
          } else {
            return const Icon(Icons.picture_as_pdf, size: 100);
          }
        }),
      ],
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\grievance_card.dart ---
import 'package:flutter/material.dart';
import '../models/grievance_model.dart';
import 'status_badge.dart';

class GrievanceCard extends StatelessWidget {
  final Grievance grievance;
  
  const GrievanceCard({super.key, required this.grievance,});

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);

    return Card(
      elevation: 2,
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
      child: InkWell(
        borderRadius: BorderRadius.circular(16),
        onTap: () => Navigator.pushNamed(
          context,
          '/citizen/detail',
          arguments: grievance.id,
        ),
        child: Padding(
          padding: const EdgeInsets.all(16.0),
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              Row(
                mainAxisAlignment: MainAxisAlignment.spaceBetween,
                children: [
                  Expanded(
                    child: Text(
                      grievance.title ?? 'Untitled Grievance',
                      style: theme.textTheme.titleMedium?.copyWith(
                        fontWeight: FontWeight.w600,
                      ),
                      maxLines: 1,
                      overflow: TextOverflow.ellipsis,
                    ),
                  ),
                  Row(
                    children: [
                      StatusBadge(status: grievance.status ?? 'new'),
                      const SizedBox(width: 8),
                      Text(
                        grievance.priority ?? 'N/A',
                        style: theme.textTheme.bodySmall?.copyWith(
                          color: theme.colorScheme.onSurface.withValues (alpha: 0.7),
                        ),
                      ),
                    ],
                  ),
                ],
              ),
              const SizedBox(height: 8),
              Text(
                grievance.description ?? 'No description provided',
                style: theme.textTheme.bodyMedium?.copyWith(
                  color: theme.colorScheme.onSurface.withValues (alpha: 0.7),
                ),
                maxLines: 2,
                overflow: TextOverflow.ellipsis,
              ),
              const SizedBox(height: 12),
              Row(
                children: [
                  Icon(
                    Icons.calendar_today_rounded,
                    size: 16,
                    color: theme.colorScheme.onSurface.withValues (alpha:0.5),
                  ),
                  const SizedBox(width: 4),
                  Text(
                    _formatDate(grievance.createdAt!),
                    style: theme.textTheme.bodySmall?.copyWith(
                      color: theme.colorScheme.onSurface.withValues (alpha:0.5),
                    ),
                  ),
                ],
              ),
            ],
          ),
        ),
      ),
    );
  }

  String _formatDate(DateTime date) {
    final now = DateTime.now();
    final difference = now.difference(date);
    if (difference.inDays > 1) {
      return 'Submitted ${difference.inDays} days ago';
    } else if (difference.inDays == 1) {
      return 'Submitted 1 day ago';
    } else if (difference.inHours > 1) {
      return 'Submitted ${difference.inHours} hours ago';
    } else if (difference.inMinutes > 1) {
      return 'Submitted ${difference.inMinutes} minutes ago';
    } else {
      return 'Submitted just now';
    }
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\loading_indicator.dart ---
import 'package:flutter/material.dart';

class LoadingIndicator extends StatelessWidget {
  const LoadingIndicator({super.key});

  @override
  Widget build(BuildContext context) {
    return const Center(
      child: CircularProgressIndicator(),
    );
  }
}

--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\navigation_drawer.dart ---
import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:main_ui/l10n/app_localizations.dart';
import 'package:main_ui/providers/auth_provider.dart';
import 'package:main_ui/providers/user_provider.dart';

class CustomNavigationDrawer extends ConsumerWidget {
  const CustomNavigationDrawer({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final localizations = AppLocalizations.of(context)!;
    final user = ref.watch(userNotifierProvider);
    final theme = Theme.of(context);

    return Drawer(
      child: ListView(
        padding: EdgeInsets.zero,
        children: [
          DrawerHeader(
            decoration: BoxDecoration(color: theme.primaryColor),
            child: Text(
              '${localizations.appTitle} - ${user?.name ?? user?.email ?? localizations.guest}',
              style: theme.textTheme.titleLarge?.copyWith(
                color: Colors.white,
                fontWeight: FontWeight.bold,
              ),
            ),
          ),
          _buildDrawerItem(
            context: context,
            icon: Icons.home,
            title: localizations.appTitle ?? 'Home',
            onTap: () {
              Navigator.pop(context);
              final homeRoute = _getHomeRouteForRole(user?.role);
              if (homeRoute != null) {
                Navigator.pushNamed(context, homeRoute);
              } else {
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text(localizations.invalidRole ?? 'Invalid Role')),
                );
              }
            },
          ),
          if (user?.role?.toUpperCase() == 'ADMIN') ...[

            _buildDrawerItem(
              context: context,
              icon: Icons.report,
              title: localizations.complaintManagement ?? 'Complaint Management',
              route: '/admin/complaints',
            ),
            _buildDrawerItem(
              context: context,
              icon: Icons.settings_applications,
              title: localizations.manageConfigs ?? 'Manage Configs',
              route: '/admin/configs',
            ),
            _buildDrawerItem(
              context: context,
              icon: Icons.subject,
              title: localizations.manageSubjects ?? 'Manage Subjects',
              route: '/admin/subjects',
            ),
            _buildDrawerItem(
              context: context,
              icon: Icons.people,
              title: localizations.manageUsers ?? 'Manage Users',
              route: '/admin/users',
            ),
            _buildDrawerItem(
              context: context,
              icon: Icons.history_toggle_off,
              title: localizations.userHistory ?? 'User History',
              route: '/admin/all_users_history',
            ),
            _buildDrawerItem(
              context: context,
              icon: Icons.location_on,
              title: localizations.manageAreas ?? 'Manage Areas',
              route: '/admin/areas',
            ),

          ],
          if (user?.role?.toUpperCase() == 'MEMBER_HEAD') ...[
          
          ],
          if (user?.role?.toUpperCase() == 'FIELD_STAFF') ...[
            
          
          ],
          _buildDrawerItem(
            context: context,
            icon: Icons.person,
            title: localizations.profile ,
            route: '/profile',
          ),
          _buildDrawerItem(
            context: context,
            icon: Icons.settings,
            title: localizations.settings,
            route: '/settings',
          ),
          _buildDrawerItem(
            context: context,
            icon: Icons.announcement,
            title: localizations.announcements,
            route: '/announcements',
          ),
          
          _buildDrawerItem(
            context: context,
            icon: Icons.privacy_tip,
            title: localizations.privacyPolicy,
            route: '/privacy-policy',
          ),
          _buildDrawerItem(
            context: context,
            icon: Icons.help,
            title: localizations.faqs,
            route: '/faqs',
          ),
          _buildDrawerItem(
            context: context,
            icon: Icons.support,
            title: localizations.contactSupport,
            route: '/contact-support',
          ),
          _buildDrawerItem(
            context: context,
            icon: Icons.info,
            title: localizations.appVersion,
            route: '/app-version',
          ),
          const Divider(),
          _buildDrawerItem(
            context: context,
            icon: Icons.logout,
            title: localizations.logout ?? 'Logout',
            iconColor: Colors.red,
            onTap: () async {
              try {
                await ref.read(authProvider.notifier).logout();
                ref.read(userNotifierProvider.notifier).setUser(null);
                Navigator.pop(context);
                Navigator.pushNamedAndRemoveUntil(context, '/login', (route) => false);
              } catch (e) {
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text(localizations.logoutFailed ?? 'Logout Failed: $e')),
                );
              }
            },
          ),
        ],
      ),
    );
  }

  Widget _buildDrawerItem({
    required BuildContext context,
    required IconData icon,
    required String title,
    String? route,
    VoidCallback? onTap,
    Color? iconColor,
  }) {
    return ListTile(
      leading: Icon(icon, color: iconColor),
      title: Text(title),
      onTap: onTap ??
          () {
            if (route != null) {
              Navigator.pop(context);
              Navigator.pushNamed(context, route);
            }
          },
    );
  }

  String? _getHomeRouteForRole(String? role) {
    switch (role?.toUpperCase()) {
      case 'CITIZEN':
        return '/citizen/home';
      case 'MEMBER_HEAD':
        return '/member_head/home';
      case 'FIELD_STAFF':
        return '/field_staff/home';
      case 'ADMIN':
        return '/admin/home';
      default:
        return null;
    }
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\status_badge.dart ---
// main_ui/lib/widgets/status_badge.dart
import 'package:flutter/material.dart';
import 'package:main_ui/l10n/app_localizations.dart';

class StatusBadge extends StatelessWidget {
  final String status;
  const StatusBadge({super.key, required this.status});

  Color get color {
    switch (status) {
      case 'new':
        return Colors.blue;
      case 'in_progress':
        return Colors.orange;
      case 'resolved':
        return Colors.green;
      case 'rejected':
        return Colors.red;
      case 'on_hold':
        // return Colors.yellow;
        return const Color(0xFF6B21A8);
      case 'closed':
        return Colors.grey;
      default:
        return Colors.grey;
    }
  }

  String displayText(BuildContext context) {
    final l10n = AppLocalizations.of(context)!;
    switch (status) {
      case 'new':
        return l10n.statusNew;
      case 'in_progress':
        return l10n.statusInProgress;
      case 'resolved':
        return l10n.statusResolved;
      case 'rejected':
        return l10n.statusRejected;
      case 'on_hold':
        return l10n.statusOnHold;
      case 'closed':
        return l10n.statusClosed;
      default:
        return l10n.statusUnknown;
    }
  }

  IconData get icon {
    switch (status) {
      case 'new':
        return Icons.fiber_new_rounded;
      case 'in_progress':
        return Icons.autorenew_rounded;
      case 'resolved':
        return Icons.check_circle_rounded;
      case 'rejected':
        return Icons.cancel_rounded;
      case 'on_hold':
        return Icons.pause_circle_rounded;
      case 'closed':
        return Icons.done_all_rounded;
      default:
        return Icons.info_rounded;
    }
  }

  @override
  Widget build(BuildContext context) {
    return Container(
      padding: const EdgeInsets.symmetric(horizontal: 12, vertical: 6),
      decoration: BoxDecoration(
        color: color.withValues (alpha:0.1),
        borderRadius: BorderRadius.circular(16),
        border: Border.all(color: color.withValues (alpha:0.3), width: 1),
      ),
      child: Row(
        mainAxisSize: MainAxisSize.min,
        children: [
          Icon(
            icon,
            size: 14,
            color: color,
          ),
          const SizedBox(width: 4),
          Text(
            displayText(context),
            style: TextStyle(
              fontSize: 12,
              fontWeight: FontWeight.w600,
              color: color,
            ),
          ),
        ],
      ),
    );
  }
}
--- File: D:\Company_Data\PCMCApp\main_ui\lib\widgets\track_grievance_progress.dart ---
import 'package:flutter/material.dart';
import 'package:intl/intl.dart';
import 'package:main_ui/models/grievance_model.dart';
import 'package:main_ui/widgets/status_badge.dart';

class TrackGrievanceProgress extends StatelessWidget {
  final Grievance grievance;

  const TrackGrievanceProgress({super.key, required this.grievance});

  static const _stages = [
    {'status': 'new', 'label': 'Submitted', 'icon': Icons.send},
    {'status': 'in_progress', 'label': 'Reviewed by Supervisor Head', 'icon': Icons.visibility},
    {'status': 'in_progress', 'label': 'Assigned to Field Staff', 'icon': Icons.assignment_ind},
    {'status': 'resolved', 'label': 'Resolved', 'icon': Icons.check_circle},
  ];

  @override
  Widget build(BuildContext context) {
    final theme = Theme.of(context);
    final status = grievance.status?.toLowerCase() ?? 'new';

    final currentStageIndex = _getCurrentStageIndex(status, grievance);

    return Card(
      elevation: 2,
      shape: const RoundedRectangleBorder(borderRadius: BorderRadius.all(Radius.circular(12))),
      margin: const EdgeInsets.symmetric(horizontal: 16, vertical: 8),
      child: Padding(
        padding: const EdgeInsets.all(16.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Row(
              mainAxisAlignment: MainAxisAlignment.spaceBetween,
              children: [
                Text(
                  'Grievance Progress',
                  style: theme.textTheme.titleLarge?.copyWith(
                    fontWeight: FontWeight.w600,
                    color: theme.colorScheme.primary,
                  ),
                ),
                StatusBadge(status: status),
              ],
            ),
            const SizedBox(height: 16),
            Column(
              children: List.generate(_stages.length, (index) {
                final stage = _stages[index];
                final isActive = index <= currentStageIndex;
                final isCompleted = index < currentStageIndex;

                return Row(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Column(
                      children: [
                        Semantics(
                          label: stage['label'] as String, // Provide accessibility label
                          child: Container(
                            width: 32,
                            height: 32,
                            decoration: BoxDecoration(
                              shape: BoxShape.circle,
                              color: isActive
                                  ? theme.colorScheme.primary
                                  : theme.colorScheme.onSurface.withValues (alpha:0.2),
                            ),
                            child: Icon(
                              stage['icon'] as IconData,
                              size: 20,
                              color: isActive
                                  ? theme.colorScheme.onPrimary
                                  : theme.colorScheme.onSurface.withValues (alpha:0.4),
                            ),
                          ),
                        ),
                        if (index < _stages.length - 1)
                          Container(
                            width: 2,
                            height: 40,
                            color: isActive
                                ? theme.colorScheme.primary
                                : theme.colorScheme.onSurface.withValues (alpha:0.2),
                          ),
                      ],
                    ),
                    const SizedBox(width: 16),
                    Expanded(
                      child: Column(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          Text(
                            stage['label'] as String,
                            style: theme.textTheme.bodyLarge?.copyWith(
                              fontWeight: isActive ? FontWeight.w600 : FontWeight.normal,
                              color: isActive
                                  ? theme.colorScheme.onSurface
                                  : theme.colorScheme.onSurface.withValues (alpha:0.5),
                            ),
                          ),
                          if (isActive)
                            Text(
                              _getStageDetails(index, status, grievance),
                              style: theme.textTheme.bodySmall?.copyWith(
                                color: theme.colorScheme.onSurface.withValues (alpha:0.7),
                              ),
                            ),
                          const SizedBox(height: 8),
                        ],
                      ),
                    ),
                  ],
                );
              }),
            ),
          ],
        ),
      ),
    );
  }

  int _getCurrentStageIndex(String status, Grievance grievance) {
    if (status == 'in_progress' && grievance.assignedTo != null) {
      return 2; // Assigned to Field Staff
    } else if (status == 'in_progress') {
      return 1; // Reviewed by Member Head
    } else if (status == 'resolved' || status == 'closed') {
      return 3; // Resolved
    }
    return 0; // Submitted
  }

  String _getStageDetails(int index, String status, Grievance grievance) {
    switch (index) {
      case 0:
        return 'Submitted on ${_formatDate(grievance.createdAt)}';
      case 1:
        return 'Reviewed by Supervisor Head${grievance.assignedBy != null ? " (User ${grievance.assignedBy})" : ""}';
      case 2:
        return 'Assigned to${grievance.assignee?.name != null ? " ${grievance.assignee!.name}" : " Field Staff"}';
      case 3:
        return 'Resolved on ${_formatDate(grievance.resolvedAt)}';
      default:
        return '';
    }
  }

  String _formatDate(DateTime? date) {
    if (date == null) return 'N/A';
    return DateFormat('dd/MM/yyyy').format(date);
  }
}